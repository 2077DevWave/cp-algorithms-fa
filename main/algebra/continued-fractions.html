
<!doctype html>
<html lang="fa" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The goal of this project is to translate the wonderful resource http://e-maxx.ru/algo which provides descriptions of many algorithms and data structures especially popular in field of competitive programming. Moreover we want to improve the collected knowledge by extending the articles and adding new articles to the collection.">
      
      
      
        <link rel="canonical" href="https://cp-algorithm.sideco.ir/algebra/continued-fractions.html">
      
      
        <link rel="prev" href="polynomial.html">
      
      
        <link rel="next" href="factoring-exp.html">
      
      
        <link rel="alternate" type="application/rss+xml" title="خوراک آراس‌اس" href="../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="خوراک آراساس محتویات به‌روز شده" href="../feed_rss_updated.xml">
      
      <link rel="icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>کسرهای مسلسل - Algorithms for Competitive Programming</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/rtl.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-7FLS2HCYHH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-7FLS2HCYHH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-7FLS2HCYHH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="rtl" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          پرش به محتویات
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
-->


<header class="md-header" data-md-component="header">
  <script>
    function scrollToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }
  </script>
  <nav class="md-header__inner md-grid" aria-label="header.title">
    <a href=".." title="Algorithms for Competitive Programming" class="md-header__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <a href=".." title="Algorithms for Competitive Programming" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
              Algorithms for Competitive Programming
            </a>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <a href="#" onclick="scrollToTop()">
              
                کسرهای مسلسل
              
            </a>
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="جستجو" placeholder="جستجو" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="جستجو">
        
        <button type="reset" class="md-search__icon md-icon" title="بازنشانی" aria-label="بازنشانی" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            راه‌اندازی جستجو
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/2077DevWave/cp-algorithms-fa" title="رفتن به مخزن" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    2077DevWave/cp-algorithms-fa
  </div>
</a>
      </div>
    
      <div class="rss icon">
      <a href="https://cp-algorithm.sideco.ir/feed_rss_created.xml" title="RSS" class="md-content__button md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64m0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0m32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg>
      </a>
      </div>

    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="هدایت" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Algorithms for Competitive Programming" class="md-nav__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    Algorithms for Competitive Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/2077DevWave/cp-algorithms-fa" title="رفتن به مخزن" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    2077DevWave/cp-algorithms-fa
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    خانه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            خانه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    صفحه اصلی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ناوبری
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فهرست برچسب‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    چگونه مشارکت کنیم
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آیین‌نامه رفتاری
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پیش‌نمایش
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    جبر
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            جبر
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="binary-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    توان‌رسانی دودویی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم اقلیدس برای محاسبه بزرگترین مقسوم‌علیه مشترک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="extended-euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم اقلیدس تعمیم‌یافته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linear-diophantine-equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    معادلات سیاله خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fibonacci-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اعداد فیبوناچی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    اعداد اول
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            اعداد اول
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sieve-of-eratosthenes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    غربال اراتستن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="prime-sieve-linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    غربال خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="primality_tests.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آزمون‌های اول بودن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه اعداد صحیح
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    توابع نظریه اعداد
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            توابع نظریه اعداد
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="phi-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تابع فی اویلر
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تعداد مقسوم‌علیه‌ها / جمع مقسوم‌علیه‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    حساب پیمانه‌ای
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            حساب پیمانه‌ای
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="module-inverse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    وارون پیمانه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linear_congruence_equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    معادله همنهشتی خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="chinese-remainder-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه باقیمانده چینی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="garners-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم Garner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorial-modulo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فاکتوریل به پیمانه p
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="discrete-log.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    لگاریتم گسسته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="primitive-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ریشه اولیه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="discrete-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ریشه گسسته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="montgomery_multiplication.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ضرب Montgomery
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    دستگاه‌های اعداد
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            دستگاه‌های اعداد
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="balanced-ternary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    سه‌سه‌ای متوازن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gray-code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    کد گِرِی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bit-manipulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    عملیات بیتی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="all-submasks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شمارش زیرماسک‌های یک بیت‌ماسک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="big-integer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    محاسبات با دقت دلخواه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fft.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تبدیل سریع فوریه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="polynomial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    عملیات روی چندجمله‌ای‌ها و سری‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    کسرهای مسلسل
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="continued-fractions.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    کسرهای مسلسل
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="فهرست موضوعات">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      فهرست موضوعات
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      نمایش کسر مسلسل
    </span>
  </a>
  
    <nav class="md-nav" aria-label="نمایش کسر مسلسل">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      پیاده‌سازی
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      نتایج کلیدی
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      همگراها
    </span>
  </a>
  
    <nav class="md-nav" aria-label="همگراها">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      پیاده‌سازی
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      درخت‌های کسرهای مسلسل
    </span>
  </a>
  
    <nav class="md-nav" aria-label="درخت‌های کسرهای مسلسل">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-stern-brocot" class="md-nav__link">
    <span class="md-ellipsis">
      درخت اشترن-بروکوت (Stern-Brocot)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-calkin-wilf" class="md-nav__link">
    <span class="md-ellipsis">
      درخت کالکین-ویلف (Calkin-Wilf)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      همگرایی
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      تبدیلات کسری خطی
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      تعبیر هندسی
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      مثال‌های مسئله
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      مسائل تمرینی
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factoring-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه توان
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ساختمان داده‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ساختمان داده‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/stack_queue_modification.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پشته کمینه / صف کمینه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sparse-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جدول پراکنده
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    درخت‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            درخت‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/disjoint_set_union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ساختار داده اجتماع-جداگانه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/fenwick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت فن‌ویک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه رادیکالی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/segment_tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت بازه‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/treap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تریپ (Treap)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt-tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت رادیکالی (Sqrt Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/randomized_heap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    هیپ تصادفی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پیشرفته
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            پیشرفته
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/deleting_in_log_n.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    حذف از یک ساختمان داده در O(T(n) log n)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    برنامه‌نویسی پویا
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            برنامه‌نویسی پویا
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/intro-to-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مقدمه‌ای بر برنامه‌نویسی پویا
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knapsack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله کوله‌پشتی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    بهینه‌سازی‌های برنامه‌نویسی پویا
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            بهینه‌سازی‌های برنامه‌نویسی پویا
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/divide-and-conquer-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    برنامه‌نویسی پویای تقسیم و غلبه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knuth-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بهینه‌سازی Knuth
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مسائل
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            مسائل
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/profile-dynamics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    برنامه‌نویسی پویا روی پروفایل شکسته. مسئله "پارکت"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/zero_matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن بزرگترین زیرماتریس صفر
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پردازش رشته
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            پردازش رشته
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/string-hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    هشینگ رشته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/rabin-karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم رابین-کارپ برای تطبیق رشته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/prefix-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تابع پیشوندی - کنوث-موریس-پرت (KMP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/z-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تابع Z
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-array.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آرایه پسوندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/aho_corasick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم آهو-کوراسیک
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پیشرفته
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            پیشرفته
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-tree-ukkonen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پسوندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-automaton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اتوماتای پسوندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/lyndon_factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه لیندون
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مسائل
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            مسائل
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/expression_parsing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه عبارت
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/manacher.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم ماناکر - یافتن تمام زیرپالیندروم‌ها در O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/main_lorentz.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن تکرارها
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    جبر خطی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            جبر خطی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ماتریس‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            ماتریس‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/linear-system-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    گاوس و دستگاه معادلات خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    گاوس و دترمینان
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-kraut.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kraut و دترمینان
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/rank-matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    رتبه ماتریس
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ترکیبیات
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ترکیبیات
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorial-divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن توان مقسوم‌علیه فاکتوریل
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/binomial-coefficients.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ضرایب دوجمله‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/catalan-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اعداد کاتالان
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    تکنیک‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            تکنیک‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/inclusion-exclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اصل شمول و عدم شمول
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/burnside.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    لم برنساید / قضیه شمارش پولیا
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/stars_and_bars.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ستاره‌ها و خطوط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/generating_combinations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تولید تمام ترکیب‌های Kتایی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مسائل
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            مسائل
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bishops-on-chessboard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قرار دادن فیل‌ها در صفحه شطرنج
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bracket_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دنباله‌های پرانتز متوازن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/counting_labeled_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شمارش گراف‌های برچسب‌دار
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    روش‌های عددی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            روش‌های عددی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    جستجو
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            جستجو
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/binary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی دودویی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/ternary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی سه‌سه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/roots_newton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    روش نیوتن برای یافتن ریشه‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simulated_annealing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تبرید شبیه‌سازی‌شده
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    انتگرال‌گیری
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            انتگرال‌گیری
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simpson-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    انتگرال‌گیری با فرمول سیمپسون
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    هندسه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            هندسه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    عملیات مقدماتی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            عملیات مقدماتی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/basic-geometry.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    هندسه پایه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segment-to-line.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن معادله خط یک پاره‌خط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lines-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    نقطه تقاطع خطوط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/check-segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی تقاطع دو پاره‌خط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع پاره‌خط‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-line-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع دایره و خط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-circle-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع دو دایره
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/tangents-to-two-circles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مماس‌های مشترک دو دایره
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/length-of-segments-union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    طول اجتماع پاره‌خط‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    چندضلعی‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            چندضلعی‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/oriented-triangle-area.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مساحت جهت‌دار مثلث
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/area-of-simple-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مساحت چندضلعی ساده
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-in-convex-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی تعلق نقاط به چندضلعی محدب در O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/minkowski.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جمع مینکوفسکی چندضلعی‌های محدب
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/picks-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه پیک - مساحت چندضلعی‌های شبکه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lattice-points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    نقاط شبکه‌ای چندضلعی غیرشبکه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پوش محدب
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            پوش محدب
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex-hull.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ساخت پوش محدب
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex_hull_trick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ترفند پوش محدب و درخت Li Chao
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    خط جاروب
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            خط جاروب
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/intersecting_segments.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی یک جفت پاره‌خط متقاطع
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    گراف‌های مسطح
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            گراف‌های مسطح
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/planar.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن وجه‌های یک گراف مسطح
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-location.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مکان‌یابی نقطه در O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/nearest_points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن نزدیک‌ترین جفت نقاط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/delaunay.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مثلث‌بندی دلونی و دیاگرام ورونوی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/vertical_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه عمودی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/halfplane-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع نیم‌صفحه‌ها - الگوریتم S&amp;I در O(N log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/manhattan-distance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فاصله منهتن
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    گراف‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            گراف‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پیمایش گراف
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            پیمایش گراف
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/breadth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی اول سطح (BFS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/depth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی اول عمق (DFS)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مؤلفه‌های همبندی، پل‌ها، نقاط مفصلی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            مؤلفه‌های همبندی، پل‌ها، نقاط مفصلی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/search-for-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن مؤلفه‌های همبندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن پل‌ها در O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching-online.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن پل‌ها به صورت آنلاین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/cutpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن نقاط مفصلی در O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strongly-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مؤلفه‌های قویاً همبند و گراف انقباضی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strong-orientation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جهت‌دهی قوی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    کوتاه‌ترین مسیرهای تک‌مبدأ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            کوتاه‌ترین مسیرهای تک‌مبدأ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دایکسترا - یافتن کوتاه‌ترین مسیرها از یک رأس معین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra_sparse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دایکسترا روی گراف‌های خلوت
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bellman_ford.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بلمن-فورد - یافتن کوتاه‌ترین مسیرها با وزن‌های منفی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/01_bfs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی اول سطح صفر و یک (0-1 BFS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/desopo_pape.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم D'Esopo-Pape
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    کوتاه‌ترین مسیرهای بین تمام زوج‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            کوتاه‌ترین مسیرهای بین تمام زوج‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/all-pair-shortest-path-floyd-warshall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فلوید-وارشال - یافتن تمام کوتاه‌ترین مسیرها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/fixed_length_paths.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تعداد مسیرها با طول ثابت / کوتاه‌ترین مسیرها با طول ثابت
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    درخت‌های پوشا
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            درخت‌های پوشا
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_prim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پوشای کمینه - الگوریتم پریم
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پوشای کمینه - کروسکال
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal_with_dsu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پوشای کمینه - کروسکال با ساختار داده اجتماع-جداگانه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/second_best_mst.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دومین درخت پوشای کمینه بهتر - با استفاده از کروسکال و پایین‌ترین جد مشترک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kirchhoff-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه کیرشهف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/pruefer_code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    کد پروفر
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    دورها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            دورها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-cycle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی غیرمدور بودن گراف و یافتن دور در O(M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-negative-cycle-in-graph.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن دور منفی در گراف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/euler_path.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسیر اویلری
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            پایین‌ترین جد مشترک
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک (LCA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_binary_lifting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک - پرش دودویی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_farachcoltonbender.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک - الگوریتم Farach-Colton و Bender
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/rmq_linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    حل RMQ با یافتن LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_tarjan.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک - الگوریتم آفلاین Tarjan
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    شار و مسائل مرتبط
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            شار و مسائل مرتبط
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edmonds_karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - فورد-فالکرسون و ادموندز-کارپ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم Push-relabel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel-faster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم بهبودیافته Push-relabel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dinic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم دینیک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mpm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم MPM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/flow_with_demands.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار با تقاضا
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/min_cost_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار با کمترین هزینه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/Assignment-problem-min-flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله تخصیص
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    تطابق و مسائل مرتبط
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            تطابق و مسائل مرتبط
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bipartite-check.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی دوبخشی بودن گراف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kuhn_maximum_bipartite_matching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم کوهن - تطابق بیشینه در گراف دوبخشی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hungarian-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم مجارستانی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/topological-sort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مرتب‌سازی توپولوژیک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edge_vertex_connectivity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    همبندی یالی / همبندی رأسی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/tree_painting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    رنگ‌آمیزی درخت
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/2SAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دو-ارضاپذیری (2-SAT)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hld.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه سنگین-سبک
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    دنباله‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            دنباله‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/rmq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله RMQ (پرس‌وجوی کمینه بازه - کوچکترین عنصر در یک بازه)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/longest_increasing_subsequence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    طولانی‌ترین زیردنباله صعودی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/maximum_average_segment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی زیربازه با بیشترین/کمترین مجموع
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/k-th.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آماره مرتبه K-ام در O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/mex.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله MEX (کمترین عنصر حذف‌شده در یک آرایه)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    نظریه بازی‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            نظریه بازی‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/games_on_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بازی‌ها روی گراف‌های دلخواه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/sprague-grundy-nim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه اسپراگ-گراندی. نیم (Nim)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    زمان‌بندی‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            زمان‌بندی‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_one_machine.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    زمان‌بندی کارها روی یک ماشین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_two_machines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    زمان‌بندی کارها روی دو ماشین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule-with-completion-duration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    زمان‌بندی بهینه کارها با توجه به مهلت‌ها و مدت‌زمانشان
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/tortoise_and_hare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم لاک‌پشت و خرگوش (تشخیص دور در لیست پیوندی)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/josephus_problem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله یوسف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/15-puzzle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بازی پازل ۱۵: وجود راه‌حل
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/stern_brocot_tree_farey_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت اشترن-بروکوت و دنباله‌های فارِی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <script type="text/javascript">
window.onload = function() {
	const newIssueURL = "https://github.com/2077DevWave/cp-algorithms-fa/issues/new";
  const issueTitle = "Problem on article " + "\u06a9\u0633\u0631\u0647\u0627\u06cc \u0645\u0633\u0644\u0633\u0644";
	const issueBody = `
 **Article:** [`+ "\u06a9\u0633\u0631\u0647\u0627\u06cc \u0645\u0633\u0644\u0633\u0644" + `](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
  var issue_a = document.getElementById("report_issue_a");
  issue_a.href = `${newIssueURL}?` + `title=${encodeURIComponent(issueTitle)}&` + `body=${encodeURIComponent(issueBody)}`;
}
</script>

<a href="https://github.com/2077DevWave/cp-algorithms-fa/edit/main/src/algebra/continued-fractions.md" title="این صفحه را ویرایش کنید" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
</a>
<a id="report_issue_a" href="" title="Report a problem" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg>
</a>
<a href="https://github.com/2077DevWave/cp-algorithms-fa/commits/main/src/algebra/continued-fractions.md" title="Page authors" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M12,8.5c-0.91,0-2.75,0.46-2.75,1.38v4.62h1.5V19h2.5v-4.5h1.5V9.88C14.75,8.97,12.91,8.5,12,8.5z"/><path d="M12,2C6.47,2,2,6.47,2,12s4.47,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.42,0-8-3.58-8-8s3.58-8,8-8s8,3.58,8,8 S16.42,20,12,20z"/><circle cx="12" cy="6.5" r="1.5"/></g></g></g></svg>
</a>


<!-- Construct the dict of author's contribution percentage -->




  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  
    
  

  
  
  
    
  



  
  
  

  
  
  

  
  
  




<!-- Date of last commit -->
<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">

  اخرین بروزرسانی:
  <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="6 ژوئیهٔ 2025 13:36:29 UTC">6 ژوئیهٔ 2025</span>&emsp;

<!-- Tags -->

  
  
  
    
  


  
    <a href="../tags.html#tag:ai-translated" class="md-tag">
      AI Translated
    </a>
  

  
    <a href="https://e-maxx.ru/algo/continued-fractions" class="md-tag">
      From: e-maxx.ru
    </a>
  

</ul>


<!--?title کسرهای مسلسل -->
<h1 id="_1">کسرهای مسلسل<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p><strong>کسر مسلسل</strong> (Continued fraction) نمایشی از یک عدد حقیقی به صورت یک دنباله همگرای خاص از اعداد گویا است. این کسرها در برنامه‌نویسی رقابتی مفید هستند، زیرا محاسبه آن‌ها آسان است و می‌توان از آن‌ها برای یافتن بهترین تقریب گویای ممکن برای یک عدد حقیقی (در میان تمام اعدادی که مخرجشان از یک مقدار معین تجاوز نمی‌کند) به طور مؤثر استفاده کرد.</p>
<p>علاوه بر این، کسرهای مسلسل ارتباط نزدیکی با الگوریتم اقلیدس دارند که آن‌ها را در مجموعه‌ای از مسائل نظریه اعداد مفید می‌سازد.</p>
<h2 id="_2">نمایش کسر مسلسل<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>فرض کنید <span class="arithmatex">$a_0, a_1, \dots, a_k \in \mathbb Z$</span> و <span class="arithmatex">$a_1, a_2, \dots, a_k \geq 1$</span>. در این صورت، عبارت</p>
<div class="arithmatex">$$r=a_0 + \frac{1}{a_1 + \frac{1}{\dots + \frac{1}{a_k}}},$$</div>
<p><strong>نمایش کسر مسلسل</strong> عدد گویای <span class="arithmatex">$r$</span> نامیده می‌شود و به طور خلاصه به صورت <span class="arithmatex">$r=[a_0;a_1,a_2,\dots,a_k]$</span> نمایش داده می‌شود.</p>
</div>
<details class="example">
<summary>مثال</summary>
<p>فرض کنید <span class="arithmatex">$r = \frac{5}{3}$</span>. دو راه برای نمایش آن به صورت کسر مسلسل وجود دارد:</p>
<div class="arithmatex">$$
\begin{align}
r = [1;1,1,1] &amp;= 1+\frac{1}{1+\frac{1}{1+\frac{1}{1}}},\\
r = [1;1,2] &amp;= 1+\frac{1}{1+\frac{1}{2}}.
\end{align}
$$</div>
</details>
<p>می‌توان ثابت کرد که هر عدد گویایی را می‌توان دقیقاً به ۲ روش به صورت کسر مسلسل نمایش داد:</p>
<div class="arithmatex">$$r = [a_0;a_1,\dots,a_k,1] = [a_0;a_1,\dots,a_k+1].$$</div>
<p>علاوه بر این، طول <span class="arithmatex">$k$</span> چنین کسر مسلسلی برای <span class="arithmatex">$r=\frac{p}{q}$</span> به صورت <span class="arithmatex">$k = O(\log \min(p, q))$</span> تخمین زده می‌شود.</p>
<p>دلیل این امر پس از بررسی جزئیات ساختار کسر مسلسل روشن خواهد شد.</p>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>فرض کنید <span class="arithmatex">$a_0,a_1,a_2, \dots$</span> یک دنباله از اعداد صحیح باشد به طوری که <span class="arithmatex">$a_1, a_2, \dots \geq 1$</span>. فرض کنید <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_k]$</span>. در این صورت عبارت</p>
<div class="arithmatex">$$r = a_0 + \frac{1}{a_1 + \frac{1}{a_2+\dots}} = \lim\limits_{k \to \infty} r_k.$$</div>
<p><strong>نمایش کسر مسلسل</strong> عدد گنگ <span class="arithmatex">$r$</span> نامیده می‌شود و به طور خلاصه به صورت <span class="arithmatex">$r = [a_0;a_1,a_2,\dots]$</span> نمایش داده می‌شود.</p>
</div>
<p>توجه داشته باشید که برای <span class="arithmatex">$r=[a_0;a_1,\dots]$</span> و عدد صحیح <span class="arithmatex">$k$</span>، داریم: <span class="arithmatex">$r+k = [a_0+k; a_1, \dots]$</span>.</p>
<p>مشاهده مهم دیگر این است که <span class="arithmatex">$\frac{1}{r}=[0;a_0, a_1, \dots]$</span> وقتی <span class="arithmatex">$a_0 &gt; 0$</span> و <span class="arithmatex">$\frac{1}{r} = [a_1; a_2, \dots]$</span> وقتی <span class="arithmatex">$a_0 = 0$</span>.</p>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>در تعریف بالا، اعداد گویای <span class="arithmatex">$r_0, r_1, r_2, \dots$</span> <strong>همگراهای</strong> (convergents) <span class="arithmatex">$r$</span> نامیده می‌شوند.</p>
<p>به همین ترتیب، هر <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_k] = \frac{p_k}{q_k}$</span>، <span class="arithmatex">$k$</span>-امین <strong>همگرا</strong>ی <span class="arithmatex">$r$</span> نامیده می‌شود.</p>
</div>
<details class="example">
<summary>مثال</summary>
<p><span class="arithmatex">$r = [1; 1, 1, 1, \dots]$</span> را در نظر بگیرید. می‌توان با استقرا ثابت کرد که <span class="arithmatex">$r_k = \frac{F_{k+2}}{F_{k+1}}$</span>، که در آن <span class="arithmatex">$F_k$</span> دنباله فیبوناچی است که به صورت <span class="arithmatex">$F_0 = 0$</span>, <span class="arithmatex">$F_1 = 1$</span> و <span class="arithmatex">$F_{k} = F_{k-1} + F_{k-2}$</span> تعریف می‌شود. از فرمول Binet می‌دانیم که:</p>
<div class="arithmatex">$$r_k = \frac{\phi^{k+2} - \psi^{k+2}}{\phi^{k+1} - \psi^{k+1}},$$</div>
<p>که در آن <span class="arithmatex">$\phi = \frac{1+\sqrt{5}}{2} \approx 1.618$</span> نسبت طلایی و <span class="arithmatex">$\psi = \frac{1-\sqrt{5}}{2} = -\frac{1}{\phi} \approx -0.618$</span> است. بنابراین،</p>
<div class="arithmatex">$$r = 1+\frac{1}{1+\frac{1}{1+\dots}}=\lim\limits_{k \to \infty} r_k = \phi = \frac{1+\sqrt{5}}{2}.$$</div>
<p>توجه داشته باشید که در این حالت خاص، یک راه جایگزین برای یافتن <span class="arithmatex">$r$</span> حل معادله زیر است:</p>
<div class="arithmatex">$$r = 1+\frac{1}{r} \implies r^2 = r + 1. $$</div>
</details>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>فرض کنید <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_{k-1}, a_k]$</span>. اعداد <span class="arithmatex">$[a_0; a_1, \dots, a_{k-1}, t]$</span> برای <span class="arithmatex">$1 \leq t \leq a_k$</span> <strong>نیم‌همگرا</strong> (semiconvergents) نامیده می‌شوند.</p>
<p>ما معمولاً به (نیم)همگراهایی که بزرگتر از <span class="arithmatex">$r$</span> هستند <strong>(نیم)همگراهای بالایی</strong> و به آن‌هایی که کوچکتر از <span class="arithmatex">$r$</span> هستند <strong>(نیم)همگراهای پایینی</strong> می‌گوییم.</p>
</div>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>به عنوان مکمل همگراها، <strong><a href="https://en.wikipedia.org/wiki/Complete_quotient">خارج‌قسمت‌های کامل</a></strong> را به صورت <span class="arithmatex">$s_k = [a_k; a_{k+1}, a_{k+2}, \dots]$</span> تعریف می‌کنیم.</p>
<p>به همین ترتیب، ما یک <span class="arithmatex">$s_k$</span> را <span class="arithmatex">$k$</span>-امین خارج‌قسمت کامل <span class="arithmatex">$r$</span> می‌نامیم.</p>
</div>
<p>از تعاریف بالا، می‌توان نتیجه گرفت که <span class="arithmatex">$s_k \geq 1$</span> برای <span class="arithmatex">$k \geq 1$</span>.</p>
<p>با در نظر گرفتن <span class="arithmatex">$[a_0; a_1, \dots, a_k]$</span> به عنوان یک عبارت جبری صوری و اجازه دادن به اعداد حقیقی دلخواه به جای <span class="arithmatex">$a_i$</span>، به دست می‌آوریم:</p>
<div class="arithmatex">$$r = [a_0; a_1, \dots, a_{k-1}, s_k].$$</div>
<p>به‌طور خاص، <span class="arithmatex">$r = [s_0] = s_0$</span>. از طرف دیگر، می‌توانیم <span class="arithmatex">$s_k$</span> را به صورت زیر بیان کنیم:</p>
<div class="arithmatex">$$s_k = [a_k; s_{k+1}] = a_k + \frac{1}{s_{k+1}},$$</div>
<p>این به این معناست که می‌توانیم <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span> و <span class="arithmatex">$s_{k+1} = (s_k - a_k)^{-1}$</span> را از <span class="arithmatex">$s_k$</span> محاسبه کنیم.</p>
<p>دنباله <span class="arithmatex">$a_0, a_1, \dots$</span> به خوبی تعریف شده است مگر اینکه <span class="arithmatex">$s_k=a_k$</span> که این تنها زمانی اتفاق می‌افتد که <span class="arithmatex">$r$</span> یک عدد گویا باشد.</p>
<p>بنابراین نمایش کسر مسلسل برای هر عدد گنگ <span class="arithmatex">$r$</span> به طور یکتا تعریف شده است.</p>
<h3 id="_3">پیاده‌سازی<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>در قطعه کدها، ما عمدتاً کسرهای مسلسل متناهی را فرض خواهیم کرد.</p>
<p>از <span class="arithmatex">$s_k$</span>، انتقال به <span class="arithmatex">$s_{k+1}$</span> به شکل زیر است:</p>
<div class="arithmatex">$$s_k =\left\lfloor s_k \right\rfloor + \frac{1}{s_{k+1}}.$$</div>
<p>از این عبارت، خارج‌قسمت کامل بعدی <span class="arithmatex">$s_{k+1}$</span> به صورت زیر به دست می‌آید:</p>
<div class="arithmatex">$$s_{k+1} = \left(s_k-\left\lfloor s_k\right\rfloor\right)^{-1}.$$</div>
<p>برای <span class="arithmatex">$s_k=\frac{p}{q}$</span> این به این معناست که:</p>
<div class="arithmatex">$$
s_{k+1} = \left(\frac{p}{q}-\left\lfloor \frac{p}{q} \right\rfloor\right)^{-1} = \frac{q}{p-q\cdot \lfloor \frac{p}{q} \rfloor} = \frac{q}{p \bmod q}.
$$</div>
<p>بنابراین، محاسبه نمایش کسر مسلسل برای <span class="arithmatex">$r=\frac{p}{q}$</span> مراحل الگوریتم اقلیدس برای <span class="arithmatex">$p$</span> و <span class="arithmatex">$q$</span> را دنبال می‌کند.</p>
<p>از این نیز نتیجه می‌شود که <span class="arithmatex">$\gcd(p_k, q_k) = 1$</span> برای <span class="arithmatex">$\frac{p_k}{q_k} = [a_0; a_1, \dots, a_k]$</span>. از این رو، همگراها همیشه کسرهای ساده‌نشدنی هستند.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">C++</label><label for="__tabbed_1_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">auto</span><span class="w"> </span><span class="n">fraction</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">a</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">        </span><span class="n">tie</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_pair</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">//</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">%</span> <span class="n">q</span>
    <span class="k">return</span> <span class="n">a</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="_4">نتایج کلیدی<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>برای ایجاد انگیزه برای مطالعه بیشتر کسرهای مسلسل، در اینجا چند واقعیت کلیدی را ارائه می‌دهیم.</p>
<details class="note">
<summary>رابطه بازگشتی</summary>
<p>برای همگراهای <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span>، رابطه بازگشتی زیر برقرار است که امکان محاسبه سریع آنها را فراهم می‌کند:</p>
<div class="arithmatex">$$\frac{p_k}{q_k}=\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$</div>
<p>که در آن <span class="arithmatex">$\frac{p_{-1}}{q_{-1}}=\frac{1}{0}$</span> و <span class="arithmatex">$\frac{p_{-2}}{q_{-2}}=\frac{0}{1}$</span>.</p>
</details>
<details class="note">
<summary>انحراف‌ها</summary>
<p>انحراف <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span> از <span class="arithmatex">$r$</span> به طور کلی به صورت زیر تخمین زده می‌شود:</p>
<div class="arithmatex">$$\left|\frac{p_k}{q_k}-r\right| \leq \frac{1}{q_k q_{k+1}} \leq \frac{1}{q_k^2}.$$</div>
<p>با ضرب طرفین در <span class="arithmatex">$q_k$</span>، تخمین دیگری به دست می‌آوریم:</p>
<div class="arithmatex">$$|p_k - q_k r| \leq \frac{1}{q_{k+1}}.$$</div>
<p>از رابطه بازگشتی بالا نتیجه می‌شود که <span class="arithmatex">$q_k$</span> حداقل به سرعت اعداد فیبوناچی رشد می‌کند.</p>
<p>در تصویر زیر می‌توانید تجسمی از نحوه نزدیک شدن همگراهای <span class="arithmatex">$r_k$</span> به <span class="arithmatex">$r=\frac{1+\sqrt 5}{2}$</span> را مشاهده کنید:</p>
</details>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Golden_ration_convergents.svg" /></p>
<div class="highlight"><pre><span></span><code>$r=\frac{1+\sqrt 5}{2}$ با خط چین آبی نشان داده شده است. همگراهای فرد از بالا به آن نزدیک می‌شوند و همگراهای زوج از پایین به آن نزدیک می‌شوند.
</code></pre></div>
<details class="note">
<summary>پوش‌های مشبکه</summary>
<p>پوش‌های محدب نقاط بالا و پایین خط <span class="arithmatex">$y=rx$</span> را در نظر بگیرید.</p>
<p>همگراهای فرد <span class="arithmatex">$(q_k;p_k)$</span> رئوس پوش بالایی هستند، در حالی که همگراهای زوج <span class="arithmatex">$(q_k;p_k)$</span> رئوس پوش پایینی هستند.</p>
<p>تمام رئوس صحیح روی پوش‌ها به صورت <span class="arithmatex">$(q;p)$</span> به دست می‌آیند به طوری که</p>
<div class="arithmatex">$$\frac{p}{q} = \frac{tp_{k-1} + p_{k-2}}{tq_{k-1} + q_{k-2}}$$</div>
<p>برای عدد صحیح <span class="arithmatex">$0 \leq t \leq a_k$</span>. به عبارت دیگر، مجموعه نقاط مشبکه روی پوش‌ها با مجموعه نیم‌همگراها مطابقت دارد.</p>
<p>در تصویر زیر، می‌توانید همگراها و نیم‌همگراهای (نقاط خاکستری میانی) <span class="arithmatex">$r=\frac{9}{7}$</span> را مشاهده کنید.</p>
</details>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/9/92/Continued_convergents_geometry.svg" /></p>
<details class="note">
<summary>بهترین تقریب‌ها</summary>
<p>فرض کنید <span class="arithmatex">$\frac{p}{q}$</span> کسری باشد که <span class="arithmatex">$\left|r-\frac{p}{q}\right|$</span> را با شرط <span class="arithmatex">$q \leq x$</span> برای یک <span class="arithmatex">$x$</span> معین کمینه می‌کند.</p>
<p>در این صورت <span class="arithmatex">$\frac{p}{q}$</span> یک نیم‌همگرای <span class="arithmatex">$r$</span> است.</p>
</details>
<p>آخرین واقعیت به ما اجازه می‌دهد تا بهترین تقریب‌های گویای <span class="arithmatex">$r$</span> را با بررسی نیم‌همگراهای آن پیدا کنیم.</p>
<p>در زیر توضیحات بیشتر و کمی شهود و تفسیر برای این حقایق را خواهید یافت.</p>
<h2 id="_5">همگراها<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>بیایید نگاهی دقیق‌تر به همگراهایی بیندازیم که قبلاً تعریف شدند. برای <span class="arithmatex">$r=[a_0, a_1, a_2, \dots]$</span>، همگراهای آن عبارتند از:</p>
<div class="arithmatex">$$\begin{gather}
r_0=[a_0],\\r_1=[a_0, a_1],\\ \dots,\\ r_k=[a_0, a_1, \dots, a_k].
\end{gather}$$</div>
<p>همگراها مفهوم اصلی کسرهای مسلسل هستند، بنابراین مطالعه ویژگی‌های آن‌ها مهم است.</p>
<p>برای عدد <span class="arithmatex">$r$</span>، <span class="arithmatex">$k$</span>-امین همگرای آن <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span> را می‌توان به صورت زیر محاسبه کرد:</p>
<div class="arithmatex">$$r_k = \frac{P_k(a_0,a_1,\dots,a_k)}{P_{k-1}(a_1,\dots,a_k)} = \frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$</div>
<p>که در آن <span class="arithmatex">$P_k(a_0,\dots,a_k)$</span> <a href="https://en.wikipedia.org/wiki/Continuant_(mathematics)">ادامه‌دهنده</a> است، یک چندجمله‌ای چندمتغیره که به صورت زیر تعریف می‌شود:</p>
<div class="arithmatex">$$P_k(x_0,x_1,\dots,x_k) = \det \begin{bmatrix}
x_k &amp; 1 &amp; 0 &amp; \dots &amp; 0 \\
-1 &amp; x_{k-1} &amp; 1 &amp; \dots &amp; 0 \\
0 &amp; -1 &amp; x_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; 1 \\
0 &amp; 0 &amp; \dots &amp; -1 &amp; x_0
\end{bmatrix}_{\textstyle .}$$</div>
<p>بنابراین، <span class="arithmatex">$r_k$</span> یک <a href="https://en.wikipedia.org/wiki/Mediant_(mathematics)">میانه</a> وزنی از <span class="arithmatex">$r_{k-1}$</span> و <span class="arithmatex">$r_{k-2}$</span> است.</p>
<p>برای سازگاری، دو همگرای اضافی <span class="arithmatex">$r_{-1} = \frac{1}{0}$</span> و <span class="arithmatex">$r_{-2} = \frac{0}{1}$</span> تعریف می‌شوند.</p>
<details class="hint">
<summary>توضیح کامل</summary>
<p>صورت و مخرج <span class="arithmatex">$r_k$</span> را می‌توان به عنوان چندجمله‌ای‌های چندمتغیره از <span class="arithmatex">$a_0, a_1, \dots, a_k$</span> در نظر گرفت:</p>
<div class="arithmatex">$$r_k = \frac{P_k(a_0, a_1, \dots, a_k)}{Q_k(a_0,a_1, \dots, a_k)}.$$</div>
<p>از تعریف همگراها،</p>
<div class="arithmatex">$$r_k = a_0 + \frac{1}{[a_1;a_2,\dots, a_k]}= a_0 + \frac{Q_{k-1}(a_1, \dots, a_k)}{P_{k-1}(a_1, \dots, a_k)} = \frac{a_0 P_{k-1}(a_1, \dots, a_k) + Q_{k-1}(a_1, \dots, a_k)}{P_{k-1}(a_1, \dots, a_k)}.$$</div>
<p>از این نتیجه می‌شود که <span class="arithmatex">$Q_k(a_0, \dots, a_k) = P_{k-1}(a_1, \dots, a_k)$</span>. این رابطه زیر را به دست می‌دهد:</p>
<div class="arithmatex">$$P_k(a_0, \dots, a_k) = a_0 P_{k-1}(a_1, \dots, a_k) + P_{k-2}(a_2, \dots, a_k).$$</div>
<p>در ابتدا، <span class="arithmatex">$r_0 = \frac{a_0}{1}$</span> و <span class="arithmatex">$r_1 = \frac{a_0 a_1 + 1}{a_1}$</span>، بنابراین</p>
<div class="arithmatex">$$\begin{align}P_0(a_0)&amp;=a_0,\\ P_1(a_0, a_1) &amp;= a_0 a_1 + 1.\end{align}$$</div>
<p>برای سازگاری، مناسب است که <span class="arithmatex">$P_{-1} = 1$</span> و <span class="arithmatex">$P_{-2}=0$</span> را تعریف کرده و به طور صوری بگوییم <span class="arithmatex">$r_{-1} = \frac{1}{0}$</span> و <span class="arithmatex">$r_{-2}=\frac{0}{1}$</span>.</p>
<p>از آنالیز عددی، می‌دانیم که دترمینان یک ماتریس سه‌قطری دلخواه</p>
<div class="arithmatex">$$T_k = \det \begin{bmatrix}
a_0 &amp; b_0 &amp; 0 &amp; \dots &amp; 0 \\
c_0 &amp; a_1 &amp; b_1 &amp; \dots &amp; 0 \\
0 &amp; c_1 &amp; a_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; c_{k-1} \\
0 &amp; 0 &amp; \dots &amp; b_{k-1} &amp; a_k
\end{bmatrix}$$</div>
<p>می‌تواند به صورت بازگشتی به شکل <span class="arithmatex">$T_k = a_k T_{k-1} - b_{k-1} c_{k-1} T_{k-2}$</span> محاسبه شود. با مقایسه آن با <span class="arithmatex">$P_k$</span>، یک عبارت مستقیم به دست می‌آوریم:</p>
<div class="arithmatex">$$P_k = \det \begin{bmatrix}
x_k &amp; 1 &amp; 0 &amp; \dots &amp; 0 \\
-1 &amp; x_{k-1} &amp; 1 &amp; \dots &amp; 0 \\
0 &amp; -1 &amp; x_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; 1 \\
0 &amp; 0 &amp; \dots &amp; -1 &amp; x_0
\end{bmatrix}_{\textstyle .}$$</div>
<p>این چندجمله‌ای به دلیل ارتباط نزدیکش با کسرهای مسلسل، به عنوان <a href="https://en.wikipedia.org/wiki/Continuant_(mathematics)">ادامه‌دهنده</a> نیز شناخته می‌شود. ادامه‌دهنده اگر دنباله روی قطر اصلی معکوس شود، تغییر نمی‌کند. این فرمول جایگزینی برای محاسبه آن به دست می‌دهد:</p>
<div class="arithmatex">$$P_k(a_0, \dots, a_k) = a_k P_{k-1}(a_0, \dots, a_{k-1}) + P_{k-2}(a_0, \dots, a_{k-2}).$$</div>
</details>
<h3 id="_6">پیاده‌سازی<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>ما همگراها را به عنوان یک جفت دنباله <span class="arithmatex">$p_{-2}, p_{-1}, p_0, p_1, \dots, p_k$</span> و <span class="arithmatex">$q_{-2}, q_{-1}, q_0, q_1, \dots, q_k$</span> محاسبه خواهیم کرد:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">C++</label><label for="__tabbed_2_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">auto</span><span class="w"> </span><span class="n">convergents</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">it</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">make_pair</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">it</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">it</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="_7">درخت‌های کسرهای مسلسل<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p>دو راه اصلی برای ادغام تمام کسرهای مسلسل ممکن در ساختارهای درختی مفید وجود دارد.</p>
<h3 id="-stern-brocot">درخت اشترن-بروکوت (Stern-Brocot)<a class="headerlink" href="#-stern-brocot" title="Permanent link">&para;</a></h3>
<p><a href="../others/stern_brocot_tree_farey_sequences.html">درخت اشترن-بروکوت</a> یک درخت جستجوی دودویی است که شامل تمام اعداد گویای مثبت متمایز است.</p>
<p>درخت به طور کلی به شکل زیر است:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/3/37/SternBrocotTree.svg">
<figcaption>
<a href="https://commons.wikimedia.org/wiki/File:SternBrocotTree.svg">تصویر</a> از <a href="https://commons.wikimedia.org/wiki/User:Aaron_Rotenberg">Aaron Rotenberg</a> تحت مجوز <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">CC BY-SA 3.0</a>
</figcaption>
</figure>

<p>کسرهای <span class="arithmatex">$\frac{0}{1}$</span> و <span class="arithmatex">$\frac{1}{0}$</span> به طور "مجازی" به ترتیب در سمت چپ و راست درخت نگهداری می‌شوند.</p>
<p>سپس کسر در یک گره، میانه <span class="arithmatex">$\frac{a+c}{b+d}$</span> دو کسر <span class="arithmatex">$\frac{a}{b}$</span> و <span class="arithmatex">$\frac{c}{d}$</span> بالای آن است.</p>
<p>رابطه بازگشتی <span class="arithmatex">$\frac{p_k}{q_k}=\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}}$</span> به این معناست که نمایش کسر مسلسل، مسیر به <span class="arithmatex">$\frac{p_k}{q_k}$</span> را در درخت کدگذاری می‌کند. برای یافتن <span class="arithmatex">$[a_0; a_1, \dots, a_{k}, 1]$</span>، باید <span class="arithmatex">$a_0$</span> حرکت به راست، <span class="arithmatex">$a_1$</span> حرکت به چپ، <span class="arithmatex">$a_2$</span> حرکت به راست و به همین ترتیب تا <span class="arithmatex">$a_k$</span> انجام داد.</p>
<p>والد <span class="arithmatex">$[a_0; a_1, \dots, a_k,1]$</span> کسری است که با برداشتن یک قدم به عقب در آخرین جهت استفاده شده به دست می‌آید.</p>
<p>به عبارت دیگر، وقتی <span class="arithmatex">$a_k &gt; 1$</span> برابر با <span class="arithmatex">$[a_0; a_1, \dots, a_k-1,1]$</span> و وقتی <span class="arithmatex">$a_k = 1$</span> برابر با <span class="arithmatex">$[a_0; a_1, \dots, a_{k-1}, 1]$</span> است.</p>
<p>بنابراین فرزندان <span class="arithmatex">$[a_0; a_1, \dots, a_k, 1]$</span> عبارتند از <span class="arithmatex">$[a_0; a_1, \dots, a_k+1, 1]$</span> و <span class="arithmatex">$[a_0; a_1, \dots, a_k, 1, 1]$</span>.</p>
<p>بیایید درخت اشترن-بروکوت را اندیس‌گذاری کنیم. به رأس ریشه اندیس ۱ اختصاص داده می‌شود. سپس برای یک رأس <span class="arithmatex">$v$</span>، اندیس فرزند چپ آن با تغییر بیت پیشروی <span class="arithmatex">$v$</span> از ۱ به ۱۰ و برای فرزند راست، با تغییر بیت پیشرو از ۱ به ۱۱ اختصاص داده می‌شود:</p>
<figure><img src="https://upload.wikimedia.org/wikipedia/commons/1/18/Stern-brocot-index.svg" width="500px"/></figure>

<p>در این اندیس‌گذاری، نمایش کسر مسلسل یک عدد گویا، <a href="https://en.wikipedia.org/wiki/Run-length_encoding">کدگذاری طول اجرا</a> اندیس دودویی آن را مشخص می‌کند.</p>
<p>برای <span class="arithmatex">$\frac{5}{2} = [2;2] = [2;1,1]$</span>، اندیس آن <span class="arithmatex">$1011_2$</span> است و کدگذاری طول اجرای آن، با در نظر گرفتن بیت‌ها به ترتیب صعودی، <span class="arithmatex">$[2;1,1]$</span> است.</p>
<p>مثال دیگر <span class="arithmatex">$\frac{2}{5} = [0;2,2]=[0;2,1,1]$</span> است که اندیس <span class="arithmatex">$1100_2$</span> دارد و کدگذاری طول اجرای آن در واقع <span class="arithmatex">$[0;2,2]$</span> است.</p>
<p>شایان ذکر است که درخت اشترن-بروکوت، در واقع یک <a href="../data_structures/treap.html">treap</a> است. یعنی، از نظر مقدار <span class="arithmatex">$\frac{p}{q}$</span> یک درخت جستجوی دودویی است، اما از نظر <span class="arithmatex">$p$</span> و <span class="arithmatex">$q$</span> هر دو یک هیپ است.</p>
<div class="admonition example">
<p class="admonition-title">مقایسه کسرهای مسلسل</p>
<p>شما دو کسر <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> و <span class="arithmatex">$B=[b_0; b_1, \dots, b_m]$</span> دارید. کدام کسر کوچکتر است؟</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>فعلاً فرض کنید <span class="arithmatex">$A$</span> و <span class="arithmatex">$B$</span> گنگ هستند و نمایش کسرهای مسلسل آن‌ها نشان‌دهنده یک فرود بی‌نهایت در درخت اشترن-بروکوت است.</p>
<p>همانطور که قبلاً ذکر کردیم، در این نمایش <span class="arithmatex">$a_0$</span> تعداد چرخش‌های به راست در فرود، <span class="arithmatex">$a_1$</span> تعداد چرخش‌های متوالی به چپ و غیره را نشان می‌دهد. بنابراین، وقتی <span class="arithmatex">$a_k$</span> و <span class="arithmatex">$b_k$</span> را مقایسه می‌کنیم، اگر <span class="arithmatex">$a_k = b_k$</span> باشد باید به مقایسه <span class="arithmatex">$a_{k+1}$</span> و <span class="arithmatex">$b_{k+1}$</span> برویم. در غیر این صورت، اگر در فرودهای راست هستیم، باید بررسی کنیم که آیا <span class="arithmatex">$a_k &lt; b_k$</span> و اگر در فرودهای چپ هستیم، باید بررسی کنیم که آیا <span class="arithmatex">$a_k &gt; b_k$</span> تا بگوییم آیا <span class="arithmatex">$A &lt; B$</span>.</p>
<p>به عبارت دیگر، برای <span class="arithmatex">$A$</span> و <span class="arithmatex">$B$</span> گنگ، <span class="arithmatex">$A &lt; B$</span> خواهد بود اگر و تنها اگر <span class="arithmatex">$(a_0, -a_1, a_2, -a_3, \dots) &lt; (b_0, -b_1, b_2, -b_3, \dots)$</span> با مقایسه لغت‌نامه‌ای.</p>
<p>حال، با استفاده رسمی از <span class="arithmatex">$\infty$</span> به عنوان عنصری از نمایش کسر مسلسل، می‌توان اعداد گنگ <span class="arithmatex">$A-\varepsilon$</span> و <span class="arithmatex">$A+\varepsilon$</span> را شبیه‌سازی کرد، یعنی عناصری که کوچکتر (بزرگتر) از <span class="arithmatex">$A$</span> هستند، اما بزرگتر (کوچکتر) از هر عدد حقیقی دیگر. به طور خاص، برای <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span>، یکی از این دو عنصر را می‌توان به صورت <span class="arithmatex">$[a_0; a_1, \dots, a_n, \infty]$</span> و دیگری را به صورت <span class="arithmatex">$[a_0; a_1, \dots, a_n - 1, 1, \infty]$</span> شبیه‌سازی کرد.</p>
<p>اینکه کدام یک به <span class="arithmatex">$A-\varepsilon$</span> و کدام به <span class="arithmatex">$A+\varepsilon$</span> مربوط می‌شود، با زوجیت <span class="arithmatex">$n$</span> یا با مقایسه آن‌ها به عنوان اعداد گنگ تعیین می‌شود.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># بررسی می‌کند که آیا a &lt; b با فرض اینکه a[-1] = b[-1] = infty و a != b</span>
<span class="k">def</span><span class="w"> </span><span class="nf">less</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>

<span class="c1"># [a0; a1, ..., ak] -&gt; [a0, a1, ..., ak-1, 1]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">expand</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">:</span> <span class="c1"># a خالی = inf</span>
        <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="c1"># a-eps, a+eps را برمی‌گرداند</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pm_eps</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">if</span> <span class="n">less</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title">بهترین نقطه درونی</p>
<p>شما <span class="arithmatex">$\frac{0}{1} \leq \frac{p_0}{q_0} &lt; \frac{p_1}{q_1} \leq \frac{1}{0}$</span> را دارید. عدد گویای <span class="arithmatex">$\frac{p}{q}$</span> را پیدا کنید به طوری که <span class="arithmatex">$(q; p)$</span> از نظر لغت‌نامه‌ای کوچکترین باشد و <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p}{q} &lt; \frac{p_1}{q_1}$</span>.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>از نظر درخت اشترن-بروکوت، این به این معناست که ما باید پایین‌ترین جد مشترک (LCA) <span class="arithmatex">$\frac{p_0}{q_0}$</span> و <span class="arithmatex">$\frac{p_1}{q_1}$</span> را پیدا کنیم. به دلیل ارتباط بین درخت اشترن-بروکوت و کسر مسلسل، این LCA تقریباً با بزرگترین پیشوند مشترک نمایش‌های کسر مسلسل برای <span class="arithmatex">$\frac{p_0}{q_0}$</span> و <span class="arithmatex">$\frac{p_1}{q_1}$</span> مطابقت دارد.</p>
<p>بنابراین، اگر <span class="arithmatex">$\frac{p_0}{q_0} = [a_0; a_1, \dots, a_{k-1}, a_k, \dots]$</span> و <span class="arithmatex">$\frac{p_1}{q_1} = [a_0; a_1, \dots, a_{k-1}, b_k, \dots]$</span> اعداد گنگ باشند، LCA برابر است با <span class="arithmatex">$[a_0; a_1, \dots, \min(a_k, b_k)+1]$</span>.</p>
<p>برای اعداد گویای <span class="arithmatex">$r_0$</span> و <span class="arithmatex">$r_1$</span>، یکی از آنها می‌تواند خود LCA باشد که ما را ملزم به بررسی حالت‌های مختلف می‌کند. برای ساده‌سازی راه‌حل برای <span class="arithmatex">$r_0$</span> و <span class="arithmatex">$r_1$</span> گویا، می‌توان از نمایش کسر مسلسل <span class="arithmatex">$r_0 + \varepsilon$</span> و <span class="arithmatex">$r_1 - \varepsilon$</span> که در مسئله قبلی به دست آمد، استفاده کرد.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># کوچکترین (q, p) از نظر لغت‌نامه‌ای را پیدا می‌کند</span>
<span class="c1"># به طوری که p0/q0 &lt; p/q &lt; p1/q1</span>
<span class="k">def</span><span class="w"> </span><span class="nf">middle</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
    <span class="n">a0</span> <span class="o">=</span> <span class="n">pm_eps</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">pm_eps</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">))):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">a0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">a0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">break</span>
    <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://codingcompetitions.withgoogle.com/codejam/round/0000000000051679/0000000000146184">GCJ 2019, Round 2 - New Elements: Part 2</a></p>
<p>شما <span class="arithmatex">$N$</span> جفت عدد صحیح مثبت <span class="arithmatex">$(C_i, J_i)$</span> دارید. باید یک جفت عدد صحیح مثبت <span class="arithmatex">$(x, y)$</span> پیدا کنید به طوری که <span class="arithmatex">$C_i x + J_i y$</span> یک دنباله اکیداً صعودی باشد.</p>
<p>در میان چنین جفت‌هایی، کوچکترین جفت از نظر لغت‌نامه‌ای را پیدا کنید.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>با بازنویسی صورت مسئله، <span class="arithmatex">$A_i x + B_i y$</span> باید برای همه <span class="arithmatex">$i$</span> مثبت باشد، که در آن <span class="arithmatex">$A_i = C_i - C_{i-1}$</span> و <span class="arithmatex">$B_i = J_i - J_{i-1}$</span>.</p>
<p>در میان چنین معادلاتی، چهار گروه مهم برای <span class="arithmatex">$A_i x + B_i y &gt; 0$</span> داریم:</p>
<ol>
<li><span class="arithmatex">$A_i, B_i &gt; 0$</span> را می‌توان نادیده گرفت زیرا به دنبال <span class="arithmatex">$x, y &gt; 0$</span> هستیم.</li>
<li><span class="arithmatex">$A_i, B_i \leq 0$</span> پاسخ "IMPOSSIBLE" را به همراه خواهد داشت.</li>
<li><span class="arithmatex">$A_i &gt; 0$</span>, <span class="arithmatex">$B_i \leq 0$</span>. چنین قیودی معادل <span class="arithmatex">$\frac{y}{x} &lt; \frac{A_i}{-B_i}$</span> هستند.</li>
<li><span class="arithmatex">$A_i \leq 0$</span>, <span class="arithmatex">$B_i &gt; 0$</span>. چنین قیودی معادل <span class="arithmatex">$\frac{y}{x} &gt; \frac{-A_i}{B_i}$</span> هستند.</li>
</ol>
<p>فرض کنید <span class="arithmatex">$\frac{p_0}{q_0}$</span> بزرگترین <span class="arithmatex">$\frac{-A_i}{B_i}$</span> از گروه چهارم و <span class="arithmatex">$\frac{p_1}{q_1}$</span> کوچکترین <span class="arithmatex">$\frac{A_i}{-B_i}$</span> از گروه سوم باشد.</p>
<p>مسئله اکنون این است که با داشتن <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p_1}{q_1}$</span>، کسری <span class="arithmatex">$\frac{p}{q}$</span> پیدا کنید به طوری که <span class="arithmatex">$(q;p)$</span> از نظر لغت‌نامه‌ای کوچکترین باشد و <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p}{q} &lt; \frac{p_1}{q_1}$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">():</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="c1"># p0/q0 &lt; y/x &lt; p1/q1</span>
    <span class="n">p0</span><span class="p">,</span> <span class="n">q0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">fail</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">A</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">B</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fail</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># y/x &gt; (-A)/B if B &gt; 0</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">q0</span> <span class="o">&gt;</span> <span class="n">p0</span><span class="o">*</span><span class="n">B</span><span class="p">:</span>
                    <span class="n">p0</span><span class="p">,</span> <span class="n">q0</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span>
            <span class="k">elif</span> <span class="n">B</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># y/x &lt; A/(-B) if B &lt; 0</span>
                <span class="k">if</span> <span class="n">A</span><span class="o">*</span><span class="n">q1</span> <span class="o">&lt;</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">B</span><span class="p">):</span>
                    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="n">B</span>
    <span class="k">if</span> <span class="n">p0</span><span class="o">*</span><span class="n">q1</span> <span class="o">&gt;=</span> <span class="n">p1</span><span class="o">*</span><span class="n">q0</span> <span class="ow">or</span> <span class="n">fail</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;IMPOSSIBLE&#39;</span>

    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h3 id="-calkin-wilf">درخت کالکین-ویلف (Calkin-Wilf)<a class="headerlink" href="#-calkin-wilf" title="Permanent link">&para;</a></h3>
<p>یک راه تا حدودی ساده‌تر برای سازماندهی کسرهای مسلسل در یک درخت دودویی، <a href="https://en.wikipedia.org/wiki/Calkin–Wilf_tree">درخت کالکین-ویلف</a> است.</p>
<p>درخت به طور کلی به این شکل است:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Calkin–Wilf_tree.svg" width="500px"/>
<figcaption><a href="https://commons.wikimedia.org/wiki/File:Calkin–Wilf_tree.svg">تصویر</a> از <a href="https://commons.wikimedia.org/wiki/User:Olli_Niemitalo">Olli Niemitalo</a>, <a href="https://commons.wikimedia.org/wiki/User:Proz">Proz</a> تحت مجوز <a href="https://creativecommons.org/publicdomain/zero/1.0/deed.en">CC0 1.0</a></figcaption>
</figure>

<p>در ریشه درخت، عدد <span class="arithmatex">$\frac{1}{1}$</span> قرار دارد. سپس، برای رأسی با عدد <span class="arithmatex">$\frac{p}{q}$</span>، فرزندان آن <span class="arithmatex">$\frac{p}{p+q}$</span> و <span class="arithmatex">$\frac{p+q}{q}$</span> هستند.</p>
<p>برخلاف درخت اشترن-بروکوت، درخت کالکین-ویلف یک درخت جستجوی دودویی نیست، بنابراین نمی‌توان از آن برای انجام جستجوی دودویی گویا استفاده کرد.</p>
<p>در درخت کالکین-ویلف، والد مستقیم کسر <span class="arithmatex">$\frac{p}{q}$</span>، وقتی <span class="arithmatex">$p&gt;q$</span> برابر با <span class="arithmatex">$\frac{p-q}{q}$</span> و در غیر این صورت <span class="arithmatex">$\frac{p}{q-p}$</span> است.</p>
<p>برای درخت اشترن-بروکوت، از رابطه بازگشتی برای همگراها استفاده کردیم. برای برقراری ارتباط بین کسر مسلسل و درخت کالکین-ویلف، باید رابطه بازگشتی برای خارج‌قسمت‌های کامل را به یاد بیاوریم. اگر <span class="arithmatex">$s_k = \frac{p}{q}$</span>، آنگاه <span class="arithmatex">$s_{k+1} = \frac{q}{p \mod q} = \frac{q}{p-\lfloor p/q \rfloor \cdot q}$</span>.</p>
<p>از طرف دیگر، اگر به طور مکرر از <span class="arithmatex">$s_k = \frac{p}{q}$</span> به والدش در درخت کالکین-ویلف برویم وقتی <span class="arithmatex">$p &gt; q$</span>، به <span class="arithmatex">$\frac{p \mod q}{q} = \frac{1}{s_{k+1}}$</span> می‌رسیم. اگر این کار را ادامه دهیم، به <span class="arithmatex">$s_{k+2}$</span>، سپس <span class="arithmatex">$\frac{1}{s_{k+3}}$</span> و به همین ترتیب می‌رسیم. از این می‌توان نتیجه گرفت که:</p>
<ol>
<li>وقتی <span class="arithmatex">$a_0&gt; 0$</span>، والد مستقیم <span class="arithmatex">$[a_0; a_1, \dots, a_k]$</span> در درخت کالکین-ویلف <span class="arithmatex">$\frac{p-q}{q}=[a_0 - 1; a_1, \dots, a_k]$</span> است.</li>
<li>وقتی <span class="arithmatex">$a_0 = 0$</span> و <span class="arithmatex">$a_1 &gt; 1$</span>، والد مستقیم آن <span class="arithmatex">$\frac{p}{q-p} = [0; a_1 - 1, a_2, \dots, a_k]$</span> است.</li>
<li>و وقتی <span class="arithmatex">$a_0 = 0$</span> و <span class="arithmatex">$a_1 = 1$</span>، والد مستقیم آن <span class="arithmatex">$\frac{p}{q-p} = [a_2; a_3, \dots, a_k]$</span> است.</li>
</ol>
<p>به همین ترتیب، فرزندان <span class="arithmatex">$\frac{p}{q} = [a_0; a_1, \dots, a_k]$</span> عبارتند از:</p>
<ol>
<li><span class="arithmatex">$\frac{p+q}{q}=1+\frac{p}{q}$</span>، که برابر با <span class="arithmatex">$[a_0+1; a_1, \dots, a_k]$</span> است،</li>
<li><span class="arithmatex">$\frac{p}{p+q} = \frac{1}{1+\frac{q}{p}}$</span>، که برای <span class="arithmatex">$a_0 &gt; 0$</span> برابر با <span class="arithmatex">$[0, 1, a_0, a_1, \dots, a_k]$</span> و برای <span class="arithmatex">$a_0=0$</span> برابر با <span class="arithmatex">$[0, a_1+1, a_2, \dots, a_k]$</span> است.</li>
</ol>
<p>شایان ذکر است، اگر رئوس درخت کالکین-ویلف را به ترتیب جستجوی سطح-اول شماره‌گذاری کنیم (یعنی ریشه عدد ۱ دارد و فرزندان رأس <span class="arithmatex">$v$</span> به ترتیب اندیس‌های <span class="arithmatex">$2v$</span> و <span class="arithmatex">$2v+1$</span> را دارند)، اندیس عدد گویا در درخت کالکین-ویلف با اندیس آن در درخت اشترن-بروکوت یکسان خواهد بود.</p>
<p>بنابراین، اعداد در سطوح یکسان درخت اشترن-بروکوت و درخت کالکین-ویلف یکسان هستند، اما ترتیب آنها از طریق <a href="https://en.wikipedia.org/wiki/Bit-reversal_permutation">جایگشت بیت-معکوس</a> متفاوت است.</p>
<h2 id="_8">همگرایی<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<p>برای عدد <span class="arithmatex">$r$</span> و <span class="arithmatex">$k$</span>-امین همگرای آن <span class="arithmatex">$r_k=\frac{p_k}{q_k}$</span> فرمول زیر برقرار است:</p>
<div class="arithmatex">$$r_k = a_0 + \sum\limits_{i=1}^k \frac{(-1)^{i-1}}{q_i q_{i-1}}.$$</div>
<p>به طور خاص، این به معنای آن است که</p>
<div class="arithmatex">$$r_k - r_{k-1} = \frac{(-1)^{k-1}}{q_k q_{k-1}}$$</div>
<p>و</p>
<div class="arithmatex">$$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}.$$</div>
<p>از این می‌توانیم نتیجه بگیریم که</p>
<div class="arithmatex">$$\left| r-\frac{p_k}{q_k} \right| \leq \frac{1}{q_{k+1}q_k} \leq \frac{1}{q_k^2}.$$</div>
<p>نامساوی دوم به این دلیل است که <span class="arithmatex">$r_k$</span> و <span class="arithmatex">$r_{k+1}$</span> به طور کلی در دو طرف مختلف <span class="arithmatex">$r$</span> قرار دارند، بنابراین</p>
<div class="arithmatex">$$|r-r_k| = |r_k-r_{k+1}|-|r-r_{k+1}| \leq |r_k - r_{k+1}|.$$</div>
<details class="tip">
<summary>توضیح کامل</summary>
<p>برای تخمین <span class="arithmatex">$|r-r_k|$</span>، با تخمین تفاوت بین همگراهای مجاور شروع می‌کنیم. طبق تعریف،</p>
<div class="arithmatex">$$\frac{p_k}{q_k} - \frac{p_{k-1}}{q_{k-1}} = \frac{p_k q_{k-1} - p_{k-1} q_k}{q_k q_{k-1}}.$$</div>
<p>با جایگزینی <span class="arithmatex">$p_k$</span> و <span class="arithmatex">$q_k$</span> در صورت کسر با روابط بازگشتی آنها، داریم</p>
<div class="arithmatex">$$\begin{align} p_k q_{k-1} - p_{k-1} q_k &amp;= (a_k p_{k-1} + p_{k-2}) q_{k-1} - p_{k-1} (a_k q_{k-1} + q_{k-2})
\\&amp;= p_{k-2} q_{k-1} - p_{k-1} q_{k-2},\end{align}$$</div>
<p>بنابراین صورت کسر <span class="arithmatex">$r_k - r_{k-1}$</span> همیشه برابر با قرینه صورت کسر <span class="arithmatex">$r_{k-1} - r_{k-2}$</span> است. این به نوبه خود، برای</p>
<div class="arithmatex">$$r_1 - r_0=\left(a_0+\frac{1}{a_1}\right)-a_0=\frac{1}{a_1},$$</div>
<p>برابر با ۱ است، بنابراین</p>
<div class="arithmatex">$$r_k - r_{k-1} = \frac{(-1)^{k-1}}{q_k q_{k-1}}.$$</div>
<p>این یک نمایش جایگزین از <span class="arithmatex">$r_k$</span> به عنوان مجموع جزئی یک سری بی‌نهایت به دست می‌دهد:</p>
<div class="arithmatex">$$r_k = (r_k - r_{k-1}) + \dots + (r_1 - r_0) + r_0
= a_0 + \sum\limits_{i=1}^k \frac{(-1)^{i-1}}{q_i q_{i-1}}.$$</div>
<p>از رابطه بازگشتی نتیجه می‌شود که <span class="arithmatex">$q_k$</span> به صورت یکنواخت حداقل به سرعت اعداد فیبوناچی افزایش می‌یابد، بنابراین</p>
<div class="arithmatex">$$r = \lim\limits_{k \to \infty} r_k = a_0 + \sum\limits_{i=1}^\infty \frac{(-1)^{i-1}}{q_i q_{i-1}}$$</div>
<p>همیشه به خوبی تعریف شده است، زیرا سری زیربنایی همیشه همگراست. شایان ذکر است، سری باقیمانده</p>
<div class="arithmatex">$$r-r_k = \sum\limits_{i=k+1}^\infty \frac{(-1)^{i-1}}{q_i q_{i-1}}$$</div>
<p>به دلیل سرعت کاهش <span class="arithmatex">$q_i q_{i-1}$</span>، هم‌علامت با <span class="arithmatex">$(-1)^k$</span> است. از این رو <span class="arithmatex">$r_k$</span> با اندیس زوج از پایین به <span class="arithmatex">$r$</span> نزدیک می‌شود در حالی که <span class="arithmatex">$r_k$</span> با اندیس فرد از بالا به آن نزدیک می‌شود:</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Golden_ration_convergents.svg" width="600px"/>
<figcaption><em>همگراهای <span class="arithmatex">$r=\phi = \frac{1+\sqrt{5}}{2}=[1;1,1,\dots]$</span> و فاصله آنها از <span class="arithmatex">$r$</span>.</em></figcaption></figure></p>
<p>از این تصویر می‌توانیم ببینیم که</p>
<div class="arithmatex">$$|r-r_k| = |r_k - r_{k+1}| - |r-r_{k+1}| \leq |r_k - r_{k+1}|,$$</div>
<p>بنابراین فاصله بین <span class="arithmatex">$r$</span> و <span class="arithmatex">$r_k$</span> هرگز بزرگتر از فاصله بین <span class="arithmatex">$r_k$</span> و <span class="arithmatex">$r_{k+1}$</span> نیست:</p>
<div class="arithmatex">$$\left|r-\frac{p_k}{q_k}\right| \leq \frac{1}{q_k q_{k+1}} \leq \frac{1}{q_k^2}.$$</div>
</details>
<div class="admonition example">
<p class="admonition-title">اقلیدس گسترش‌یافته؟</p>
<p>شما سه عدد صحیح <span class="arithmatex">$A, B, C \in \mathbb Z$</span> دارید. اعداد صحیح <span class="arithmatex">$x, y \in \mathbb Z$</span> را پیدا کنید به طوری که <span class="arithmatex">$Ax + By = C$</span>.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>اگرچه این مسئله به طور معمول با <a href="extended-euclid-algorithm.html">الگوریتم اقلیدس گسترش‌یافته</a> حل می‌شود، اما یک راه‌حل ساده و مستقیم با کسرهای مسلسل وجود دارد.</p>
<p>فرض کنید <span class="arithmatex">$\frac{A}{B}=[a_0; a_1, \dots, a_k]$</span>. در بالا ثابت شد که <span class="arithmatex">$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}$</span>. با جایگزینی <span class="arithmatex">$p_k$</span> و <span class="arithmatex">$q_k$</span> با <span class="arithmatex">$A$</span> و <span class="arithmatex">$B$</span>، داریم</p>
<div class="arithmatex">$$Aq_{k-1} - Bp_{k-1} = (-1)^{k-1} g,$$</div>
<p>که در آن <span class="arithmatex">$g = \gcd(A, B)$</span> است. اگر <span class="arithmatex">$C$</span> بر <span class="arithmatex">$g$</span> بخش‌پذیر باشد، آنگاه راه‌حل <span class="arithmatex">$x = (-1)^{k-1}\frac{C}{g} q_{k-1}$</span> و <span class="arithmatex">$y = (-1)^{k}\frac{C}{g} p_{k-1}$</span> است.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># (x, y) را برمی‌گرداند به طوری که Ax+By=C</span>
<span class="c1"># فرض می‌شود که چنین (x, y) وجود دارد</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dio</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
    <span class="n">C</span> <span class="o">//=</span> <span class="n">A</span> <span class="o">//</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># تقسیم بر ب.م.م(A, B)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span> <span class="c1"># در متن اصلی (-1)^(k-1) بود. len(p) = k+3. پس k-1 زوج است اگر len(p) فرد باشد</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">t</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="_9">تبدیلات کسری خطی<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<p>مفهوم مهم دیگر برای کسرهای مسلسل، به اصطلاح <a href="https://en.wikipedia.org/wiki/Linear_fractional_transformation">تبدیلات کسری خطی</a> است.</p>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>یک <strong>تبدیل کسری خطی</strong> تابعی است <span class="arithmatex">$f : \mathbb R \to \mathbb R$</span> به طوری که <span class="arithmatex">$f(x) = \frac{ax+b}{cx+d}$</span> برای مقادیری از <span class="arithmatex">$a,b,c,d \in \mathbb R$</span>.</p>
</div>
<p>ترکیب <span class="arithmatex">$(L_0 \circ L_1)(x) = L_0(L_1(x))$</span> از تبدیلات کسری خطی <span class="arithmatex">$L_0(x)=\frac{a_0 x + b_0}{c_0 x + d_0}$</span> و <span class="arithmatex">$L_1(x)=\frac{a_1 x + b_1}{c_1 x + d_1}$</span> خود یک تبدیل کسری خطی است:</p>
<div class="arithmatex">$$\frac{a_0\frac{a_1 x + b_1}{c_1 x + d_1} + b_0}{c_0 \frac{a_1 x + b_1}{c_1 x + d_1} + d_0} = \frac{a_0(a_1 x + b_1) + b_0 (c_1 x + d_1)}{c_0 (a_1 x + b_1) + d_0 (c_1 x + d_1)} = \frac{(a_0 a_1 + b_0 c_1) x + (a_0 b_1 + b_0 d_1)}{(c_0 a_1 + d_0 c_1) x + (c_0 b_1 + d_0 d_1)}.$$</div>
<p>معکوس یک تبدیل کسری خطی، نیز یک تبدیل کسری خطی است:</p>
<div class="arithmatex">$$y = \frac{ax+b}{cx+d} \iff y(cx+d) = ax + b \iff x = -\frac{dy-b}{cy-a}.$$</div>
<div class="admonition example">
<p class="admonition-title"><a href="https://dmoj.ca/problem/dmopc19c7p4">DMOPC '19 Contest 7 P4 - Bob and Continued Fractions</a></p>
<p>شما یک آرایه از اعداد صحیح مثبت <span class="arithmatex">$a_1, \dots, a_n$</span> دارید. باید به <span class="arithmatex">$m$</span> پرس‌وجو پاسخ دهید. هر پرس‌وجو محاسبه <span class="arithmatex">$[a_l; a_{l+1}, \dots, a_r]$</span> است.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>اگر بتوانیم کسرهای مسلسل را به هم بچسبانیم، می‌توانیم این مسئله را با درخت بازه‌ها حل کنیم.</p>
<p>به طور کلی درست است که <span class="arithmatex">$[a_0; a_1, \dots, a_k, b_0, b_1, \dots, b_m] = [a_0; a_1, \dots, a_k, [b_0; b_1, \dots, b_m]]$</span>. در اینجا <span class="arithmatex">$b_0$</span> باید جایگزین <span class="arithmatex">$x$</span> شود.</p>
<p>بیایید <span class="arithmatex">$L_{k}(x) = [a_k; x] = a_k + \frac{1}{x} = \frac{a_k\cdot x+1}{1\cdot x + 0}$</span> را نشان دهیم. توجه داشته باشید که <span class="arithmatex">$L_k(\infty) = a_k$</span>. در این نمادگذاری، داریم</p>
<div class="arithmatex">$$[a_0; a_1, \dots, a_k, x] = [a_0; [a_1; [\dots; [a_k; x]]]] = (L_0 \circ L_1 \circ \dots \circ L_k)(x) = \frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$</div>
<p>بنابراین، مسئله به محاسبه زیر خلاصه می‌شود:</p>
<div class="arithmatex">$$(L_l \circ L_{l+1} \circ \dots \circ L_r)(\infty).$$</div>
<p>ترکیب تبدیلات شرکت‌پذیر است، بنابراین می‌توان در هر گره از یک درخت بازه‌ها، ترکیب تبدیلات زیردرخت آن را محاسبه کرد.</p>
</details>
<div class="admonition example">
<p class="admonition-title">تبدیل کسری خطی یک کسر مسلسل</p>
<p>فرض کنید <span class="arithmatex">$L(x) = \frac{ax+b}{cx+d}$</span>. نمایش کسر مسلسل <span class="arithmatex">$[b_0; b_1, \dots, b_m]$</span> از <span class="arithmatex">$L(A)$</span> را برای <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> محاسبه کنید.</p>
<p><em>این امکان محاسبه <span class="arithmatex">$A + \frac{p}{q} = \frac{qA + p}{q}$</span> و <span class="arithmatex">$A \cdot \frac{p}{q} = \frac{p A}{q}$</span> را برای هر <span class="arithmatex">$\frac{p}{q}$</span> فراهم می‌کند.</em></p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>همانطور که در بالا اشاره کردیم، <span class="arithmatex">$[a_0; a_1, \dots, a_k] = (L_{a_0} \circ L_{a_1} \circ \dots \circ L_{a_k})(\infty)$</span>، از این رو <span class="arithmatex">$L([a_0; a_1, \dots, a_k]) = (L \circ L_{a_0} \circ L_{a_1} \circ \dots L_{a_k})(\infty)$</span>.</p>
<p>بنابراین، با اضافه کردن متوالی <span class="arithmatex">$L_{a_0}$</span>، <span class="arithmatex">$L_{a_1}$</span> و غیره، قادر خواهیم بود محاسبه کنیم:</p>
<div class="arithmatex">$$(L \circ L_{a_0} \circ \dots \circ L_{a_k})(x) = L\left(\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}\right)=\frac{a_k' x + b_k'}{c_k' x + d_k'}.$$</div>
<p>از آنجا که <span class="arithmatex">$L(x)$</span> معکوس‌پذیر است، در <span class="arithmatex">$x$</span> نیز یکنوا است. بنابراین، برای هر <span class="arithmatex">$x \geq 0$</span> داریم که <span class="arithmatex">$L(\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}})$</span> بین <span class="arithmatex">$L(\frac{p_k}{q_k}) = \frac{a_k'}{c_k'}$</span> و <span class="arithmatex">$L(\frac{p_{k-1}}{q_{k-1}}) = \frac{b_k'}{d_k'}$</span> قرار دارد.</p>
<p>علاوه بر این، برای <span class="arithmatex">$x=[a_{k+1}; \dots, a_n]$</span> برابر با <span class="arithmatex">$L(A)$</span> است. از این رو، <span class="arithmatex">$b_0 = \lfloor L(A) \rfloor$</span> بین <span class="arithmatex">$\lfloor L(\frac{p_k}{q_k}) \rfloor$</span> و <span class="arithmatex">$\lfloor L(\frac{p_{k-1}}{q_{k-1}}) \rfloor$</span> است. وقتی آنها برابر هستند، آنها نیز برابر با <span class="arithmatex">$b_0$</span> هستند.</p>
<p>توجه داشته باشید که <span class="arithmatex">$L(A) = (L_{b_0} \circ L_{b_1} \circ \dots \circ L_{b_m})(\infty)$</span>. با دانستن <span class="arithmatex">$b_0$</span>، می‌توانیم <span class="arithmatex">$L_{b_0}^{-1}$</span> را با تبدیل فعلی ترکیب کنیم و به اضافه کردن <span class="arithmatex">$L_{a_{k+1}}$</span>، <span class="arithmatex">$L_{a_{k+2}}$</span> و غیره ادامه دهیم، به دنبال توافق کف‌های جدید، که از آن قادر خواهیم بود <span class="arithmatex">$b_1$</span> و غیره را استنتاج کنیم تا زمانی که تمام مقادیر <span class="arithmatex">$[b_0; b_1, \dots, b_m]$</span> را بازیابی کنیم.</p>
</details>
<div class="admonition example">
<p class="admonition-title">محاسبات روی کسرهای مسلسل</p>
<p>فرض کنید <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> و <span class="arithmatex">$B=[b_0; b_1, \dots, b_m]$</span>. نمایش‌های کسر مسلسل <span class="arithmatex">$A+B$</span> و <span class="arithmatex">$A \cdot B$</span> را محاسبه کنید.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>ایده در اینجا شبیه به مسئله قبلی است، اما به جای <span class="arithmatex">$L(x) = \frac{ax+b}{cx+d}$</span> باید تبدیل کسری دوخطی <span class="arithmatex">$L(x, y) = \frac{axy+bx+cy+d}{exy+fx+gy+h}$</span> را در نظر بگیرید.</p>
<p>به جای <span class="arithmatex">$L(x) \mapsto L(L_{a_k}(x))$</span>، تبدیل فعلی خود را به صورت <span class="arithmatex">$L(x, y) \mapsto L(L_{a_k}(x), y)$</span> یا <span class="arithmatex">$L(x, y) \mapsto L(x, L_{b_k}(y))$</span> تغییر می‌دهید.</p>
<p>سپس، بررسی می‌کنید که آیا <span class="arithmatex">$\lfloor \frac{a}{e} \rfloor = \lfloor \frac{b}{f} \rfloor = \lfloor \frac{c}{g} \rfloor = \lfloor \frac{d}{h} \rfloor$</span> و اگر همه آنها موافق بودند، از این مقدار به عنوان <span class="arithmatex">$c_k$</span> در کسر حاصل استفاده می‌کنید و تبدیل را به صورت زیر تغییر می‌دهید:</p>
<div class="arithmatex">$$L(x, y) \mapsto \frac{1}{L(x, y) - c_k}.$$</div>
</details>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>یک کسر مسلسل <span class="arithmatex">$x = [a_0; a_1, \dots]$</span> <strong>متناوب</strong> (periodic) نامیده می‌شود اگر <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, x]$</span> برای یک <span class="arithmatex">$k$</span> معین.</p>
<p>یک کسر مسلسل <span class="arithmatex">$x = [a_0; a_1, \dots]$</span> <strong>در نهایت متناوب</strong> (eventually periodic) نامیده می‌شود اگر <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, y]$</span>، که در آن <span class="arithmatex">$y$</span> متناوب است.</p>
</div>
<p>برای <span class="arithmatex">$x = [1; 1, 1, \dots]$</span> داریم <span class="arithmatex">$x = 1 + \frac{1}{x}$</span>، بنابراین <span class="arithmatex">$x^2 = x + 1$</span>. یک ارتباط کلی بین کسرهای مسلسل متناوب و معادلات درجه دو وجود دارد. معادله زیر را در نظر بگیرید:</p>
<div class="arithmatex">$$ x = [a_0; a_1, \dots, a_k, x].$$</div>
<p>از یک طرف، این معادله به این معناست که نمایش کسر مسلسل <span class="arithmatex">$x$</span> با دوره تناوب <span class="arithmatex">$k+1$</span> متناوب است.</p>
<p>از طرف دیگر، با استفاده از فرمول همگراها، این معادله به این معناست که</p>
<div class="arithmatex">$$x = \frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$</div>
<p>یعنی، <span class="arithmatex">$x$</span> یک تبدیل کسری خطی از خودش است. از این معادله نتیجه می‌شود که <span class="arithmatex">$x$</span> یک ریشه معادله درجه دوم است:</p>
<div class="arithmatex">$$q_k x^2 + (q_{k-1}-p_k)x - p_{k-1} = 0.$$</div>
<p>استدلال مشابهی برای کسرهای مسلسلی که در نهایت متناوب هستند، برقرار است، یعنی <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, y]$</span> برای <span class="arithmatex">$y=[b_0; b_1, \dots, b_m, y]$</span>. در واقع، از معادله اول نتیجه می‌گیریم که <span class="arithmatex">$x = L_0(y)$</span> و از معادله دوم که <span class="arithmatex">$y = L_1(y)$</span>، که در آن <span class="arithmatex">$L_0$</span> و <span class="arithmatex">$L_1$</span> تبدیلات کسری خطی هستند. بنابراین،</p>
<div class="arithmatex">$$x = (L_0 \circ L_1)(y) = (L_0 \circ L_1 \circ L_0^{-1})(x).$$</div>
<p>می‌توان بیشتر ثابت کرد (و اولین بار توسط لاگرانژ انجام شد) که برای معادله درجه دوم دلخواه <span class="arithmatex">$ax^2+bx+c=0$</span> با ضرایب صحیح، ریشه آن <span class="arithmatex">$x$</span> یک کسر مسلسل در نهایت متناوب است.</p>
<div class="admonition example">
<p class="admonition-title">گنگی درجه دو</p>
<p>کسر مسلسل <span class="arithmatex">$\alpha = \frac{x+y\sqrt{n}}{z}$</span> را پیدا کنید که در آن <span class="arithmatex">$x, y, z, n \in \mathbb Z$</span> و <span class="arithmatex">$n &gt; 0$</span> یک مربع کامل نیست.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>برای <span class="arithmatex">$k$</span>-امین خارج‌قسمت کامل <span class="arithmatex">$s_k$</span> از عدد، به طور کلی داریم که</p>
<div class="arithmatex">$$\alpha = [a_0; a_1, \dots, a_{k-1}, s_k] = \frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$</div>
<p>بنابراین،</p>
<div class="arithmatex">$$s_k = -\frac{\alpha q_{k-1} - p_{k-1}}{\alpha q_k - p_k} = -\frac{q_{k-1} y \sqrt n + (x q_{k-1} - z p_{k-1})}{q_k y \sqrt n + (xq_k-zp_k)}.$$</div>
<p>با ضرب صورت و مخرج در <span class="arithmatex">$(xq_k - zp_k) - q_k y \sqrt n$</span>، از <span class="arithmatex">$\sqrt n$</span> در مخرج خلاص می‌شویم، بنابراین خارج‌قسمت‌های کامل به شکل زیر هستند:</p>
<div class="arithmatex">$$s_k = \frac{x_k + y_k \sqrt n}{z_k}.$$</div>
<p>بیایید <span class="arithmatex">$s_{k+1}$</span> را با فرض اینکه <span class="arithmatex">$s_k$</span> معلوم است، پیدا کنیم.</p>
<p>اول از همه، <span class="arithmatex">$a_k = \lfloor s_k \rfloor = \left\lfloor \frac{x_k + y_k \lfloor \sqrt n \rfloor}{z_k} \right\rfloor$</span> اشتباه است. باید <span class="arithmatex">$\lfloor \frac{x_k + y_k \sqrt n}{z_k} \rfloor$</span> باشد. اما چون <span class="arithmatex">$y_k \sqrt n$</span> گنگ است، محاسبه آن دشوار است. در کد از <span class="arithmatex">$\lfloor \frac{x_k + y_k \lfloor \sqrt n \rfloor}{z_k} \rfloor$</span> استفاده شده که برای <span class="arithmatex">$\alpha = \sqrt n$</span> کار می‌کند.</p>
<div class="arithmatex">$$s_{k+1} = \frac{1}{s_k-a_k} = \frac{z_k}{(x_k - z_k a_k) + y_k \sqrt n} = \frac{z_k (x_k - z_k a_k) - y_k z_k \sqrt n}{(x_k - z_k a_k)^2 - y_k^2 n}.$$</div>
<p>بنابراین، اگر <span class="arithmatex">$t_k = x_k - z_k a_k$</span> را نشان دهیم، خواهیم داشت:</p>
<div class="arithmatex">$$\begin{align}x_{k+1} &amp;=&amp; z_k t_k, \\ y_{k+1} &amp;=&amp; -y_k z_k, \\ z_{k+1} &amp;=&amp; t_k^2 - y_k^2 n.\end{align}$$</div>
<p>نکته خوب در مورد چنین نمایشی این است که اگر <span class="arithmatex">$x_{k+1}, y_{k+1}, z_{k+1}$</span> را بر بزرگترین مقسوم‌علیه مشترکشان ساده کنیم، نتیجه منحصر به فرد خواهد بود. بنابراین، می‌توانیم از آن برای بررسی اینکه آیا حالت فعلی قبلاً تکرار شده است و همچنین برای بررسی اینکه اندیس قبلی که این حالت را داشته، کجا بوده است، استفاده کنیم.</p>
<p>در کد زیر، <span class="arithmatex">$a_k$</span> به صورت <code>(x * n0 + y) // z</code> محاسبه می‌شود که برای <span class="arithmatex">$\sqrt n$</span> صحیح است چون در آن حالت <span class="arithmatex">$x, y, z$</span> ضرایب <span class="arithmatex">$\frac{x\sqrt n + y}{z}$</span> هستند.
کد زیر برای محاسبه نمایش کسر مسلسل <span class="arithmatex">$\alpha = \sqrt n$</span> است:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="c1"># محاسبه کسر مسلسل sqrt(n)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sqrt_cf</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))]</span>

    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">d</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">a0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">]</span>

    <span class="n">seen</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
        <span class="n">seen</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span><span class="n">d</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="n">d</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">a0</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span>

    <span class="n">start_period</span> <span class="o">=</span> <span class="n">seen</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">start_period</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">start_period</span><span class="p">:]</span> <span class="c1"># پیش‌دوره، دوره</span>
</code></pre></div>
</div>
</div>
</div>
<p>با استفاده از تابع <code>step</code> مشابه اما با <span class="arithmatex">$x$</span>, <span class="arithmatex">$y$</span> و <span class="arithmatex">$z$</span> اولیه متفاوت، می‌توان آن را برای <span class="arithmatex">$\frac{x+y \sqrt{n}}{z}$</span> دلخواه محاسبه کرد.</p>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://timus.online/problem.aspx?space=1&amp;num=1814">Tavrida NU Akai Contest - Continued Fraction</a></p>
<p>شما <span class="arithmatex">$x$</span> و <span class="arithmatex">$k$</span> را دارید، <span class="arithmatex">$x$</span> یک مربع کامل نیست. فرض کنید <span class="arithmatex">$\sqrt x = [a_0; a_1, \dots]$</span>، <span class="arithmatex">$\frac{p_k}{q_k}=[a_0; a_1, \dots, a_k]$</span> را برای <span class="arithmatex">$0 \leq k \leq 10^9$</span> پیدا کنید.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>پس از محاسبه دوره تناوب <span class="arithmatex">$\sqrt x$</span>، می‌توان <span class="arithmatex">$a_k$</span> را با استفاده از توان‌رسانی دودویی روی تبدیل کسری خطی ناشی از نمایش کسر مسلسل محاسبه کرد. برای یافتن تبدیل حاصل، دوره تناوب به اندازه <span class="arithmatex">$T$</span> را به یک تبدیل واحد فشرده کرده و آن را <span class="arithmatex">$\lfloor \frac{k-1}{T}\rfloor$</span> بار تکرار می‌کنید، پس از آن به صورت دستی آن را با تبدیلات باقیمانده ترکیب می‌کنید.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># کد با فرض وجود تابع sqrt_cf از مثال قبل</span>
<span class="n">x</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">mod</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">7</span>

<span class="c1"># ترکیب (A[0]*x + A[1]) / (A[2]*x + A[3]) و (B[0]*x + B[1]) / (B[2]*x + B[3])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="c1"># A, B ماتریس‌های 2x2 هستند</span>
    <span class="c1"># (a b) (e f) = (ae+bg af+bh)</span>
    <span class="c1"># (c d) (g h)   (ce+dg cf+dh)</span>
    <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">%</span> <span class="n">mod</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">%</span> <span class="n">mod</span><span class="p">,</span> 
             <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">%</span> <span class="n">mod</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">%</span> <span class="n">mod</span> <span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># ماتریس همانی</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">A</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">//=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">pre_period</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">sqrt_cf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># تبدیل نهایی: p_k / q_k</span>
<span class="c1"># [a_0; a_1, ..., a_k]</span>
<span class="c1"># p_k = a_k p_{k-1} + p_{k-2}</span>
<span class="c1"># q_k = a_k q_{k-1} + q_{k-2}</span>
<span class="c1"># (p_k) = (a_k 1) (p_{k-1})</span>
<span class="c1"># (q_k)   (1  0) (q_{k-1})</span>

<span class="c1"># ماتریس برای کل تبدیل</span>
<span class="n">final_matrix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># بخش پیش‌دوره</span>
<span class="n">k_rem</span> <span class="o">=</span> <span class="n">k</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pre_period</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">k_rem</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">mat_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">pre_period</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">final_matrix</span><span class="p">,</span> <span class="n">mat_a</span><span class="p">)</span>
    <span class="n">k_rem</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="k">if</span> <span class="n">k_rem</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># ماتریس برای یک دوره کامل</span>
    <span class="n">period_matrix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">period</span><span class="p">:</span>
        <span class="n">mat_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">period_matrix</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">period_matrix</span><span class="p">,</span> <span class="n">mat_a</span><span class="p">)</span>

    <span class="n">num_periods</span> <span class="o">=</span> <span class="p">(</span><span class="n">k_rem</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
    <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">final_matrix</span><span class="p">,</span> <span class="n">bpow</span><span class="p">(</span><span class="n">period_matrix</span><span class="p">,</span> <span class="n">num_periods</span><span class="p">))</span>
    <span class="n">k_rem</span> <span class="o">-=</span> <span class="n">num_periods</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>

    <span class="c1"># بخش باقیمانده دوره</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_rem</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">mat_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">period</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">final_matrix</span><span class="p">,</span> <span class="n">mat_a</span><span class="p">)</span>

<span class="c1"># [p_k, p_{k-1}], [q_k, q_{k-1}]</span>
<span class="c1"># p_{-2}=0, p_{-1}=1</span>
<span class="c1"># q_{-2}=1, q_{-1}=0</span>
<span class="n">pk</span> <span class="o">=</span> <span class="n">final_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">final_matrix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">0</span>
<span class="n">qk</span> <span class="o">=</span> <span class="n">final_matrix</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">final_matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pk</span> <span class="o">%</span> <span class="n">mod</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qk</span> <span class="o">%</span> <span class="n">mod</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="_10">تعبیر هندسی<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<p>فرض کنید <span class="arithmatex">$\vec r_k = (q_k;p_k)$</span> برای همگرای <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span>. آنگاه، رابطه بازگشتی زیر برقرار است:</p>
<div class="arithmatex">$$\vec r_k = a_k \vec r_{k-1} + \vec r_{k-2}.$$</div>
<p>فرض کنید <span class="arithmatex">$\vec r = (1;r)$</span>. آنگاه، هر بردار <span class="arithmatex">$(x;y)$</span> با عددی برابر با ضریب شیب آن <span class="arithmatex">$\frac{y}{x}$</span> مطابقت دارد.</p>
<p>با مفهوم <a href="../geometry/basic-geometry.html">ضرب شبه‌اسکالر</a> <span class="arithmatex">$(x_1;y_1) \times (x_2;y_2) = x_1 y_2 - x_2 y_1$</span>، می‌توان نشان داد (توضیح زیر را ببینید) که</p>
<div class="arithmatex">$$s_k = -\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r} = \left|\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r}\right|.$$</div>
<p>معادله آخر به این دلیل است که <span class="arithmatex">$r_{k-1}$</span> و <span class="arithmatex">$r_{k-2}$</span> در دو طرف مختلف <span class="arithmatex">$r$</span> قرار دارند، بنابراین ضرب‌های شبه‌اسکالر <span class="arithmatex">$\vec r_{k-1}$</span> و <span class="arithmatex">$\vec r_{k-2}$</span> با <span class="arithmatex">$\vec r$</span> علامت‌های متفاوتی دارند. با در نظر داشتن <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span>، فرمول برای <span class="arithmatex">$\vec r_k$</span> اکنون به شکل زیر در می‌آید:</p>
<div class="arithmatex">$$\vec r_k = \vec r_{k-2} + \left\lfloor \left| \frac{\vec r \times \vec r_{k-2}}{\vec r \times \vec r_{k-1}}\right|\right\rfloor \vec r_{k-1}.$$</div>
<p>توجه داشته باشید که <span class="arithmatex">$\vec r_k \times r = (q_k;p_k) \times (1;r) = q_k r - p_k$</span>، بنابراین</p>
<div class="arithmatex">$$a_k = \left\lfloor \left| \frac{q_{k-1}r-p_{k-1}}{q_{k-2}r-p_{k-2}} \right| \right\rfloor.$$</div>
<details class="hint">
<summary>توضیح</summary>
<p>همانطور که قبلاً اشاره کردیم، <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span>، که در آن <span class="arithmatex">$s_k = [a_k; a_{k+1}, a_{k+2}, \dots]$</span>. از طرف دیگر، از رابطه بازگشتی همگراها نتیجه می‌گیریم که</p>
<div class="arithmatex">$$r = [a_0; a_1, \dots, a_{k-1}, s_k] = \frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$</div>
<p>در فرم برداری، این به صورت زیر بازنویسی می‌شود</p>
<div class="arithmatex">$$\vec r \parallel s_k \vec r_{k-1} + \vec r_{k-2},$$</div>
<p>به این معنی که <span class="arithmatex">$\vec r$</span> و <span class="arithmatex">$s_k \vec r_{k-1} + \vec r_{k-2}$</span> هم‌خط هستند (یعنی ضریب شیب یکسانی دارند). با گرفتن <a href="../geometry/basic-geometry.html">ضرب شبه‌اسکالر</a> هر دو بخش با <span class="arithmatex">$\vec r$</span>، داریم</p>
<div class="arithmatex">$$0 = s_k (\vec r_{k-1} \times \vec r) + (\vec r_{k-2} \times \vec r),$$</div>
<p>که فرمول نهایی را به دست می‌دهد</p>
<div class="arithmatex">$$s_k = -\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r}.$$</div>
</details>
<div class="admonition example">
<p class="admonition-title">الگوریتم کشیدن بینی</p>
<p>هر بار که <span class="arithmatex">$\vec r_{k-1}$</span> را به بردار <span class="arithmatex">$\vec p$</span> اضافه می‌کنید، مقدار <span class="arithmatex">$\vec p \times \vec r$</span> به اندازه <span class="arithmatex">$\vec r_{k-1} \times \vec r$</span> افزایش می‌یابد.</p>
<p>بنابراین، <span class="arithmatex">$a_k=\lfloor s_k \rfloor$</span> حداکثر تعداد صحیح بردارهای <span class="arithmatex">$\vec r_{k-1}$</span> است که می‌توان به <span class="arithmatex">$\vec r_{k-2}$</span> اضافه کرد بدون اینکه علامت ضرب خارجی با <span class="arithmatex">$\vec r$</span> تغییر کند.</p>
<p>به عبارت دیگر، <span class="arithmatex">$a_k$</span> حداکثر تعداد دفعاتی است که می‌توانید <span class="arithmatex">$\vec r_{k-1}$</span> را به <span class="arithmatex">$\vec r_{k-2}$</span> اضافه کنید بدون اینکه از خط تعریف شده توسط <span class="arithmatex">$\vec r$</span> عبور کنید:</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/9/92/Continued_convergents_geometry.svg" width="700px"/>
<figcaption><em>همگراهای <span class="arithmatex">$r=\frac{7}{9}=[0;1,3,2]$</span>. نیم‌همگراها با نقاط میانی بین فلش‌های خاکستری مطابقت دارند.</em></figcaption></figure></p>
<p>در تصویر بالا، <span class="arithmatex">$\vec r_2 = (3;4)$</span> با افزودن مکرر <span class="arithmatex">$\vec r_1 = (1;1)$</span> به <span class="arithmatex">$\vec r_0 = (1;0)$</span> به دست می‌آید.</p>
<p>وقتی دیگر امکان افزودن <span class="arithmatex">$\vec r_1$</span> به <span class="arithmatex">$\vec r_0$</span> بدون عبور از خط <span class="arithmatex">$y=rx$</span> وجود ندارد، به طرف دیگر می‌رویم و به طور مکرر <span class="arithmatex">$\vec r_2$</span> را به <span class="arithmatex">$\vec r_1$</span> اضافه می‌کنیم تا <span class="arithmatex">$\vec r_3 = (7;9)$</span> را به دست آوریم.</p>
<p>این روش بردارهای به طور نمایی طولانی‌تری تولید می‌کند که به خط نزدیک می‌شوند.</p>
<p>به دلیل این ویژگی، روش تولید بردارهای همگرای متوالی توسط بوریس دلونی <strong>الگوریتم کشیدن بینی</strong> نامیده شده است.</p>
</div>
<p>اگر به مثلثی که روی نقاط <span class="arithmatex">$\vec r_{k-2}$</span>، <span class="arithmatex">$\vec r_{k}$</span> و <span class="arithmatex">$\vec 0$</span> رسم شده است نگاه کنیم، متوجه می‌شویم که دو برابر مساحت آن برابر است با</p>
<div class="arithmatex">$$|\vec r_{k-2} \times \vec r_k| = |\vec r_{k-2} \times (\vec r_{k-2} + a_k \vec r_{k-1})| = a_k |\vec r_{k-2} \times \vec r_{k-1}| = a_k.$$</div>
<p>در ترکیب با <a href="../geometry/picks-theorem.html">قضیه پیک</a>، این به این معناست که هیچ نقطه مشبکه‌ای اکیداً داخل مثلث وجود ندارد و تنها نقاط مشبکه روی مرز آن <span class="arithmatex">$\vec 0$</span> و <span class="arithmatex">$\vec r_{k-2} + t \cdot \vec r_{k-1}$</span> برای تمام اعداد صحیح <span class="arithmatex">$t$</span> به طوری که <span class="arithmatex">$0 \leq t \leq a_k$</span> هستند. وقتی برای تمام <span class="arithmatex">$k$</span>های ممکن به هم متصل شوند، به این معنی است که هیچ نقطه صحیحی در فضای بین چندضلعی‌های تشکیل شده توسط بردارهای همگرای با اندیس زوج و فرد وجود ندارد.</p>
<p>این به نوبه خود به این معناست که <span class="arithmatex">$\vec r_k$</span> با ضرایب فرد یک پوش محدب از نقاط مشبکه با <span class="arithmatex">$x \geq 0$</span> بالای خط <span class="arithmatex">$y=rx$</span> را تشکیل می‌دهد، در حالی که <span class="arithmatex">$\vec r_k$</span> با ضرایب زوج یک پوش محدب از نقاط مشبکه با <span class="arithmatex">$x &gt; 0$</span> زیر خط <span class="arithmatex">$y=rx$</span> را تشکیل می‌دهد.</p>
<div class="admonition info">
<p class="admonition-title">تعریف</p>
<p>این چندضلعی‌ها به عنوان <strong>چندضلعی‌های کلاین</strong> نیز شناخته می‌شوند، به نام فلیکس کلاین که اولین بار این تعبیر هندسی را برای کسرهای مسلسل پیشنهاد کرد.</p>
</div>
<h2 id="_11">مثال‌های مسئله<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p>اکنون که مهم‌ترین حقایق و مفاهیم معرفی شدند، زمان آن است که به مثال‌های خاصی از مسائل بپردازیم.</p>
<div class="admonition example">
<p class="admonition-title">پوش محدب زیر خط</p>
<p>پوش محدب نقاط مشبکه <span class="arithmatex">$(x;y)$</span> را به طوری که <span class="arithmatex">$0 \leq x \leq N$</span> و <span class="arithmatex">$0 \leq y \leq rx$</span> برای <span class="arithmatex">$r=[a_0;a_1,\dots,a_k]=\frac{p_k}{q_k}$</span> پیدا کنید.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>اگر مجموعه نامحدود <span class="arithmatex">$0 \leq x$</span> را در نظر می‌گرفتیم، پوش محدب بالایی توسط خود خط <span class="arithmatex">$y=rx$</span> داده می‌شد.</p>
<p>با این حال، با قید اضافی <span class="arithmatex">$x \leq N$</span> باید در نهایت از خط منحرف شویم تا پوش محدب مناسبی را حفظ کنیم.</p>
<p>فرض کنید <span class="arithmatex">$t = \lfloor \frac{N}{q_k}\rfloor$</span>، آنگاه <span class="arithmatex">$t$</span> نقطه مشبکه اول روی پوش بعد از <span class="arithmatex">$(0;0)$</span> برابر با <span class="arithmatex">$\alpha \cdot (q_k; p_k)$</span> برای عدد صحیح <span class="arithmatex">$1 \leq \alpha \leq t$</span> هستند.</p>
<p>با این حال <span class="arithmatex">$(t+1)(q_k; p_k)$</span> نمی‌تواند نقطه مشبکه بعدی باشد زیرا <span class="arithmatex">$(t+1)q_k$</span> بزرگتر از <span class="arithmatex">$N$</span> است.</p>
<p>برای رسیدن به نقاط مشبکه بعدی در پوش، باید به نقطه <span class="arithmatex">$(x;y)$</span> برویم که با کمترین حاشیه از <span class="arithmatex">$y=rx$</span> منحرف می‌شود، در حالی که <span class="arithmatex">$x \leq N$</span> حفظ شود.</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Lattice-hull.svg" width="500px"/>
<figcaption>پوش محدب نقاط مشبکه زیر <span class="arithmatex">$y=\frac{4}{7}x$</span> برای <span class="arithmatex">$0 \leq x \leq 19$</span> از نقاط <span class="arithmatex">$(0;0), (7;4), (14;8), (16;9), (18;10), (19;10)$</span> تشکیل شده است.</figcaption></figure></p>
<p>فرض کنید <span class="arithmatex">$(x; y)$</span> آخرین نقطه فعلی در پوش محدب باشد. آنگاه نقطه بعدی <span class="arithmatex">$(x'; y')$</span> به گونه‌ای است که <span class="arithmatex">$x' \leq N$</span> و <span class="arithmatex">$(x'; y') - (x; y) = (\Delta x; \Delta y)$</span> تا حد امکان به خط <span class="arithmatex">$y=rx$</span> نزدیک باشد. به عبارت دیگر، <span class="arithmatex">$(\Delta x; \Delta y)$</span> مقدار <span class="arithmatex">$r \Delta x - \Delta y$</span> را با شرط <span class="arithmatex">$\Delta x \leq N - x$</span> و <span class="arithmatex">$\Delta y \leq r \Delta x$</span> بیشینه می‌کند.</p>
<p>نقاطی مانند این روی پوش محدب نقاط مشبکه زیر <span class="arithmatex">$y=rx$</span> قرار دارند. به عبارت دیگر، <span class="arithmatex">$(\Delta x; \Delta y)$</span> باید یک نیم‌همگرای پایینی <span class="arithmatex">$r$</span> باشد.</p>
<p>به این ترتیب، <span class="arithmatex">$(\Delta x; \Delta y)$</span> به شکل <span class="arithmatex">$(q_{i-1}; p_{i-1}) + t \cdot (q_i; p_i)$</span> برای یک عدد فرد <span class="arithmatex">$i$</span> و <span class="arithmatex">$0 \leq t &lt; a_i$</span> است.</p>
<p>برای پیدا کردن چنین <span class="arithmatex">$i$</span>، می‌توانیم تمام <span class="arithmatex">$i$</span>های ممکن را از بزرگترین شروع کرده و از <span class="arithmatex">$t = \lfloor \frac{N-x-q_{i-1}}{q_i} \rfloor$</span> برای <span class="arithmatex">$i$</span> به طوری که <span class="arithmatex">$N-x-q_{i-1} \geq 0$</span> استفاده کنیم.</p>
<p>با <span class="arithmatex">$(\Delta x; \Delta y) = (q_{i-1}; p_{i-1}) + t \cdot (q_i; p_i)$</span>، شرط <span class="arithmatex">$\Delta y \leq r \Delta x$</span> با خواص نیم‌همگرا حفظ می‌شود.</p>
<p>و <span class="arithmatex">$t &lt; a_i$</span> برقرار خواهد بود زیرا ما قبلاً نیم‌همگراهای به دست آمده از <span class="arithmatex">$i+2$</span> را تمام کرده‌ایم، از این رو <span class="arithmatex">$x + q_{i-1} + a_i q_i = x+q_{i+1}$</span> بزرگتر از <span class="arithmatex">$N$</span> است.</p>
<p>اکنون که می‌توانیم <span class="arithmatex">$(\Delta x; \Delta y)$</span> را به <span class="arithmatex">$(x;y)$</span> برای <span class="arithmatex">$k = \lfloor \frac{N-x}{\Delta x} \rfloor$</span> بار اضافه کنیم قبل از اینکه از <span class="arithmatex">$N$</span> تجاوز کنیم، پس از آن نیم‌همگرای بعدی را امتحان خواهیم کرد.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">C++</label><label for="__tabbed_9_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// [ah, ph, qh] را برمی‌گرداند به طوری که نقاط r[i]=(qh[i], ph[i]) پوش محدب بالایی را تشکیل می‌دهند</span>
<span class="c1">// از نقاط مشبکه روی 0 &lt;= x &lt;= N و 0 &lt;= y &lt;= r * x، که r = [a0; a1, a2, ...]</span>
<span class="c1">// و ah[i] نقطه صحیح روی پاره‌خط بین r[i-1] و r[i] وجود دارد.</span>
<span class="k">auto</span><span class="w"> </span><span class="n">hull</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">();</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ah</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">t</span><span class="p">};</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">back</span><span class="p">()};</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">qh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()};</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">                </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">                </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">dq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">                </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dq</span><span class="p">;</span>
<span class="w">                </span><span class="n">ah</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="w">                </span><span class="n">ph</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ph</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dp</span><span class="p">);</span>
<span class="w">                </span><span class="n">qh</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dq</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">make_tuple</span><span class="p">(</span><span class="n">ah</span><span class="p">,</span><span class="w"> </span><span class="n">ph</span><span class="p">,</span><span class="w"> </span><span class="n">qh</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># [ah, ph, qh] را برمی‌گرداند به طوری که نقاط r[i]=(qh[i], ph[i]) پوش محدب بالایی را تشکیل می‌دهند</span>
<span class="c1"># از نقاط مشبکه روی 0 &lt;= x &lt;= N و 0 &lt;= y &lt;= r * x، که r = [a0; a1, a2, ...]</span>
<span class="c1"># و ah[i] نقطه صحیح روی پاره‌خط بین r[i-1] و r[i] وجود دارد.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ah</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">qh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1"># p,q شامل p_(-2), p_(-1) هستند، پس اندیس همگراها با اندیس آرایه متفاوت است</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">))):</span>
        <span class="c1"># همگراهای پایینی (که r_k &lt; r) اندیس k فرد دارند</span>
        <span class="c1"># اندیس در آرایه: k+2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># q[i-2] = q_{i-4}, q[i-1] = q_{i-3}</span>
            <span class="c1"># ما به q_{j} و q_{j-1} نیاز داریم که j فرد است. پس q[i], q[i-1]</span>
            <span class="k">while</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dq</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">dq</span>
                <span class="n">ah</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">ph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dp</span><span class="p">)</span>
                <span class="n">qh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dq</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">qh</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://timus.online/problem.aspx?space=1&amp;num=1430">Timus - Crime and Punishment</a></p>
<p>شما اعداد صحیح <span class="arithmatex">$A$</span>, <span class="arithmatex">$B$</span> و <span class="arithmatex">$N$</span> را دارید. <span class="arithmatex">$x \geq 0$</span> و <span class="arithmatex">$y \geq 0$</span> را پیدا کنید به طوری که <span class="arithmatex">$Ax + By \leq N$</span> و <span class="arithmatex">$Ax + By$</span> حداکثر مقدار ممکن باشد.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>در این مسئله داریم <span class="arithmatex">$1 \leq A, B, N \leq 2 \cdot 10^9$</span>، بنابراین می‌توان آن را در <span class="arithmatex">$O(\sqrt N)$</span> حل کرد. با این حال، یک راه‌حل <span class="arithmatex">$O(\log N)$</span> با کسرهای مسلسل وجود دارد.</p>
<p>برای راحتی، جهت <span class="arithmatex">$x$</span> را با انجام جایگزینی <span class="arithmatex">$x \mapsto \lfloor \frac{N}{A}\rfloor - x$</span> معکوس می‌کنیم، به طوری که اکنون باید نقطه <span class="arithmatex">$(x; y)$</span> را پیدا کنیم که <span class="arithmatex">$0 \leq x \leq \lfloor \frac{N}{A} \rfloor$</span>، <span class="arithmatex">$By - Ax \leq N \pmod A$</span> و <span class="arithmatex">$By - Ax$</span> حداکثر مقدار ممکن باشد. <span class="arithmatex">$y$</span> بهینه برای هر <span class="arithmatex">$x$</span> مقداری برابر با <span class="arithmatex">$\lfloor \frac{Ax + (N \bmod A)}{B} \rfloor$</span> دارد.</p>
<p>برای برخورد کلی‌تر با آن، تابعی می‌نویسیم که بهترین نقطه را روی <span class="arithmatex">$0 \leq x \leq N$</span> و <span class="arithmatex">$y = \lfloor \frac{Ax+B}{C} \rfloor$</span> پیدا می‌کند.</p>
<p>ایده اصلی راه‌حل در این مسئله اساساً مسئله قبلی را تکرار می‌کند، اما به جای استفاده از نیم‌همگراهای پایینی برای انحراف از خط، از نیم‌همگراهای بالایی برای نزدیک‌تر شدن به خط بدون عبور از آن و بدون نقض <span class="arithmatex">$x \leq N$</span> استفاده می‌کنید. متأسفانه، بر خلاف مسئله قبلی، باید اطمینان حاصل کنید که هنگام نزدیک شدن به خط <span class="arithmatex">$y=\frac{Ax+B}{C}$</span> از آن عبور نمی‌کنید، بنابراین باید هنگام محاسبه ضریب <span class="arithmatex">$t$</span> نیم‌همگرا این را در نظر داشته باشید.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># (x, y) به طوری که y = (A*x+B) // C,</span>
<span class="c1"># Cy - Ax حداکثر و 0 &lt;= x &lt;= N.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">closest</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># y &lt;= (A*x + B)/C &lt;=&gt; diff(x, y) &lt;= B</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">C</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">x</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="c1"># نقطه شروع (0, B//C)</span>
    <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="o">//</span><span class="n">C</span>
    <span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="o">//</span><span class="n">C</span>

    <span class="c1"># همگراهای بالایی (k زوج)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># امتحان q[i] و q[i-1]</span>
            <span class="n">dq</span><span class="p">,</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">curr_x</span> <span class="o">+</span> <span class="n">dq</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
                <span class="c1"># امتحان نیم‌همگراهای بین r_{i-2} و r_i</span>
                <span class="n">dq_s</span><span class="p">,</span> <span class="n">dp_s</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">curr_x</span> <span class="o">+</span> <span class="n">dq_s</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">:</span>
                    <span class="c1"># حداکثر ضریب t</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">curr_x</span> <span class="o">-</span> <span class="n">dq_s</span><span class="p">)</span> <span class="o">//</span> <span class="n">dq</span>

                    <span class="c1"># ضریب t برای اینکه از خط عبور نکنیم</span>
                    <span class="k">if</span> <span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">t</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">diff</span><span class="p">(</span><span class="n">curr_x</span><span class="o">+</span><span class="n">dq_s</span><span class="p">,</span> <span class="n">curr_y</span><span class="o">+</span><span class="n">dp_s</span><span class="p">))</span> <span class="o">//</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)))</span>

                    <span class="n">curr_x</span> <span class="o">+=</span> <span class="n">dq_s</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dq</span>
                    <span class="n">curr_y</span> <span class="o">+=</span> <span class="n">dp_s</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dp</span>
                    <span class="k">if</span> <span class="n">diff</span><span class="p">(</span><span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">diff</span><span class="p">(</span><span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span><span class="p">):</span>
                        <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span> <span class="o">=</span> <span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span>
                <span class="k">break</span>

            <span class="c1"># ضریب k برای اینکه از خط عبور نکنیم</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">curr_x</span><span class="p">)</span> <span class="o">//</span> <span class="n">dq</span>
            <span class="k">if</span> <span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">diff</span><span class="p">(</span><span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span><span class="p">))</span> <span class="o">//</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)))</span>

            <span class="n">curr_x</span> <span class="o">+=</span> <span class="n">k</span><span class="o">*</span><span class="n">dq</span>
            <span class="n">curr_y</span> <span class="o">+=</span> <span class="n">k</span><span class="o">*</span><span class="n">dp</span>
            <span class="k">if</span> <span class="n">diff</span><span class="p">(</span><span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">diff</span><span class="p">(</span><span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span><span class="p">):</span>
                <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span> <span class="o">=</span> <span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">curr_x</span><span class="p">)</span> <span class="o">//</span> <span class="n">dq</span> <span class="p">:</span> <span class="c1"># نتوانستیم کامل پیش برویم</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_crime</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="c1"># max (Ax+By) s.t. Ax+By &lt;= N</span>
    <span class="c1"># بدون از دست دادن کلیت A &lt;= B</span>
    <span class="k">if</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span><span class="p">:</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span>
    <span class="k">if</span> <span class="n">A</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">//</span><span class="n">B</span>

    <span class="c1"># x_new = N/A - x, y_new = y</span>
    <span class="c1"># A(N/A - x) + By &lt;= N -&gt; N-Ax+By &lt;= N -&gt; By - Ax &lt;= 0</span>
    <span class="c1"># می خواهیم By - Ax را بیشینه کنیم</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">closest</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="n">B</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">//</span> <span class="n">A</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://www.codechef.com/problems/ES">June Challenge 2017 - Euler Sum</a></p>
<p><span class="arithmatex">$\sum\limits_{x=1}^N \lfloor ex \rfloor$</span> را محاسبه کنید، که در آن <span class="arithmatex">$e = [2; 1, 2, 1, 1, 4, 1, 1, 6, 1, \dots, 1, 2n, 1, \dots]$</span> عدد اویلر است و <span class="arithmatex">$N \leq 10^{4000}$</span>.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>این مجموع برابر است با تعداد نقاط مشبکه <span class="arithmatex">$(x;y)$</span> به طوری که <span class="arithmatex">$1 \leq x \leq N$</span> و <span class="arithmatex">$1 \leq y \leq ex$</span>.    </p>
<p>پس از ساختن پوش محدب نقاط زیر <span class="arithmatex">$y=ex$</span>، این تعداد را می‌توان با استفاده از <a href="../geometry/picks-theorem.html">قضیه پیک</a> محاسبه کرد:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">C++</label><label for="__tabbed_11_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// مجموع floor(r * x) برای x از 1 تا N و r = [a0; a1, a2, ...]</span>
<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">sum_floor</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">N</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">ah</span><span class="p">,</span><span class="w"> </span><span class="n">ph</span><span class="p">,</span><span class="w"> </span><span class="n">qh</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// تعداد نقاط مشبکه درون یک ذوزنقه قائم‌الزاویه عمودی</span>
<span class="w">    </span><span class="c1">// روی نقاط (0; 0) - (0; y1) - (dx; y2) - (dx; 0) که</span>
<span class="w">    </span><span class="c1">// a+1 نقطه صحیح روی پاره‌خط (0; y1) - (dx; y2) دارد.</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">picks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dx</span><span class="p">;</span><span class="w"> </span><span class="c1">// نقاط مرزی</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dx</span><span class="p">;</span><span class="w"> </span><span class="c1">// دو برابر مساحت</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">y2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// نقاط داخلی + نقاط روی دو ضلع</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">qh</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ans</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">picks</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ah</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># مجموع floor(r * x) برای x از 1 تا N و r = [a0; a1, a2, ...]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sum_floor_func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># N شامل خود نقطه پایانی نیست</span>
    <span class="n">ah</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">qh</span> <span class="o">=</span> <span class="n">hull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># تعداد نقاط مشبکه درون یک ذوزنقه قائم‌الزاویه عمودی</span>
    <span class="c1"># روی نقاط (0; 0) - (0; y1) - (dx; y2) - (dx; 0) که</span>
    <span class="c1"># a+1 نقطه صحیح روی پاره‌خط (0; y1) - (dx; y2) دارد.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">picks</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="n">dx</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="n">y2</span>

    <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">qh</span><span class="p">)):</span>
        <span class="c1"># مجموع floor(r*x) برای qh[i-1] &lt; x &lt;= qh[i]</span>
        <span class="n">y_start</span> <span class="o">=</span> <span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">y_end</span> <span class="o">=</span> <span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">x_start</span> <span class="o">=</span> <span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x_end</span> <span class="o">=</span> <span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">x_end</span> <span class="o">-</span> <span class="n">x_start</span>
        <span class="c1"># تعداد نقاط روی پاره‌خط از (x_start, y_start) تا (x_end, y_end) برابر است با</span>
        <span class="c1"># gcd(dx, dy) + 1. در اینجا ah[i-1] تعداد پله هاست.</span>
        <span class="n">ans</span> <span class="o">+=</span> <span class="n">picks</span><span class="p">(</span><span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">ah</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ans</span> <span class="o">-</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://open.kattis.com/problems/itsamodmodmodmodworld">NAIPC 2019 - It's a Mod, Mod, Mod, Mod World</a></p>
<p>با داشتن <span class="arithmatex">$p$</span>, <span class="arithmatex">$q$</span> و <span class="arithmatex">$n$</span>, <span class="arithmatex">$\sum\limits_{i=1}^n (p \cdot i \bmod q)$</span> را محاسبه کنید.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>این مسئله به مسئله قبلی کاهش می‌یابد اگر توجه داشته باشید که <span class="arithmatex">$a \bmod b = a - \lfloor \frac{a}{b} \rfloor b$</span>. با این واقعیت، مجموع به صورت زیر کاهش می‌یابد:</p>
<div class="arithmatex">$$\sum\limits_{i=1}^n \left(p \cdot i - \left\lfloor \frac{p \cdot i}{q} \right\rfloor q\right) = \frac{pn(n+1)}{2}-q\sum\limits_{i=1}^n \left\lfloor \frac{p \cdot i}{q}\right\rfloor.$$</div>
<p>با این حال، جمع کردن <span class="arithmatex">$\lfloor rx \rfloor$</span> برای <span class="arithmatex">$x$</span> از <span class="arithmatex">$1$</span> تا <span class="arithmatex">$N$</span> چیزی است که ما از مسئله قبلی قادر به انجام آن هستیم.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">C++</label><label for="__tabbed_12_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sum_floor</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_mod_sum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">sum_floor_func</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://judge.yosupo.jp/problem/sum_of_floor_of_linear">Library Checker - Sum of Floor of Linear</a></p>
<p>با داشتن <span class="arithmatex">$N$</span>, <span class="arithmatex">$M$</span>, <span class="arithmatex">$A$</span> و <span class="arithmatex">$B$</span>, <span class="arithmatex">$\sum\limits_{i=0}^{N-1} \lfloor \frac{A \cdot i + B}{M} \rfloor$</span> را محاسبه کنید.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>این مسئله از نظر فنی دردسرسازترین مسئله تاکنون است.</p>
<p>می‌توان از همان رویکرد استفاده کرد و پوش محدب کامل نقاط زیر خط <span class="arithmatex">$y = \frac{Ax+B}{M}$</span> را ساخت.</p>
<p>ما قبلاً می‌دانیم چگونه آن را برای <span class="arithmatex">$B = 0$</span> حل کنیم. علاوه بر این، ما قبلاً می‌دانیم چگونه این پوش محدب را تا نزدیکترین نقطه مشبکه به این خط در بازه <span class="arithmatex">$[0, N-1]$</span> بسازیم (این کار در مسئله "Crime and Punishment" در بالا انجام شده است).</p>
<p>اکنون باید توجه داشته باشیم که وقتی به نزدیکترین نقطه به خط رسیدیم، می‌توانیم فرض کنیم که خط در واقع از نزدیکترین نقطه عبور می‌کند، زیرا هیچ نقطه مشبکه دیگری در <span class="arithmatex">$[0, N-1]$</span> بین خط واقعی و خطی که کمی به پایین منتقل شده تا از نزدیکترین نقطه عبور کند، وجود ندارد.</p>
<p>به این ترتیب، برای ساختن پوش محدب کامل زیر خط <span class="arithmatex">$y=\frac{Ax+B}{M}$</span> در <span class="arithmatex">$[0, N-1]$</span>، می‌توانیم آن را تا نزدیکترین نقطه به خط در <span class="arithmatex">$[0, N-1]$</span> بسازیم و سپس ادامه دهیم گویی خط از این نقطه عبور می‌کند، و از الگوریتم ساخت پوش محدب با <span class="arithmatex">$B=0$</span> دوباره استفاده کنیم:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># پوش محدب نقاط مشبکه (x, y) به طوری که M*y &lt;= A*x+B</span>
<span class="k">def</span><span class="w"> </span><span class="nf">general_hull</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ah</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="p">[</span><span class="n">B</span> <span class="o">//</span> <span class="n">M</span><span class="p">]</span>
    <span class="n">qh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># پیدا کردن نزدیکترین نقطه</span>
    <span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">B</span> <span class="o">//</span> <span class="n">M</span>
    <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">B</span> <span class="o">//</span> <span class="n">M</span>
    <span class="n">max_diff</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">curr_y</span> <span class="o">-</span> <span class="n">A</span> <span class="o">*</span> <span class="n">curr_x</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># همگراهای بالایی</span>
            <span class="n">dq</span><span class="p">,</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">curr_x</span> <span class="o">+</span> <span class="n">dq</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">:</span>
                <span class="c1"># نیم‌همگراها</span>
                <span class="n">dq_s</span><span class="p">,</span> <span class="n">dp_s</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">curr_x</span> <span class="o">+</span> <span class="n">dq_s</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">curr_x</span> <span class="o">-</span> <span class="n">dq_s</span><span class="p">)</span> <span class="o">//</span> <span class="n">dq</span>
                    <span class="c1"># بررسی عبور از خط</span>
                    <span class="k">if</span> <span class="n">M</span><span class="o">*</span><span class="n">dp</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">dq</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">t</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span> <span class="p">(</span><span class="n">curr_y</span><span class="o">+</span><span class="n">dp_s</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">curr_x</span><span class="o">+</span><span class="n">dq_s</span><span class="p">)))</span> <span class="o">//</span> <span class="nb">abs</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">dp</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">dq</span><span class="p">))</span>
                    <span class="n">curr_x</span> <span class="o">+=</span> <span class="n">dq_s</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dq</span>
                    <span class="n">curr_y</span> <span class="o">+=</span> <span class="n">dp_s</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dp</span>
                    <span class="k">if</span> <span class="n">M</span> <span class="o">*</span> <span class="n">curr_y</span> <span class="o">-</span> <span class="n">A</span> <span class="o">*</span> <span class="n">curr_x</span> <span class="o">&gt;</span> <span class="n">max_diff</span><span class="p">:</span>
                        <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span> <span class="o">=</span> <span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span>
                        <span class="n">max_diff</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">curr_y</span> <span class="o">-</span> <span class="n">A</span> <span class="o">*</span> <span class="n">curr_x</span>
                <span class="k">break</span>

            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">curr_x</span><span class="p">)</span> <span class="o">//</span> <span class="n">dq</span>
            <span class="k">if</span> <span class="n">M</span><span class="o">*</span><span class="n">dp</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">dq</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">curr_y</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">curr_x</span><span class="p">))</span> <span class="o">//</span> <span class="nb">abs</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">dp</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">dq</span><span class="p">))</span>
            <span class="n">curr_x</span> <span class="o">+=</span> <span class="n">k</span><span class="o">*</span><span class="n">dq</span>
            <span class="n">curr_y</span> <span class="o">+=</span> <span class="n">k</span><span class="o">*</span><span class="n">dp</span>
            <span class="k">if</span> <span class="n">M</span><span class="o">*</span><span class="n">curr_y</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">curr_x</span> <span class="o">&gt;</span> <span class="n">max_diff</span><span class="p">:</span>
                <span class="n">best_x</span><span class="p">,</span> <span class="n">best_y</span> <span class="o">=</span> <span class="n">curr_x</span><span class="p">,</span> <span class="n">curr_y</span>
                <span class="n">max_diff</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">curr_y</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">curr_x</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">curr_x</span><span class="p">)</span><span class="o">//</span><span class="n">dq</span><span class="p">:</span> <span class="k">break</span>

    <span class="c1"># محاسبه مجموع تا بهترین نقطه</span>
    <span class="c1"># ...</span>
    <span class="c1"># سپس مجموع از بهترین نقطه تا N</span>
    <span class="c1"># ... این راه حل پیچیده است. راه حل استاندارد برای این مسئله ساده تر است.</span>
    <span class="c1"># راه حل استاندارد:</span>
    <span class="k">if</span> <span class="n">A</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">B</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span>
    <span class="k">if</span> <span class="n">A</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">A</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">B</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">solve_floor_sum</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">A</span> <span class="o">%</span> <span class="n">M</span><span class="p">,</span> <span class="n">B</span> <span class="o">%</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">B</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="p">:</span> <span class="k">return</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">solve_floor_sum</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">%</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">//</span> <span class="n">M</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span> <span class="o">-</span> <span class="n">solve_floor_sum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="o">-</span><span class="n">B</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">A</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_floor_sum</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="c1"># ... (کد کامل برای تابع بازگشتی)</span>
    <span class="k">pass</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://codeforces.com/gym/102354/problem/I">OKC 2 - From Modular to Rational</a></p>
<p>یک عدد گویای <span class="arithmatex">$\frac{p}{q}$</span> وجود دارد به طوری که <span class="arithmatex">$1 \leq p, q \leq 10^9$</span>. شما می‌توانید مقدار <span class="arithmatex">$p q^{-1}$</span> به پیمانه <span class="arithmatex">$m \sim 10^9$</span> را برای چندین عدد اول <span class="arithmatex">$m$</span> بپرسید. <span class="arithmatex">$\frac{p}{q}$</span> را بازیابی کنید.</p>
<p><em>فرمول‌بندی معادل:</em> <span class="arithmatex">$x$</span> را پیدا کنید که <span class="arithmatex">$Ax \pmod M$</span> را برای <span class="arithmatex">$1 \leq x \leq N$</span> کمینه کند.</p>
</div>
<details class="hint">
<summary>راه‌حل</summary>
<p>به دلیل قضیه باقیمانده چینی، پرسیدن نتیجه به پیمانه چندین عدد اول همانند پرسیدن آن به پیمانه حاصلضرب آنهاست. به همین دلیل، بدون از دست دادن کلیت، فرض می‌کنیم که باقیمانده را به پیمانه عدد به اندازه کافی بزرگ <span class="arithmatex">$m$</span> می‌دانیم.</p>
<p>ممکن است چندین راه‌حل ممکن <span class="arithmatex">$(p, q)$</span> برای <span class="arithmatex">$p \equiv qr \pmod m$</span> برای یک باقیمانده <span class="arithmatex">$r$</span> داده شده وجود داشته باشد. با این حال، اگر <span class="arithmatex">$(p_1, q_1)$</span> و <span class="arithmatex">$(p_2, q_2)$</span> هر دو راه‌حل باشند، آنگاه <span class="arithmatex">$p_1 q_2 \equiv p_2 q_1 \pmod m$</span> نیز برقرار است. با فرض اینکه <span class="arithmatex">$\frac{p_1}{q_1} \neq \frac{p_2}{q_2}$</span>، این به این معناست که <span class="arithmatex">$|p_1 q_2 - p_2 q_1|$</span> حداقل <span class="arithmatex">$m$</span> است.</p>
<p>در صورت مسئله به ما گفته شده که <span class="arithmatex">$1 \leq p, q \leq 10^9$</span>، بنابراین اگر هم <span class="arithmatex">$p_1, q_1$</span> و هم <span class="arithmatex">$p_2, q_2$</span> حداکثر <span class="arithmatex">$10^9$</span> باشند، آنگاه تفاوت حداکثر <span class="arithmatex">$2 \cdot 10^{18}$</span> است. برای <span class="arithmatex">$m &gt; 2 \cdot 10^{18}$</span> این به این معناست که راه‌حل <span class="arithmatex">$\frac{p}{q}$</span> با <span class="arithmatex">$1 \leq p, q \leq 10^9$</span> به عنوان یک عدد گویا منحصر به فرد است.</p>
<p>بنابراین، مسئله به این خلاصه می‌شود که با داشتن <span class="arithmatex">$r$</span> به پیمانه <span class="arithmatex">$m$</span>، هر <span class="arithmatex">$q$</span> را پیدا کنیم به طوری که <span class="arithmatex">$1 \leq q \leq 10^9$</span> و <span class="arithmatex">$qr \pmod m \leq 10^9$</span>.</p>
<p>این عملاً همانند یافتن <span class="arithmatex">$q$</span> است که کمترین مقدار ممکن <span class="arithmatex">$qr \bmod m$</span> را برای <span class="arithmatex">$1 \leq q \leq 10^9$</span> به دست می‌دهد.</p>
<p>برای <span class="arithmatex">$qr = km + b$</span> این به این معناست که باید یک جفت <span class="arithmatex">$(q, k)$</span> پیدا کنیم به طوری که <span class="arithmatex">$1 \leq q \leq 10^9$</span> و <span class="arithmatex">$qr - km \geq 0$</span> کمترین مقدار ممکن باشد.</p>
<p>از آنجا که <span class="arithmatex">$m$</span> ثابت است، می‌توانیم بر آن تقسیم کنیم و آن را به صورت پیدا کردن <span class="arithmatex">$q$</span> بازگو کنیم به طوری که <span class="arithmatex">$1 \leq q \leq 10^9$</span> و <span class="arithmatex">$\frac{r}{m} q - k \geq 0$</span> کمترین مقدار ممکن باشد.</p>
<p>از نظر کسرهای مسلسل، این به این معناست که <span class="arithmatex">$\frac{k}{q}$</span> بهترین تقریب دیوفانتی به <span class="arithmatex">$\frac{r}{m}$</span> است و کافی است فقط نیم‌همگراهای پایینی <span class="arithmatex">$\frac{r}{m}$</span> را بررسی کنیم.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># پیدا کردن Q که Q*r mod m را برای 1 &lt;= Q &lt;= n &lt; m کمینه می‌کند</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mod_min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">min_val</span> <span class="o">=</span> <span class="n">m</span>
    <span class="n">best_q</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># بررسی همگراها</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span> <span class="k">break</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">min_val</span><span class="p">:</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">val</span>
            <span class="n">best_q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># بررسی نیم‌همگراهای آخرین همگرای معتبر</span>
    <span class="c1"># i-1 آخرین همگرایی است که q[i-1] &lt;= n</span>
    <span class="n">last_valid_i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">last_valid_i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># نیم‌همگراهای بین r_{i-3} و r_{i-2}</span>
        <span class="c1"># ما به همگراهای با اندیس زوج نیاز داریم (بالایی ها)</span>
        <span class="c1"># چون r - p/q &lt; 0 -&gt; rq - p &lt; 0 (mod m)</span>
        <span class="c1"># ولی ما دنبال rq - mp &gt; 0 هستیم پس همگراهای پایینی (اندیس فرد)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">last_valid_i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">prev_q</span><span class="p">,</span> <span class="n">prev_p</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">last_valid_i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">last_valid_i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">curr_q</span><span class="p">,</span> <span class="n">curr_p</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">last_valid_i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">last_valid_i</span><span class="p">]</span>

            <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">prev_q</span><span class="p">)</span> <span class="o">//</span> <span class="n">curr_q</span>
            <span class="n">test_q</span> <span class="o">=</span> <span class="n">prev_q</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">curr_q</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_q</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">%</span><span class="n">m</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">min_val</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">val</span>
                <span class="n">best_q</span> <span class="o">=</span> <span class="n">test_q</span>

    <span class="k">return</span> <span class="n">best_q</span><span class="p">,</span> <span class="n">min_val</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="_12">مسائل تمرینی<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=775">UVa OJ - Continued Fractions</a></li>
<li><a href="https://www.hackerrank.com/contests/projecteuler/challenges/euler064/problem">ProjectEuler+ #64: Odd period square roots</a></li>
<li><a href="https://codeforces.com/contest/305/problem/B">Codeforces Round #184 (Div. 2) - Continued Fractions</a></li>
<li><a href="https://codeforces.com/contest/346/problem/E">Codeforces Round #201 (Div. 1) - Doodle Jump</a></li>
<li><a href="https://codeforces.com/contest/585/problem/C">Codeforces Round #325 (Div. 1) - Alice, Bob, Oranges and Apples</a></li>
<li><a href="http://poj.org/problem?id=3530">POJ Founder Monthly Contest 2008.03.16 - A Modular Arithmetic Challenge</a></li>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6624">2019 Multi-University Training Contest 5 - fraction</a></li>
<li><a href="https://www.codechef.com/SNCKEL19/problems/EBAIT">SnackDown 2019 Elimination Round - Election Bait</a></li>
<li><a href="https://github.com/google/coding-competitions-archive/blob/main/codejam/2019/round_2/new_elements_part_2/statement.pdf">Code Jam 2019 round 2 - Continued Fraction</a></li>
</ul>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <span class="contributors-text">Contributors:</span>
  <ul class="contributors" data-bi-name="contributors"><li><a href="https://github.com/adamant-pwn" title="adamant-pwn" data-bi-name="contributorprofile" target="_blank">adamant-pwn</a> (53.33%)</li><li><a href="https://github.com/2077DevWave" title="2077DevWave" data-bi-name="contributorprofile" target="_blank">2077DevWave</a> (46.59%)</li><li><a href="https://github.com/jatingaur18" title="jatingaur18" data-bi-name="contributorprofile" target="_blank">jatingaur18</a> (0.08%)</li></ul>
</ul>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Text is available under the <a href="https://github.com/2077DevWave/cp-algorithms-fa/blob/main/LICENSE">Creative Commons Attribution Share Alike 4.0 International</a> License<br/>Copyright &copy; 2014 - 2025 by <a href="https://github.com/2077DevWave/cp-algorithms-fa/graphs/contributors">cp-algorithms contributors</a>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      <div class="md-social">
  
</div>
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "search.suggest", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u06a9\u067e\u06cc \u0634\u062f", "clipboard.copy": "\u06a9\u067e\u06cc \u06a9\u0631\u062f\u0646", "search.result.more.one": "1 \u0645\u0648\u0631\u062f \u062f\u06cc\u06af\u0631 \u062f\u0631 \u0627\u06cc\u0646 \u0635\u0641\u062d\u0647", "search.result.more.other": "# \u0645\u0648\u0631\u062f \u062f\u06cc\u06af\u0631 \u062f\u0631 \u0627\u06cc\u0646 \u0635\u0641\u062d\u0647", "search.result.none": "\u0633\u0646\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f", "search.result.one": "1 \u0633\u0646\u062f \u06cc\u0627\u0641\u062a \u0634\u062f", "search.result.other": "# \u0633\u0646\u062f \u06cc\u0627\u0641\u062a \u0634\u062f", "search.result.placeholder": "\u0628\u0631\u0627\u06cc \u0634\u0631\u0648\u0639 \u062c\u0633\u062a\u062c\u0648 \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f", "search.result.term.missing": "\u0645\u0648\u062c\u0648\u062f \u0646\u06cc\u0633\u062a", "select.version": "\u0627\u0646\u062a\u062e\u0627\u0628 \u0648\u06cc\u0631\u0627\u06cc\u0634"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../javascript/config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../assets/javascripts/toggle-sidebar.js" async></script>
      
    
  </body>
</html>