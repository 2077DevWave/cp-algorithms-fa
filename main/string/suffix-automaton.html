
<!doctype html>
<html lang="fa" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The goal of this project is to translate the wonderful resource http://e-maxx.ru/algo which provides descriptions of many algorithms and data structures especially popular in field of competitive programming. Moreover we want to improve the collected knowledge by extending the articles and adding new articles to the collection.">
      
      
      
        <link rel="canonical" href="https://cp-algorithms.com/string/suffix-automaton.html">
      
      
        <link rel="prev" href="suffix-tree-ukkonen.html">
      
      
        <link rel="next" href="lyndon_factorization.html">
      
      
        <link rel="alternate" type="application/rss+xml" title="خوراک آراس‌اس" href="../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="خوراک آراساس محتویات به‌روز شده" href="../feed_rss_updated.xml">
      
      <link rel="icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>اتوماتای پسوندی - Algorithms for Competitive Programming</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/rtl.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-7FLS2HCYHH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-7FLS2HCYHH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-7FLS2HCYHH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="rtl" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#suffix-automaton" class="md-skip">
          پرش به محتویات
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
-->


<header class="md-header" data-md-component="header">
  <script>
    function scrollToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }
  </script>
  <nav class="md-header__inner md-grid" aria-label="header.title">
    <a href=".." title="Algorithms for Competitive Programming" class="md-header__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <a href=".." title="Algorithms for Competitive Programming" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
              Algorithms for Competitive Programming
            </a>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <a href="#" onclick="scrollToTop()">
              
                اتوماتای پسوندی
              
            </a>
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="جستجو" placeholder="جستجو" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="جستجو">
        
        <button type="reset" class="md-search__icon md-icon" title="بازنشانی" aria-label="بازنشانی" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            راه‌اندازی جستجو
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cp-algorithms/cp-algorithms" title="رفتن به مخزن" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    cp-algorithms/cp-algorithms
  </div>
</a>
      </div>
    
      <div class="rss icon">
      <a href="https://cp-algorithms.com/feed_rss_created.xml" title="RSS" class="md-content__button md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64m0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0m32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg>
      </a>
      </div>

    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="هدایت" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Algorithms for Competitive Programming" class="md-nav__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    Algorithms for Competitive Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cp-algorithms/cp-algorithms" title="رفتن به مخزن" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    cp-algorithms/cp-algorithms
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    خانه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            خانه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    صفحه اصلی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ناوبری
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فهرست برچسب‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    چگونه مشارکت کنیم
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آیین‌نامه رفتاری
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پیش‌نمایش
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    جبر
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            جبر
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/binary-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    توان‌رسانی دودویی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم اقلیدس برای محاسبه بزرگترین مقسوم‌علیه مشترک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/extended-euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم اقلیدس تعمیم‌یافته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/linear-diophantine-equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    معادلات سیاله خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/fibonacci-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اعداد فیبوناچی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    اعداد اول
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            اعداد اول
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/sieve-of-eratosthenes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    غربال اراتستن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/prime-sieve-linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    غربال خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/primality_tests.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آزمون‌های اول بودن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه اعداد صحیح
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    توابع نظریه اعداد
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            توابع نظریه اعداد
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/phi-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تابع فی اویلر
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تعداد مقسوم‌علیه‌ها / جمع مقسوم‌علیه‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    حساب پیمانه‌ای
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            حساب پیمانه‌ای
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/module-inverse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    وارون پیمانه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/linear_congruence_equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    معادله همنهشتی خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/chinese-remainder-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه باقیمانده چینی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/garners-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم Garner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorial-modulo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فاکتوریل به پیمانه p
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/discrete-log.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    لگاریتم گسسته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/primitive-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ریشه اولیه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/discrete-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ریشه گسسته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/montgomery_multiplication.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ضرب Montgomery
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    دستگاه‌های اعداد
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            دستگاه‌های اعداد
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/balanced-ternary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    سه‌سه‌ای متوازن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/gray-code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    کد گِرِی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/bit-manipulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    عملیات بیتی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/all-submasks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شمارش زیرماسک‌های یک بیت‌ماسک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/big-integer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    محاسبات با دقت دلخواه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/fft.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تبدیل سریع فوریه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/polynomial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    عملیات روی چندجمله‌ای‌ها و سری‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/continued-fractions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    کسرهای مسلسل
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factoring-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه توان
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ساختمان داده‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ساختمان داده‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/stack_queue_modification.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پشته کمینه / صف کمینه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sparse-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جدول پراکنده
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    درخت‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            درخت‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/disjoint_set_union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ساختار داده اجتماع-جداگانه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/fenwick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت فن‌ویک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه رادیکالی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/segment_tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت بازه‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/treap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تریپ (Treap)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt-tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت رادیکالی (Sqrt Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/randomized_heap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    هیپ تصادفی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پیشرفته
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            پیشرفته
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/deleting_in_log_n.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    حذف از یک ساختمان داده در O(T(n) log n)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    برنامه‌نویسی پویا
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            برنامه‌نویسی پویا
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/intro-to-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مقدمه‌ای بر برنامه‌نویسی پویا
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knapsack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله کوله‌پشتی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    بهینه‌سازی‌های برنامه‌نویسی پویا
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            بهینه‌سازی‌های برنامه‌نویسی پویا
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/divide-and-conquer-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    برنامه‌نویسی پویای تقسیم و غلبه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knuth-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بهینه‌سازی Knuth
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مسائل
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            مسائل
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/profile-dynamics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    برنامه‌نویسی پویا روی پروفایل شکسته. مسئله "پارکت"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/zero_matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن بزرگترین زیرماتریس صفر
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پردازش رشته
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            پردازش رشته
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="string-hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    هشینگ رشته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rabin-karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم رابین-کارپ برای تطبیق رشته
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="prefix-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تابع پیشوندی - کنوث-موریس-پرت (KMP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="z-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تابع Z
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="suffix-array.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آرایه پسوندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="aho_corasick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم آهو-کوراسیک
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پیشرفته
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            پیشرفته
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="suffix-tree-ukkonen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پسوندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    اتوماتای پسوندی
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="suffix-automaton.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    اتوماتای پسوندی
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="فهرست موضوعات">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      فهرست موضوعات
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      تعریف آتاماتای پسوندی
    </span>
  </a>
  
    <nav class="md-nav" aria-label="تعریف آتاماتای پسوندی">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      خاصیت زیررشته
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      نمونه‌هایی از آتاماتاهای پسوندی ساخته‌شده
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      ساخت در زمان خطی
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ساخت در زمان خطی">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#endpos" class="md-nav__link">
    <span class="md-ellipsis">
      End positions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#link" class="md-nav__link">
    <span class="md-ellipsis">
      Suffix links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      جمع‌بندی
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      الگوریتم
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      صحت
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      تعداد خطی عملیات
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      پیاده‌سازی
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ویژگی‌های اضافی
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ویژگی‌های اضافی">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      تعداد حالت‌ها
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      تعداد گذارها
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      کاربردها
    </span>
  </a>
  
    <nav class="md-nav" aria-label="کاربردها">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      بررسی وجود یک رشته
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      تعداد زیررشته‌های متمایز
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      طول کل تمام زیررشته‌های متمایز
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k-" class="md-nav__link">
    <span class="md-ellipsis">
      Lexicographically k-th substring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      کوچکترین شیفت دوره‌ای
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      تعداد رخدادها
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      موقعیت اولین رخداد
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      تمام موقعیت‌های رخداد
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      کوتاه‌ترین رشته‌ای که ظاهر نمی‌شود
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      طولانی‌ترین زیررشته مشترک دو رشته
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      بزرگترین زیررشته مشترک چندین رشته
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      مسائل تمرینی
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lyndon_factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه لیندون
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مسائل
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            مسائل
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="expression_parsing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه عبارت
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="manacher.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم ماناکر - یافتن تمام زیرپالیندروم‌ها در O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="main_lorentz.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن تکرارها
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    جبر خطی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            جبر خطی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ماتریس‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            ماتریس‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/linear-system-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    گاوس و دستگاه معادلات خطی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    گاوس و دترمینان
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-kraut.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kraut و دترمینان
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/rank-matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    رتبه ماتریس
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ترکیبیات
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ترکیبیات
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مبانی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            مبانی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorial-divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن توان مقسوم‌علیه فاکتوریل
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/binomial-coefficients.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ضرایب دوجمله‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/catalan-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اعداد کاتالان
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    تکنیک‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            تکنیک‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/inclusion-exclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    اصل شمول و عدم شمول
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/burnside.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    لم برنساید / قضیه شمارش پولیا
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/stars_and_bars.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ستاره‌ها و خطوط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/generating_combinations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تولید تمام ترکیب‌های Kتایی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مسائل
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            مسائل
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bishops-on-chessboard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قرار دادن فیل‌ها در صفحه شطرنج
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bracket_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دنباله‌های پرانتز متوازن
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/counting_labeled_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شمارش گراف‌های برچسب‌دار
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    روش‌های عددی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            روش‌های عددی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    جستجو
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            جستجو
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/binary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی دودویی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/ternary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی سه‌سه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/roots_newton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    روش نیوتن برای یافتن ریشه‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simulated_annealing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تبرید شبیه‌سازی‌شده
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    انتگرال‌گیری
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            انتگرال‌گیری
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simpson-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    انتگرال‌گیری با فرمول سیمپسون
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    هندسه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            هندسه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    عملیات مقدماتی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            عملیات مقدماتی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/basic-geometry.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    هندسه پایه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segment-to-line.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن معادله خط یک پاره‌خط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lines-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    نقطه تقاطع خطوط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/check-segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی تقاطع دو پاره‌خط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع پاره‌خط‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-line-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع دایره و خط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-circle-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع دو دایره
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/tangents-to-two-circles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مماس‌های مشترک دو دایره
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/length-of-segments-union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    طول اجتماع پاره‌خط‌ها
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    چندضلعی‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            چندضلعی‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/oriented-triangle-area.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مساحت جهت‌دار مثلث
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/area-of-simple-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مساحت چندضلعی ساده
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-in-convex-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی تعلق نقاط به چندضلعی محدب در O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/minkowski.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جمع مینکوفسکی چندضلعی‌های محدب
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/picks-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه پیک - مساحت چندضلعی‌های شبکه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lattice-points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    نقاط شبکه‌ای چندضلعی غیرشبکه‌ای
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پوش محدب
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            پوش محدب
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex-hull.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ساخت پوش محدب
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex_hull_trick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ترفند پوش محدب و درخت Li Chao
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    خط جاروب
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            خط جاروب
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/intersecting_segments.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی یک جفت پاره‌خط متقاطع
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    گراف‌های مسطح
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            گراف‌های مسطح
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/planar.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن وجه‌های یک گراف مسطح
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-location.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مکان‌یابی نقطه در O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/nearest_points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن نزدیک‌ترین جفت نقاط
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/delaunay.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مثلث‌بندی دلونی و دیاگرام ورونوی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/vertical_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه عمودی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/halfplane-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تقاطع نیم‌صفحه‌ها - الگوریتم S&amp;I در O(N log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/manhattan-distance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فاصله منهتن
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    گراف‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            گراف‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پیمایش گراف
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            پیمایش گراف
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/breadth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی اول سطح (BFS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/depth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی اول عمق (DFS)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    مؤلفه‌های همبندی، پل‌ها، نقاط مفصلی
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            مؤلفه‌های همبندی، پل‌ها، نقاط مفصلی
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/search-for-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن مؤلفه‌های همبندی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن پل‌ها در O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching-online.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن پل‌ها به صورت آنلاین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/cutpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن نقاط مفصلی در O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strongly-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مؤلفه‌های قویاً همبند و گراف انقباضی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strong-orientation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جهت‌دهی قوی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    کوتاه‌ترین مسیرهای تک‌مبدأ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            کوتاه‌ترین مسیرهای تک‌مبدأ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دایکسترا - یافتن کوتاه‌ترین مسیرها از یک رأس معین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra_sparse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دایکسترا روی گراف‌های خلوت
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bellman_ford.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بلمن-فورد - یافتن کوتاه‌ترین مسیرها با وزن‌های منفی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/01_bfs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی اول سطح صفر و یک (0-1 BFS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/desopo_pape.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم D'Esopo-Pape
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    کوتاه‌ترین مسیرهای بین تمام زوج‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            کوتاه‌ترین مسیرهای بین تمام زوج‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/all-pair-shortest-path-floyd-warshall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    فلوید-وارشال - یافتن تمام کوتاه‌ترین مسیرها
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/fixed_length_paths.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تعداد مسیرها با طول ثابت / کوتاه‌ترین مسیرها با طول ثابت
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    درخت‌های پوشا
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            درخت‌های پوشا
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_prim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پوشای کمینه - الگوریتم پریم
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پوشای کمینه - کروسکال
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal_with_dsu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت پوشای کمینه - کروسکال با ساختار داده اجتماع-جداگانه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/second_best_mst.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دومین درخت پوشای کمینه بهتر - با استفاده از کروسکال و پایین‌ترین جد مشترک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kirchhoff-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه کیرشهف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/pruefer_code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    کد پروفر
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    دورها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            دورها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-cycle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی غیرمدور بودن گراف و یافتن دور در O(M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-negative-cycle-in-graph.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    یافتن دور منفی در گراف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/euler_path.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسیر اویلری
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            پایین‌ترین جد مشترک
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک (LCA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_binary_lifting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک - پرش دودویی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_farachcoltonbender.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک - الگوریتم Farach-Colton و Bender
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/rmq_linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    حل RMQ با یافتن LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_tarjan.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    پایین‌ترین جد مشترک - الگوریتم آفلاین Tarjan
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    شار و مسائل مرتبط
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            شار و مسائل مرتبط
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edmonds_karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - فورد-فالکرسون و ادموندز-کارپ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم Push-relabel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel-faster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم بهبودیافته Push-relabel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dinic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم دینیک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mpm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار بیشینه - الگوریتم MPM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/flow_with_demands.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار با تقاضا
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/min_cost_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    شار با کمترین هزینه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/Assignment-problem-min-flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله تخصیص
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    تطابق و مسائل مرتبط
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            تطابق و مسائل مرتبط
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bipartite-check.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بررسی دوبخشی بودن گراف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kuhn_maximum_bipartite_matching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم کوهن - تطابق بیشینه در گراف دوبخشی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hungarian-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم مجارستانی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/topological-sort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مرتب‌سازی توپولوژیک
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edge_vertex_connectivity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    همبندی یالی / همبندی رأسی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/tree_painting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    رنگ‌آمیزی درخت
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/2SAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    دو-ارضاپذیری (2-SAT)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hld.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    تجزیه سنگین-سبک
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    دنباله‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            دنباله‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/rmq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله RMQ (پرس‌وجوی کمینه بازه - کوچکترین عنصر در یک بازه)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/longest_increasing_subsequence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    طولانی‌ترین زیردنباله صعودی
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/maximum_average_segment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    جستجوی زیربازه با بیشترین/کمترین مجموع
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/k-th.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    آماره مرتبه K-ام در O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/mex.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله MEX (کمترین عنصر حذف‌شده در یک آرایه)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    نظریه بازی‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            نظریه بازی‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/games_on_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بازی‌ها روی گراف‌های دلخواه
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/sprague-grundy-nim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    قضیه اسپراگ-گراندی. نیم (Nim)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    زمان‌بندی‌ها
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            زمان‌بندی‌ها
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_one_machine.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    زمان‌بندی کارها روی یک ماشین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_two_machines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    زمان‌بندی کارها روی دو ماشین
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule-with-completion-duration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    زمان‌بندی بهینه کارها با توجه به مهلت‌ها و مدت‌زمانشان
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    متفرقه
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            متفرقه
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/tortoise_and_hare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    الگوریتم لاک‌پشت و خرگوش (تشخیص دور در لیست پیوندی)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/josephus_problem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    مسئله یوسف
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/15-puzzle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    بازی پازل ۱۵: وجود راه‌حل
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/stern_brocot_tree_farey_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    درخت اشترن-بروکوت و دنباله‌های فارِی
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <script type="text/javascript">
window.onload = function() {
	const newIssueURL = "https://github.com/cp-algorithms/cp-algorithms/issues/new";
  const issueTitle = "Problem on article " + "\u0627\u062a\u0648\u0645\u0627\u062a\u0627\u06cc \u067e\u0633\u0648\u0646\u062f\u06cc";
	const issueBody = `
 **Article:** [`+ "\u0627\u062a\u0648\u0645\u0627\u062a\u0627\u06cc \u067e\u0633\u0648\u0646\u062f\u06cc" + `](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
  var issue_a = document.getElementById("report_issue_a");
  issue_a.href = `${newIssueURL}?` + `title=${encodeURIComponent(issueTitle)}&` + `body=${encodeURIComponent(issueBody)}`;
}
</script>

<a href="https://github.com/cp-algorithms/cp-algorithms/edit/main/src/string/suffix-automaton.md" title="این صفحه را ویرایش کنید" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
</a>
<a id="report_issue_a" href="" title="Report a problem" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg>
</a>
<a href="https://github.com/cp-algorithms/cp-algorithms/commits/main/src/string/suffix-automaton.md" title="Page authors" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M12,8.5c-0.91,0-2.75,0.46-2.75,1.38v4.62h1.5V19h2.5v-4.5h1.5V9.88C14.75,8.97,12.91,8.5,12,8.5z"/><path d="M12,2C6.47,2,2,6.47,2,12s4.47,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.42,0-8-3.58-8-8s3.58-8,8-8s8,3.58,8,8 S16.42,20,12,20z"/><circle cx="12" cy="6.5" r="1.5"/></g></g></g></svg>
</a>


<!-- Construct the dict of author's contribution percentage -->




  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  



  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  




<!-- Date of last commit -->
<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">

  اخرین بروزرسانی:
  <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="6 ژوئیهٔ 2025 13:36:29 UTC">6 ژوئیهٔ 2025</span>&emsp;

<!-- Tags -->

  
  
  
    
  


  
    <a href="../tags.html#tag:ai-translated" class="md-tag">
      AI Translated
    </a>
  

  
    <a href="https://e-maxx.ru/algo/suffix-automaton" class="md-tag">
      From: e-maxx.ru
    </a>
  

</ul>


<h1 id="suffix-automaton">آتاماتای پسوندی (Suffix Automaton)<a class="headerlink" href="#suffix-automaton" title="Permanent link">&para;</a></h1>
<p><strong>آتاماتای پسوندی</strong> یک ساختمان داده قدرتمند است که امکان حل بسیاری از مسائل مرتبط با رشته‌ها را فراهم می‌کند.</p>
<p>به‌عنوان مثال، با استفاده از آن می‌توانید تمام رخدادهای یک رشته را در رشته‌ای دیگر پیدا کنید، یا تعداد زیررشته‌های متمایز یک رشته‌ی معین را بشمارید.
هر دو این وظایف را می‌توان با کمک آتاماتای پسوندی در زمان خطی حل کرد.</p>
<p>به‌طور شهودی، آتاماتای پسوندی را می‌توان به‌عنوان شکلی فشرده از <strong>تمام زیررشته‌های</strong> یک رشته‌ی معین درک کرد.
یک واقعیت چشمگیر این است که آتاماتای پسوندی تمام این اطلاعات را در قالبی بسیار فشرده نگهداری می‌کند.
برای یک رشته به طول <span class="arithmatex">$n$</span>، این ساختار تنها به حافظه‌ای از مرتبه <span class="arithmatex">$O(n)$</span> نیاز دارد.
علاوه بر این، ساخت آن نیز در زمان <span class="arithmatex">$O(n)$</span> امکان‌پذیر است (اگر اندازه الفبا، <span class="arithmatex">$k$</span>، را ثابت در نظر بگیریم)، در غیر این صورت، هم حافظه و هم پیچیدگی زمانی <span class="arithmatex">$O(n \log k)$</span> خواهد بود.</p>
<p>خطی بودن اندازه آتاماتای پسوندی اولین بار در سال ۱۹۸۳ توسط Blumer و همکارانش کشف شد و در سال ۱۹۸۵ اولین الگوریتم‌های خطی برای ساخت آن توسط Crochemore و Blumer ارائه گردید.</p>
<h2 id="_1">تعریف آتاماتای پسوندی<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>آتاماتای پسوندی برای یک رشته‌ی داده شده <span class="arithmatex">$s$</span>، یک <strong>DFA</strong> (آتاماتای متناهی قطعی / ماشین حالت متناهی قطعی) کمینه است که تمام پسوندهای رشته <span class="arithmatex">$s$</span> را می‌پذیرد.</p>
<p>به‌عبارت دیگر:</p>
<ul>
<li>آتاماتای پسوندی یک گراف جهت‌دار غیرمدور است.
  رئوس آن <strong>حالت</strong> (states) و یال‌ها <strong>گذار</strong> (transitions) بین حالت‌ها نامیده می‌شوند.</li>
<li>یکی از حالت‌ها، <span class="arithmatex">$t_0$</span>، <strong>حالت اولیه</strong> است و باید منبع گراف باشد (یعنی تمام حالت‌های دیگر از <span class="arithmatex">$t_0$</span> قابل دسترسی هستند).</li>
<li>هر <strong>گذار</strong> با یک کاراکتر برچسب‌گذاری شده است.
  تمام گذارهای خارج‌شونده از یک حالت باید برچسب‌های <strong>متفاوتی</strong> داشته باشند.</li>
<li>یک یا چند حالت به‌عنوان <strong>حالت‌های پایانی</strong> علامت‌گذاری شده‌اند.
  اگر از حالت اولیه <span class="arithmatex">$t_0$</span> شروع کرده و در طول گذارها به یک حالت پایانی برسیم، برچسب‌های گذارهای طی‌شده باید یکی از پسوندهای رشته <span class="arithmatex">$s$</span> را بسازند.
  هر یک از پسوندهای <span class="arithmatex">$s$</span> باید با استفاده از یک مسیر از <span class="arithmatex">$t_0$</span> به یک حالت پایانی قابل ساختن باشد.</li>
<li>آتاماتای پسوندی شامل کمترین تعداد رأس در میان تمام آتاماتاهایی است که شرایط توصیف‌شده در بالا را برآورده می‌کنند.</li>
</ul>
<h3 id="_2">خاصیت زیررشته<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>ساده‌ترین و مهم‌ترین خاصیت آتاماتای پسوندی این است که اطلاعات مربوط به تمام زیررشته‌های رشته <span class="arithmatex">$s$</span> را در خود دارد.
هر مسیری که از حالت اولیه <span class="arithmatex">$t_0$</span> شروع شود، اگر برچسب‌های گذارهای آن را یادداشت کنیم، یک <strong>زیررشته</strong> از <span class="arithmatex">$s$</span> را تشکیل می‌دهد.
و برعکس، هر زیررشته از <span class="arithmatex">$s$</span> با یک مسیر مشخص که از <span class="arithmatex">$t_0$</span> شروع می‌شود، متناظر است.</p>
<p>برای ساده‌سازی توضیحات، خواهیم گفت که زیررشته با آن مسیر <strong>متناظر است</strong> (مسیری که از <span class="arithmatex">$t_0$</span> شروع شده و برچسب‌هایش آن زیررشته را می‌سازند).
و برعکس، می‌گوییم هر مسیر با رشته‌ای که از برچسب‌هایش ساخته می‌شود، <strong>متناظر است</strong>.</p>
<p>یک یا چند مسیر می‌توانند به یک حالت منتهی شوند.
بنابراین، خواهیم گفت که یک حالت با مجموعه‌ای از رشته‌ها <strong>متناظر است</strong> که این رشته‌ها با آن مسیرها متناظر هستند.</p>
<h3 id="_3">نمونه‌هایی از آتاماتاهای پسوندی ساخته‌شده<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>در اینجا چند نمونه از آتاماتاهای پسوندی برای چند رشته ساده را نشان می‌دهیم.</p>
<p>حالت اولیه را با رنگ آبی و حالت‌های پایانی را با رنگ سبز مشخص می‌کنیم.</p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{""}$</span>:</p>
<p><img alt="Suffix automaton for &quot;&quot;" src="SA.png" /></p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{"a"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;a&quot;" src="SAa.png" /></p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{"aa"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;aa&quot;" src="SAaa.png" /></p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{"ab"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;ab&quot;" src="SAab.png" /></p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{"aba"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;aba&quot;" src="SAaba.png" /></p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{"abb"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;abb&quot;" src="SAabb.png" /></p>
<p>برای رشته‌ی <span class="arithmatex">$s =~ \text{"abbb"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;abbb&quot;" src="SAabbb.png" /></p>
<h2 id="_4">ساخت در زمان خطی<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>قبل از اینکه الگوریتم ساخت آتاماتای پسوندی در زمان خطی را توصیف کنیم، باید چند مفهوم جدید و اثبات ساده را معرفی کنیم که در درک فرآیند ساخت بسیار مهم خواهند بود.</p>
<h3 id="endpos">مواضع پایانی <span class="arithmatex">$endpos$</span><a class="headerlink" href="#endpos" title="Permanent link">&para;</a></h3>
<p>هر زیررشته غیرتهی <span class="arithmatex">$t$</span> از رشته <span class="arithmatex">$s$</span> را در نظر بگیرید.
مجموعه‌ی تمام مواضعی در رشته <span class="arithmatex">$s$</span> که رخدادهای <span class="arithmatex">$t$</span> در آنجا به پایان می‌رسند را با <span class="arithmatex">$endpos(t)$</span> نمایش می‌دهیم. برای مثال، برای رشته <span class="arithmatex">$\text{"abcbc"}$</span> داریم <span class="arithmatex">$endpos(\text{"bc"}) = \{2, 4\}$</span>.</p>
<p>دو زیررشته <span class="arithmatex">$t_1$</span> و <span class="arithmatex">$t_2$</span> را <span class="arithmatex">$endpos$</span>-هم‌ارز می‌نامیم اگر مجموعه‌های پایانی آنها یکسان باشند: <span class="arithmatex">$endpos(t_1) = endpos(t_2)$</span>.
بنابراین تمام زیررشته‌های غیرتهی رشته <span class="arithmatex">$s$</span> را می‌توان بر اساس مجموعه‌های <span class="arithmatex">$endpos$</span> آنها به چندین <strong>کلاس هم‌ارزی</strong> تقسیم کرد.</p>
<p>مشخص می‌شود که در یک ماشین پسوندی، زیررشته‌های <span class="arithmatex">$endpos$</span>-هم‌ارز <strong>با یک حالت یکسان متناظر هستند</strong>.
به‌عبارت دیگر، تعداد حالت‌ها در یک آتاماتای پسوندی برابر است با تعداد کلاس‌های هم‌ارزی در میان تمام زیررشته‌ها، به علاوه حالت اولیه.
هر حالت از آتاماتای پسوندی با یک یا چند زیررشته که دارای مقدار <span class="arithmatex">$endpos$</span> یکسانی هستند، متناظر است.</p>
<p>ما بعداً الگوریتم ساخت را با استفاده از این فرض توصیف خواهیم کرد.
سپس خواهیم دید که تمام ویژگی‌های مورد نیاز یک آتاماتای پسوندی، به جز کمینه بودن، برآورده می‌شوند.
و کمینه بودن از قضیه Nerode نتیجه می‌شود (که در این مقاله اثبات نخواهد شد).</p>
<p>می‌توانیم چند مشاهده مهم در مورد مقادیر <span class="arithmatex">$endpos$</span> داشته باشیم:</p>
<p><strong>لم ۱</strong>:
دو زیررشته غیرتهی <span class="arithmatex">$u$</span> و <span class="arithmatex">$w$</span> (با <span class="arithmatex">$length(u) \le length(w)$</span>) <span class="arithmatex">$endpos$</span>-هم‌ارز هستند، اگر و تنها اگر رشته <span class="arithmatex">$u$</span> در <span class="arithmatex">$s$</span> فقط به شکل یک پسوند از <span class="arithmatex">$w$</span> ظاهر شود.</p>
<p>اثبات واضح است.
اگر <span class="arithmatex">$u$</span> و <span class="arithmatex">$w$</span> مقادیر <span class="arithmatex">$endpos$</span> یکسانی داشته باشند، آنگاه <span class="arithmatex">$u$</span> پسوندی از <span class="arithmatex">$w$</span> است و فقط به شکل پسوندی از <span class="arithmatex">$w$</span> در <span class="arithmatex">$s$</span> ظاهر می‌شود.
و اگر <span class="arithmatex">$u$</span> پسوندی از <span class="arithmatex">$w$</span> باشد و فقط به شکل پسوند در <span class="arithmatex">$s$</span> ظاهر شود، آنگاه مقادیر <span class="arithmatex">$endpos$</span> طبق تعریف برابر هستند.</p>
<p><strong>لم ۲</strong>:
دو زیررشته غیرتهی <span class="arithmatex">$u$</span> و <span class="arithmatex">$w$</span> را در نظر بگیرید (با <span class="arithmatex">$length(u) \le length(w)$</span>).
آنگاه مجموعه‌های <span class="arithmatex">$endpos$</span> آنها یا اصلاً اشتراکی ندارند، یا <span class="arithmatex">$endpos(w)$</span> زیرمجموعه‌ای از <span class="arithmatex">$endpos(u)$</span> است.
و این بستگی به این دارد که آیا <span class="arithmatex">$u$</span> پسوندی از <span class="arithmatex">$w$</span> است یا خیر.</p>
<div class="arithmatex">$$\begin{cases}
endpos(w) \subseteq endpos(u) &amp; \text{اگر } u \text{ پسوندی از } w \text{ باشد} \\\\
endpos(w) \cap endpos(u) = \emptyset &amp; \text{در غیر این صورت}
\end{cases}$$</div>
<p>اثبات:
اگر مجموعه‌های <span class="arithmatex">$endpos(u)$</span> و <span class="arithmatex">$endpos(w)$</span> حداقل یک عنصر مشترک داشته باشند، آنگاه رشته‌های <span class="arithmatex">$u$</span> و <span class="arithmatex">$w$</span> هر دو در آن موضع به پایان می‌رسند، یعنی <span class="arithmatex">$u$</span> پسوندی از <span class="arithmatex">$w$</span> است.
اما در این صورت، در هر رخداد <span class="arithmatex">$w$</span>، زیررشته <span class="arithmatex">$u$</span> نیز ظاهر می‌شود، که به این معنی است که <span class="arithmatex">$endpos(w)$</span> زیرمجموعه‌ای از <span class="arithmatex">$endpos(u)$</span> است.</p>
<p><strong>لم ۳</strong>:
یک کلاس هم‌ارزی <span class="arithmatex">$endpos$</span> را در نظر بگیرید.
تمام زیررشته‌های این کلاس را بر اساس طول نزولی مرتب کنید.
آنگاه در دنباله حاصل، هر زیررشته یک کاراکتر کوتاه‌تر از قبلی خواهد بود و در عین حال پسوندی از قبلی خواهد بود.
به‌عبارت دیگر، در یک کلاس هم‌ارزی یکسان، زیررشته‌های کوتاه‌تر در واقع پسوندهای زیررشته‌های بلندتر هستند و تمام طول‌های ممکن را در یک بازه مشخص <span class="arithmatex">$[x; y]$</span> به خود اختصاص می‌دهند.</p>
<p>اثبات:
یک کلاس هم‌ارزی <span class="arithmatex">$endpos$</span> را ثابت در نظر بگیرید.
اگر فقط شامل یک رشته باشد، لم بدیهی است.
حال فرض کنید تعداد رشته‌ها در کلاس بیشتر از یک باشد.</p>
<p>طبق لم ۱، دو رشته متفاوت <span class="arithmatex">$endpos$</span>-هم‌ارز همیشه به گونه‌ای هستند که رشته کوتاه‌تر، یک پسوند سره از رشته بلندتر است.
در نتیجه، نمی‌توان دو رشته با طول یکسان در یک کلاس هم‌ارزی داشت.</p>
<p><span class="arithmatex">$w$</span> را بلندترین و <span class="arithmatex">$u$</span> را کوتاه‌ترین رشته در کلاس هم‌ارزی در نظر بگیرید.
طبق لم ۱، رشته <span class="arithmatex">$u$</span> یک پسوند سره از رشته <span class="arithmatex">$w$</span> است.
حال هر پسوندی از <span class="arithmatex">$w$</span> با طولی در بازه <span class="arithmatex">$[length(u); length(w)]$</span> را در نظر بگیرید.
به‌راحتی می‌توان دید که این پسوند نیز در همان کلاس هم‌ارزی قرار دارد.
زیرا این پسوند تنها می‌تواند به شکل پسوندی از <span class="arithmatex">$w$</span> در رشته <span class="arithmatex">$s$</span> ظاهر شود (چون پسوند کوتاه‌تر <span class="arithmatex">$u$</span> نیز در <span class="arithmatex">$s$</span> فقط به شکل پسوندی از <span class="arithmatex">$w$</span> ظاهر می‌شود).
در نتیجه، طبق لم ۱، این پسوند با رشته <span class="arithmatex">$w$</span> <span class="arithmatex">$endpos$</span>-هم‌ارز است.</p>
<h3 id="link">لینک‌های پسوندی <span class="arithmatex">$link$</span><a class="headerlink" href="#link" title="Permanent link">&para;</a></h3>
<p>یک حالت <span class="arithmatex">$v \ne t_0$</span> در آتاماتا را در نظر بگیرید.
همان‌طور که می‌دانیم، حالت <span class="arithmatex">$v$</span> با کلاسی از رشته‌ها با مقادیر <span class="arithmatex">$endpos$</span> یکسان متناظر است.
و اگر <span class="arithmatex">$w$</span> را بلندترینِ این رشته‌ها بنامیم، آنگاه تمام رشته‌های دیگر پسوندهای <span class="arithmatex">$w$</span> هستند.</p>
<p>همچنین می‌دانیم که چند پسوند اول یک رشته <span class="arithmatex">$w$</span> (اگر پسوندها را به ترتیب نزولی طولشان در نظر بگیریم) همگی در این کلاس هم‌ارزی قرار دارند و سایر پسوندها (حداقل یک پسوند دیگر - پسوند تهی) در کلاس‌های دیگری قرار دارند.
بزرگترین پسوندی که در کلاس دیگری قرار دارد را <span class="arithmatex">$t$</span> می‌نامیم و یک لینک پسوندی به آن ایجاد می‌کنیم.</p>
<p>به‌عبارت دیگر، یک <strong>لینک پسوندی</strong> <span class="arithmatex">$link(v)$</span> به حالتی می‌رود که متناظر با <strong>بلندترین پسوند</strong> <span class="arithmatex">$w$</span> است که در یک کلاس هم‌ارزی <span class="arithmatex">$endpos$</span> دیگر قرار دارد.</p>
<p>در اینجا فرض می‌کنیم که حالت اولیه <span class="arithmatex">$t_0$</span> با کلاس هم‌ارزی خودش متناظر است (که فقط شامل رشته تهی است) و برای راحتی کار، <span class="arithmatex">$endpos(t_0) = \{-1, 0, \dots, length(s)-1\}$</span> را تعریف می‌کنیم.</p>
<p><strong>لم ۴</strong>:
لینک‌های پسوندی یک <strong>درخت</strong> با ریشه <span class="arithmatex">$t_0$</span> تشکیل می‌دهند.</p>
<p>اثبات:
یک حالت دلخواه <span class="arithmatex">$v \ne t_0$</span> را در نظر بگیرید.
یک لینک پسوندی <span class="arithmatex">$link(v)$</span> به حالتی می‌رود که متناظر با رشته‌هایی با طول اکیداً کمتر است (این از تعریف لینک‌های پسوندی و لم ۳ نتیجه می‌شود).
بنابراین، با حرکت در طول لینک‌های پسوندی، دیر یا زود به حالت اولیه <span class="arithmatex">$t_0$</span> خواهیم رسید که با رشته تهی متناظر است.</p>
<p><strong>لم ۵</strong>:
اگر با استفاده از مجموعه‌های <span class="arithmatex">$endpos$</span> درختی بسازیم (با این قانون که مجموعه گره والد شامل مجموعه‌های تمام فرزندانش به عنوان زیرمجموعه است)، آنگاه ساختار با درخت لینک‌های پسوندی منطبق خواهد بود.</p>
<p>اثبات:
این واقعیت که می‌توانیم با استفاده از مجموعه‌های <span class="arithmatex">$endpos$</span> یک درخت بسازیم، مستقیماً از لم ۲ نتیجه می‌شود (اینکه هر دو مجموعه یا اشتراکی ندارند یا یکی در دیگری محاط است).</p>
<p>حال یک حالت دلخواه <span class="arithmatex">$v \ne t_0$</span> و لینک پسوندی آن <span class="arithmatex">$link(v)$</span> را در نظر بگیرید.
از تعریف لینک پسوندی و از لم ۲ نتیجه می‌شود که:</p>
<div class="arithmatex">$$endpos(v) \subseteq endpos(link(v)),$$</div>
<p>که این رابطه همراه با لم قبلی، ادعا را اثبات می‌کند:
درخت لینک‌های پسوندی در اصل یک درخت از مجموعه‌های <span class="arithmatex">$endpos$</span> است.</p>
<p>در اینجا یک <strong>نمونه</strong> از درخت لینک‌های پسوندی در آتاماتای پسوندی ساخته‌شده برای رشته <span class="arithmatex">$\text{"abcbc"}$</span> را می‌بینید.
گره‌ها با بلندترین زیررشته از کلاس هم‌ارزی مربوطه برچسب‌گذاری شده‌اند.</p>
<p><img alt="Suffix automaton for &quot;abcbc&quot; with suffix links" src="SA_suffix_links.png" /></p>
<h3 id="_5">جمع‌بندی<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>قبل از پرداختن به خود الگوریتم، دانش انباشته‌شده را مرور می‌کنیم و چند نماد کمکی معرفی می‌کنیم.</p>
<ul>
<li>زیررشته‌های رشته <span class="arithmatex">$s$</span> را می‌توان بر اساس مواضع پایانی‌شان (<span class="arithmatex">$endpos$</span>) به کلاس‌های هم‌ارزی تقسیم کرد.</li>
<li>آتاماتای پسوندی از حالت اولیه <span class="arithmatex">$t_0$</span> و همچنین یک حالت برای هر کلاس هم‌ارزی <span class="arithmatex">$endpos$</span> تشکیل شده است.</li>
<li>برای هر حالت <span class="arithmatex">$v$</span> یک یا چند زیررشته منطبق است.
  ما بلندترینِ این رشته‌ها را با <span class="arithmatex">$longest(v)$</span> و طول آن را با <span class="arithmatex">$len(v)$</span> نشان می‌دهیم.
  کوتاه‌ترینِ این زیررشته‌ها را با <span class="arithmatex">$shortest(v)$</span> و طول آن را با <span class="arithmatex">$minlen(v)$</span> نشان می‌دهیم.
  آنگاه تمام رشته‌های متناظر با این حالت، پسوندهای متفاوتی از رشته <span class="arithmatex">$longest(v)$</span> هستند و تمام طول‌های ممکن در بازه <span class="arithmatex">$[minlen(v); len(v)]$</span> را دارند.</li>
<li>برای هر حالت <span class="arithmatex">$v \ne t_0$</span> یک لینک پسوندی تعریف می‌شود که به حالتی می‌رود که متناظر با پسوندی از رشته <span class="arithmatex">$longest(v)$</span> با طول <span class="arithmatex">$minlen(v) - 1$</span> است.
  لینک‌های پسوندی درختی با ریشه <span class="arithmatex">$t_0$</span> تشکیل می‌دهند و در عین حال این درخت رابطه شمول بین مجموعه‌های <span class="arithmatex">$endpos$</span> را نشان می‌دهد.</li>
<li>می‌توانیم <span class="arithmatex">$minlen(v)$</span> را برای <span class="arithmatex">$v \ne t_0$</span> با استفاده از لینک پسوندی <span class="arithmatex">$link(v)$</span> به این صورت بیان کنیم:</li>
</ul>
<div class="arithmatex">$$minlen(v) = len(link(v)) + 1$$</div>
<ul>
<li>اگر از یک حالت دلخواه <span class="arithmatex">$v_0$</span> شروع کرده و لینک‌های پسوندی را دنبال کنیم، دیر یا زود به حالت اولیه <span class="arithmatex">$t_0$</span> خواهیم رسید.
  در این حالت، دنباله‌ای از بازه‌های گسسته <span class="arithmatex">$[minlen(v_i); len(v_i)]$</span> به دست می‌آوریم که اجتماع آنها بازه پیوسته <span class="arithmatex">$[0; len(v_0)]$</span> را تشکیل می‌دهد.</li>
</ul>
<h3 id="_6">الگوریتم<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>اکنون می‌توانیم به خود الگوریتم بپردازیم.
الگوریتم <strong>برخط (آنلاین)</strong> خواهد بود، یعنی کاراکترهای رشته را یک به یک اضافه کرده و در هر مرحله آتاماتا را بر اساس آن اصلاح می‌کنیم.</p>
<p>برای دستیابی به مصرف حافظه خطی، فقط مقادیر <span class="arithmatex">$len$</span>، <span class="arithmatex">$link$</span> و لیستی از گذارها را در هر حالت ذخیره می‌کنیم.
حالت‌های پایانی را برچسب‌گذاری نمی‌کنیم (اما بعداً نشان خواهیم داد که چگونه پس از ساخت آتاماتای پسوندی این برچسب‌ها را تنظیم کنیم).</p>
<p>در ابتدا آتاماتا از یک حالت واحد <span class="arithmatex">$t_0$</span> تشکیل شده است که اندیس <span class="arithmatex">$0$</span> را خواهد داشت (حالت‌های باقیمانده اندیس‌های <span class="arithmatex">$1, 2, \dots$</span> را دریافت می‌کنند).
برای راحتی، به آن <span class="arithmatex">$len = 0$</span> و <span class="arithmatex">$link = -1$</span> اختصاص می‌دهیم (<span class="arithmatex">$-1$</span> یک حالت فرضی و ناموجود خواهد بود).</p>
<p>اکنون تمام کار به پیاده‌سازی فرآیند <strong>افزودن یک کاراکتر</strong> <span class="arithmatex">$c$</span> به انتهای رشته فعلی خلاصه می‌شود.
بیایید این فرآیند را توصیف کنیم:</p>
<ul>
<li>فرض کنید <span class="arithmatex">$last$</span> حالتی است که با کل رشته قبل از افزودن کاراکتر <span class="arithmatex">$c$</span> متناظر است.
    (در ابتدا <span class="arithmatex">$last = 0$</span> را تنظیم می‌کنیم و در آخرین مرحله الگوریتم، <span class="arithmatex">$last$</span> را بر اساس آن تغییر خواهیم داد.)</li>
<li>یک حالت جدید <span class="arithmatex">$cur$</span> ایجاد کنید و به آن <span class="arithmatex">$len(cur) = len(last) + 1$</span> را اختصاص دهید.
    مقدار <span class="arithmatex">$link(cur)$</span> در این لحظه مشخص نیست.</li>
<li>اکنون رویه زیر را انجام می‌دهیم:
    از حالت <span class="arithmatex">$last$</span> شروع می‌کنیم.
    تا زمانی که گذاری با حرف <span class="arithmatex">$c$</span> وجود نداشته باشد، یک گذار به حالت <span class="arithmatex">$cur$</span> اضافه می‌کنیم و لینک پسوندی را دنبال می‌کنیم.
    اگر در نقطه‌ای گذاری با حرف <span class="arithmatex">$c$</span> از قبل وجود داشته باشد، متوقف شده و این حالت را <span class="arithmatex">$p$</span> می‌نامیم.</li>
<li>اگر چنین حالتی <span class="arithmatex">$p$</span> پیدا نکردیم، یعنی به حالت فرضی <span class="arithmatex">$-1$</span> رسیدیم، آنگاه می‌توانیم <span class="arithmatex">$link(cur) = 0$</span> را اختصاص داده و خارج شویم.</li>
<li>حال فرض کنید حالتی <span class="arithmatex">$p$</span> پیدا کرده‌ایم که از آن گذاری با حرف <span class="arithmatex">$c$</span> وجود دارد.
    حالتی را که این گذار به آن منتهی می‌شود، <span class="arithmatex">$q$</span> می‌نامیم.</li>
<li>اکنون دو حالت داریم. یا <span class="arithmatex">$len(p) + 1 = len(q)$</span> یا نه.</li>
<li>اگر <span class="arithmatex">$len(p) + 1 = len(q)$</span> باشد، آنگاه می‌توانیم به سادگی <span class="arithmatex">$link(cur) = q$</span> را اختصاص داده و خارج شویم.</li>
<li>
<p>در غیر این صورت، کمی پیچیده‌تر است.
    لازم است حالت <span class="arithmatex">$q$</span> را <strong>کلون کنیم</strong>:
    یک حالت جدید <span class="arithmatex">$clone$</span> ایجاد می‌کنیم، تمام داده‌ها را از <span class="arithmatex">$q$</span> (لینک پسوندی و گذارها) به جز مقدار <span class="arithmatex">$len$</span> کپی می‌کنیم.
    مقدار <span class="arithmatex">$len(clone) = len(p) + 1$</span> را اختصاص می‌دهیم.</p>
<p>پس از کلون کردن، لینک پسوندی از <span class="arithmatex">$cur$</span> را به <span class="arithmatex">$clone$</span> و همچنین از <span class="arithmatex">$q$</span> به <span class="arithmatex">$clone$</span> هدایت می‌کنیم.</p>
<p>در نهایت، باید از حالت <span class="arithmatex">$p$</span> به عقب با استفاده از لینک‌های پسوندی حرکت کنیم تا زمانی که گذاری با <span class="arithmatex">$c$</span> به حالت <span class="arithmatex">$q$</span> وجود دارد و همه آنها را به حالت <span class="arithmatex">$clone$</span> هدایت کنیم.</p>
</li>
<li>
<p>در هر یک از سه حالت، پس از اتمام رویه، مقدار <span class="arithmatex">$last$</span> را با حالت <span class="arithmatex">$cur$</span> به‌روز می‌کنیم.</p>
</li>
</ul>
<p>اگر بخواهیم بدانیم کدام حالت‌ها <strong>پایانی</strong> هستند و کدام نیستند، می‌توانیم پس از ساخت کامل آتاماتای پسوندی برای کل رشته <span class="arithmatex">$s$</span>، تمام حالت‌های پایانی را پیدا کنیم.
برای این کار، حالتی را که با کل رشته متناظر است (در متغیر <span class="arithmatex">$last$</span> ذخیره شده است) برمی‌داریم و لینک‌های پسوندی آن را دنبال می‌کنیم تا به حالت اولیه برسیم.
تمام حالت‌های بازدید شده را به عنوان پایانی علامت‌گذاری می‌کنیم.
به‌راحتی می‌توان فهمید که با این کار دقیقاً حالت‌های متناظر با تمام پسوندهای رشته <span class="arithmatex">$s$</span> را علامت‌گذاری می‌کنیم، که دقیقاً همان حالت‌های پایانی هستند.</p>
<p>در بخش بعدی، هر مرحله را به تفصیل بررسی کرده و <strong>صحت</strong> آن را نشان خواهیم داد.</p>
<p>در اینجا فقط اشاره می‌کنیم که، از آنجایی که برای هر کاراکتر از <span class="arithmatex">$s$</span> فقط یک یا دو حالت جدید ایجاد می‌کنیم، آتاماتای پسوندی دارای <strong>تعداد خطی حالت</strong> است.</p>
<p>خطی بودن تعداد گذارها و به‌طور کلی خطی بودن زمان اجرای الگوریتم کمتر واضح است و پس از اثبات صحت، اثبات خواهند شد.</p>
<h3 id="_7">صحت<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>یک گذار <span class="arithmatex">$(p, q)$</span> را <strong>پیوسته</strong> می‌نامیم اگر <span class="arithmatex">$len(p) + 1 = len(q)$</span> باشد.
    در غیر این صورت، یعنی زمانی که <span class="arithmatex">$len(p) + 1 &lt; len(q)$</span> باشد، گذار <strong>ناپیوسته</strong> نامیده می‌شود.</p>
<p>همانطور که از توصیف الگوریتم می‌توان دید، گذارهای پیوسته و ناپیوسته به موارد مختلفی از الگوریتم منجر می‌شوند.
گذارهای پیوسته ثابت هستند و دیگر هرگز تغییر نخواهند کرد.
در مقابل، گذارهای ناپیوسته ممکن است با اضافه شدن حروف جدید به رشته تغییر کنند (انتهای یال گذار ممکن است تغییر کند).</p>
</li>
<li>
<p>برای جلوگیری از ابهام، رشته‌ای که آتاماتای پسوندی برای آن قبل از افزودن کاراکتر فعلی <span class="arithmatex">$c$</span> ساخته شده است را با <span class="arithmatex">$s$</span> نشان می‌دهیم.</p>
</li>
<li>
<p>الگوریتم با ایجاد یک حالت جدید <span class="arithmatex">$cur$</span> شروع می‌شود که با کل رشته <span class="arithmatex">$s + c$</span> متناظر خواهد بود.
    واضح است که چرا باید یک حالت جدید ایجاد کنیم.
    همراه با کاراکتر جدید، یک کلاس هم‌ارزی جدید ایجاد می‌شود.</p>
</li>
<li>
<p>پس از ایجاد یک حالت جدید، با شروع از حالتی که با کل رشته <span class="arithmatex">$s$</span> متناظر است، از طریق لینک‌های پسوندی حرکت می‌کنیم.
    برای هر حالت، سعی می‌کنیم یک گذار با کاراکتر <span class="arithmatex">$c$</span> به حالت جدید <span class="arithmatex">$cur$</span> اضافه کنیم.
    بنابراین کاراکتر <span class="arithmatex">$c$</span> را به هر پسوند <span class="arithmatex">$s$</span> اضافه می‌کنیم.
    با این حال، تنها در صورتی می‌توانیم این گذارهای جدید را اضافه کنیم که با یک گذار موجود تداخل نداشته باشند.
    بنابراین به محض اینکه یک گذار موجود با <span class="arithmatex">$c$</span> پیدا کنیم، باید متوقف شویم.</p>
</li>
<li>
<p>در ساده‌ترین حالت، به حالت فرضی <span class="arithmatex">$-1$</span> رسیده‌ایم.
    این بدان معناست که ما گذار با <span class="arithmatex">$c$</span> را به تمام پسوندهای <span class="arithmatex">$s$</span> اضافه کرده‌ایم.
    این همچنین به این معناست که کاراکتر <span class="arithmatex">$c$</span> قبلاً بخشی از رشته <span class="arithmatex">$s$</span> نبوده است.
    بنابراین لینک پسوندی <span class="arithmatex">$cur$</span> باید به حالت <span class="arithmatex">$0$</span> برود.</p>
</li>
<li>
<p>در حالت دوم، به یک گذار موجود <span class="arithmatex">$(p, q)$</span> برخورد کرده‌ایم.
    این بدان معناست که ما سعی کردیم رشته <span class="arithmatex">$x + c$</span> (که در آن <span class="arithmatex">$x$</span> یک پسوند از <span class="arithmatex">$s$</span> است) را به ماشین اضافه کنیم که <strong>از قبل</strong> در ماشین وجود دارد (رشته <span class="arithmatex">$x + c$</span> از قبل به عنوان یک زیررشته از <span class="arithmatex">$s$</span> ظاهر می‌شود).
    از آنجایی که فرض می‌کنیم آتاماتا برای رشته <span class="arithmatex">$s$</span> به درستی ساخته شده است، نباید در اینجا یک گذار جدید اضافه کنیم.</p>
<p>با این حال، یک مشکل وجود دارد.
لینک پسوندی از حالت <span class="arithmatex">$cur$</span> باید به کدام حالت برود؟
باید یک لینک پسوندی به حالتی ایجاد کنیم که بلندترین رشته آن دقیقاً <span class="arithmatex">$x + c$</span> باشد، یعنی <span class="arithmatex">$len$</span> این حالت باید <span class="arithmatex">$len(p) + 1$</span> باشد.
اما ممکن است چنین حالتی هنوز وجود نداشته باشد، یعنی <span class="arithmatex">$len(q) &gt; len(p) + 1$</span>.
در این حالت باید چنین حالتی را با <strong>تقسیم کردن</strong> حالت <span class="arithmatex">$q$</span> ایجاد کنیم.</p>
</li>
<li>
<p>اگر گذار <span class="arithmatex">$(p, q)$</span> پیوسته باشد، آنگاه <span class="arithmatex">$len(q) = len(p) + 1$</span>.
    در این حالت همه چیز ساده است.
    لینک پسوندی را از <span class="arithmatex">$cur$</span> به حالت <span class="arithmatex">$q$</span> هدایت می‌کنیم.</p>
</li>
<li>
<p>در غیر این صورت، گذار ناپیوسته است، یعنی <span class="arithmatex">$len(q) &gt; len(p) + 1$</span>.
    این بدان معناست که حالت <span class="arithmatex">$q$</span> نه تنها با پسوند <span class="arithmatex">$s + c$</span> به طول <span class="arithmatex">$len(p) + 1$</span>، بلکه با زیررشته‌های بلندتری از <span class="arithmatex">$s$</span> نیز متناظر است.
    کاری جز <strong>تقسیم کردن</strong> حالت <span class="arithmatex">$q$</span> به دو حالت فرعی نمی‌توانیم انجام دهیم، به طوری که اولین حالت دارای طول <span class="arithmatex">$len(p) + 1$</span> باشد.</p>
<p>چگونه می‌توان یک حالت را تقسیم کرد؟
ما حالت <span class="arithmatex">$q$</span> را <strong>کلون می‌کنیم</strong>، که حالت <span class="arithmatex">$clone$</span> را به ما می‌دهد و <span class="arithmatex">$len(clone) = len(p) + 1$</span> را تنظیم می‌کنیم.
تمام گذارها را از <span class="arithmatex">$q$</span> به <span class="arithmatex">$clone$</span> کپی می‌کنیم، زیرا نمی‌خواهیم مسیرهایی را که از <span class="arithmatex">$q$</span> عبور می‌کنند تغییر دهیم.
همچنین لینک پسوندی از <span class="arithmatex">$clone$</span> را به مقصد لینک پسوندی <span class="arithmatex">$q$</span> تنظیم می‌کنیم و لینک پسوندی <span class="arithmatex">$q$</span> را به <span class="arithmatex">$clone$</span> تنظیم می‌کنیم.</p>
<p>و پس از تقسیم حالت، لینک پسوندی از <span class="arithmatex">$cur$</span> را به <span class="arithmatex">$clone$</span> تنظیم می‌کنیم.</p>
<p>در مرحله آخر، برخی از گذارها به <span class="arithmatex">$q$</span> را تغییر می‌دهیم، آنها را به <span class="arithmatex">$clone$</span> هدایت می‌کنیم.
کدام گذارها را باید تغییر دهیم؟
کافی است فقط گذارهای متناظر با تمام پسوندهای رشته <span class="arithmatex">$w + c$</span> (که در آن <span class="arithmatex">$w$</span> بلندترین رشته <span class="arithmatex">$p$</span> است) را تغییر دهیم، یعنی باید با شروع از رأس <span class="arithmatex">$p$</span> به حرکت در طول لینک‌های پسوندی ادامه دهیم تا به حالت فرضی <span class="arithmatex">$-1$</span> یا گذاری که به حالتی غیر از <span class="arithmatex">$q$</span> می‌رود، برسیم.</p>
</li>
</ul>
<h3 id="_8">تعداد خطی عملیات<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>ابتدا بلافاصله فرض می‌کنیم که اندازه الفبا <strong>ثابت</strong> است.
اگر اینطور نباشد، نمی‌توان از پیچیدگی زمانی خطی صحبت کرد.
لیست گذارها از یک رأس در یک درخت متوازن ذخیره می‌شود که به شما امکان می‌دهد عملیات جستجوی کلید و افزودن کلید را به سرعت انجام دهید.
بنابراین اگر <span class="arithmatex">$k$</span> را اندازه الفبا بنامیم، رفتار مجانبی الگوریتم <span class="arithmatex">$O(n \log k)$</span> با حافظه <span class="arithmatex">$O(n)$</span> خواهد بود.
با این حال، اگر الفبا به اندازه کافی کوچک باشد، می‌توانید با اجتناب از درختان متوازن، حافظه را فدا کرده و گذارها را در هر رأس به عنوان یک آرایه به طول <span class="arithmatex">$k$</span> (برای جستجوی سریع با کلید) و یک لیست پویا (برای پیمایش سریع همه کلیدهای موجود) ذخیره کنید.
بنابراین به پیچیدگی زمانی <span class="arithmatex">$O(n)$</span> برای الگوریتم می‌رسیم، اما با هزینه حافظه <span class="arithmatex">$O(n k)$</span>.</p>
<p>بنابراین اندازه الفبا را ثابت در نظر می‌گیریم، یعنی هر عملیات جستجوی یک گذار بر روی یک کاراکتر، افزودن یک گذار، جستجوی گذار بعدی - همه این عملیات را می‌توان در <span class="arithmatex">$O(1)$</span> انجام داد.</p>
<p>اگر تمام بخش‌های الگوریتم را در نظر بگیریم، سه مکان در الگوریتم وجود دارد که پیچیدگی خطی در آنها واضح نیست:</p>
<ul>
<li>مکان اول، پیمایش از طریق لینک‌های پسوندی از حالت <span class="arithmatex">$last$</span> و افزودن گذارها با کاراکتر <span class="arithmatex">$c$</span> است.</li>
<li>مکان دوم، کپی کردن گذارها هنگام کلون شدن حالت <span class="arithmatex">$q$</span> به یک حالت جدید <span class="arithmatex">$clone$</span> است.</li>
<li>مکان سوم، تغییر گذارهایی است که به <span class="arithmatex">$q$</span> می‌روند و هدایت آنها به <span class="arithmatex">$clone$</span>.</li>
</ul>
<p>ما از این واقعیت استفاده می‌کنیم که اندازه آتاماتای پسوندی (هم از نظر تعداد حالت‌ها و هم از نظر تعداد گذارها) <strong>خطی</strong> است.
(اثبات خطی بودن تعداد حالت‌ها خود الگوریتم است، و اثبات خطی بودن تعداد گذارها در زیر، پس از پیاده‌سازی الگوریتم، ارائه شده است).</p>
<p>بنابراین، پیچیدگی کل <strong>مکان اول و دوم</strong> واضح است، زیرا هر عملیات به صورت سرشکن تنها یک گذار جدید به آتاماتا اضافه می‌کند.</p>
<p>باقی می‌ماند که پیچیدگی کل <strong>مکان سوم</strong> را تخمین بزنیم، که در آن گذارهایی که در ابتدا به <span class="arithmatex">$q$</span> اشاره داشتند را به <span class="arithmatex">$clone$</span> هدایت می‌کنیم.
<span class="arithmatex">$v = longest(p)$</span> را در نظر می‌گیریم.
این یک پسوند از رشته <span class="arithmatex">$s$</span> است و با هر تکرار طول آن کاهش می‌یابد - و بنابراین موقعیت <span class="arithmatex">$v$</span> به عنوان پسوند رشته <span class="arithmatex">$s$</span> با هر تکرار به طور یکنواخت افزایش می‌یابد.
در این حالت، اگر قبل از اولین تکرار حلقه، رشته متناظر <span class="arithmatex">$v$</span> در عمق <span class="arithmatex">$k$</span> (<span class="arithmatex">$k \ge 2$</span>) از <span class="arithmatex">$last$</span> قرار داشت (با شمارش عمق به عنوان تعداد لینک‌های پسوندی)، پس از آخرین تکرار، رشته <span class="arithmatex">$v + c$</span> دومین لینک پسوندی در مسیر از <span class="arithmatex">$cur$</span> خواهد بود (که به مقدار جدید <span class="arithmatex">$last$</span> تبدیل می‌شود).</p>
<p>بنابراین، هر تکرار این حلقه منجر به این می‌شود که موقعیت رشته <span class="arithmatex">$longest(link(link(last)))$</span> به عنوان پسوندی از رشته فعلی به طور یکنواخت افزایش یابد.
بنابراین این حلقه نمی‌تواند بیش از <span class="arithmatex">$n$</span> بار اجرا شود، که برای اثبات مورد نیاز بود.</p>
<h3 id="_9">پیاده‌سازی<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>ابتدا یک ساختمان داده را توصیف می‌کنیم که تمام اطلاعات مربوط به یک گذار خاص (<span class="arithmatex">$len$</span>، <span class="arithmatex">$link$</span> و لیست گذارها) را ذخیره می‌کند.
در صورت لزوم می‌توانید یک پرچم پایانی و همچنین اطلاعات دیگر را در اینجا اضافه کنید.
ما لیست گذارها را به شکل یک <span class="arithmatex">$map$</span> ذخیره می‌کنیم که به ما امکان می‌دهد به حافظه کل <span class="arithmatex">$O(n)$</span> و زمان <span class="arithmatex">$O(n \log k)$</span> برای پردازش کل رشته دست یابیم.</p>
<div class="cpp highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">state</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">link</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">next</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>خود آتاماتای پسوندی در یک آرایه از این ساختارهای <span class="arithmatex">$state$</span> ذخیره می‌شود.
ما اندازه فعلی <span class="arithmatex">$sz$</span> و همچنین متغیر <span class="arithmatex">$last$</span> (حالتی که با کل رشته در لحظه متناظر است) را ذخیره می‌کنیم.</p>
<div class="cpp highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MAXLEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100000</span><span class="p">;</span>
<span class="n">state</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">MAXLEN</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">;</span>
</code></pre></div>
<p>تابعی را ارائه می‌دهیم که یک آتاماتای پسوندی را مقداردهی اولیه می‌کند (یک آتاماتای پسوندی با یک حالت واحد ایجاد می‌کند).</p>
<div class="cpp highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">sa_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="n">sz</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>و در نهایت پیاده‌سازی تابع اصلی را ارائه می‌دهیم - که کاراکتر بعدی را به انتهای خط فعلی اضافه می‌کند و ماشین را بر اساس آن بازسازی می‌کند.</p>
<div class="cpp highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">sa_extend</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sz</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">last</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">last</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="w">        </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">link</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sz</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">clone</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">clone</span><span class="p">].</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">next</span><span class="p">;</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">clone</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">link</span><span class="p">;</span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clone</span><span class="p">;</span>
<span class="w">                </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">link</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clone</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>همانطور که در بالا ذکر شد، اگر حافظه را فدا کنید (<span class="arithmatex">$O(n k)$</span>، که در آن <span class="arithmatex">$k$</span> اندازه الفبا است)، می‌توانید به زمان ساخت ماشین در <span class="arithmatex">$O(n)$</span> دست یابید، حتی برای هر اندازه الفبای <span class="arithmatex">$k$</span>.
اما برای این کار باید در هر حالت یک آرایه به اندازه <span class="arithmatex">$k$</span> (برای پرش سریع به گذار حرف) و یک لیست اضافی از تمام گذارها (برای تکرار سریع روی آنها) ذخیره کنید.</p>
<h2 id="_10">ویژگی‌های اضافی<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h3 id="_11">تعداد حالت‌ها<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>تعداد حالت‌ها در آتاماتای پسوندی رشته <span class="arithmatex">$s$</span> به طول <span class="arithmatex">$n$</span> <strong>بیش از</strong> <span class="arithmatex">$2n - 1$</span> <strong>نیست</strong> (برای <span class="arithmatex">$n \ge 2$</span>).</p>
<p>اثبات همان الگوریتم ساخت است، زیرا در ابتدا آتاماتا از یک حالت تشکیل شده است و در تکرار اول و دوم فقط یک حالت واحد ایجاد می‌شود و در <span class="arithmatex">$n-2$</span> مرحله باقیمانده در هر مرحله حداکثر <span class="arithmatex">$2$</span> حالت ایجاد می‌شود.</p>
<p>با این حال، ما می‌توانیم این تخمین را <strong>بدون دانستن الگوریتم</strong> نیز <strong>نشان دهیم</strong>.
به یاد بیاورید که تعداد حالت‌ها برابر با تعداد مجموعه‌های <span class="arithmatex">$endpos$</span> متفاوت است.
علاوه بر این، این مجموعه‌های <span class="arithmatex">$endpos$</span> یک درخت را تشکیل می‌دهند (یک رأس والد تمام مجموعه‌های فرزندان را در مجموعه خود دارد).
این درخت را در نظر بگیرید و آن را کمی تغییر دهید:
تا زمانی که یک رأس داخلی با تنها یک فرزند دارد (که به این معنی است که مجموعه فرزند حداقل یک موقعیت از مجموعه والد را کم دارد)، ما یک فرزند جدید با مجموعه موقعیت‌های گمشده ایجاد می‌کنیم.
در پایان، ما یک درخت داریم که در آن هر رأس داخلی درجه‌ای بزرگتر از یک دارد و تعداد برگ‌ها از <span class="arithmatex">$n$</span> تجاوز نمی‌کند.
بنابراین در چنین درختی بیش از <span class="arithmatex">$2n - 1$</span> رأس وجود ندارد.</p>
<p>این کران برای تعداد حالت‌ها در واقع برای هر <span class="arithmatex">$n$</span> قابل دستیابی است.
یک رشته ممکن این است:</p>
<div class="arithmatex">$$\text{"abbb}\dots \text{bbb"}$$</div>
<p>در هر تکرار، با شروع از سومین تکرار، الگوریتم یک حالت را تقسیم می‌کند که منجر به دقیقاً <span class="arithmatex">$2n - 1$</span> حالت می‌شود.</p>
<h3 id="_12">تعداد گذارها<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>تعداد گذارها در آتاماتای پسوندی رشته <span class="arithmatex">$s$</span> به طول <span class="arithmatex">$n$</span> <strong>بیش از</strong> <span class="arithmatex">$3n - 4$</span> <strong>نیست</strong> (برای <span class="arithmatex">$n \ge 3$</span>).</p>
<p>بیایید این را اثبات کنیم:</p>
<p>ابتدا تعداد گذارهای پیوسته را تخمین می‌زنیم.
یک درخت پوشا از طولانی‌ترین مسیرها در آتاماتا را که از حالت <span class="arithmatex">$t_0$</span> شروع می‌شود در نظر بگیرید.
این اسکلت فقط از یال‌های پیوسته تشکیل خواهد شد و بنابراین تعداد آنها کمتر از تعداد حالت‌ها است، یعنی از <span class="arithmatex">$2n - 2$</span> تجاوز نمی‌کند.</p>
<p>اکنون تعداد گذارهای ناپیوسته را تخمین می‌زنیم.
گذار ناپیوسته فعلی را <span class="arithmatex">$(p, q)$</span> با کاراکتر <span class="arithmatex">$c$</span> در نظر بگیرید.
رشته متناظر <span class="arithmatex">$u + c + w$</span> را در نظر می‌گیریم، که در آن رشته <span class="arithmatex">$u$</span> با طولانی‌ترین مسیر از حالت اولیه به <span class="arithmatex">$p$</span> و <span class="arithmatex">$w$</span> با طولانی‌ترین مسیر از <span class="arithmatex">$q$</span> به هر حالت پایانی متناظر است.
از یک طرف، هر چنین رشته‌ای <span class="arithmatex">$u + c + w$</span> برای هر رشته ناقص متفاوت خواهد بود (زیرا رشته‌های <span class="arithmatex">$u$</span> و <span class="arithmatex">$w$</span> فقط از گذارهای کامل تشکیل شده‌اند).
از طرف دیگر، هر چنین رشته‌ای <span class="arithmatex">$u + c + w$</span>، طبق تعریف حالت‌های پایانی، پسوندی از کل رشته <span class="arithmatex">$s$</span> خواهد بود.
از آنجا که تنها <span class="arithmatex">$n$</span> پسوند غیرتهی از <span class="arithmatex">$s$</span> وجود دارد و هیچ یک از رشته‌های <span class="arithmatex">$u + c + w$</span> نمی‌تواند شامل <span class="arithmatex">$s$</span> باشد (زیرا کل رشته فقط شامل گذارهای کامل است)، تعداد کل گذارهای ناقص از <span class="arithmatex">$n - 1$</span> تجاوز نمی‌کند.</p>
<p>ترکیب این دو تخمین به ما کران <span class="arithmatex">$3n - 3$</span> را می‌دهد.
با این حال، از آنجا که حداکثر تعداد حالت‌ها فقط با مورد آزمایشی <span class="arithmatex">$\text{"abbb\dots bbb"}$</span> قابل دستیابی است و این مورد به وضوح کمتر از <span class="arithmatex">$3n - 3$</span> گذار دارد، ما کران تنگ‌تر <span class="arithmatex">$3n - 4$</span> را برای تعداد گذارها در یک آتاماتای پسوندی به دست می‌آوریم.</p>
<p>این کران را می‌توان با رشته زیر نیز به دست آورد:</p>
<div class="arithmatex">$$\text{"abbb}\dots \text{bbbc"}$$</div>
<h2 id="_13">کاربردها<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<p>در اینجا به برخی از مسائلی که می‌توان با استفاده از آتاماتای پسوندی حل کرد، نگاهی می‌اندازیم.
برای سادگی، فرض می‌کنیم که اندازه الفبای <span class="arithmatex">$k$</span> ثابت است، که به ما امکان می‌دهد پیچیدگی افزودن یک کاراکتر و پیمایش را ثابت در نظر بگیریم.</p>
<h3 id="_14">بررسی وجود یک رشته<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>یک متن <span class="arithmatex">$T$</span> و چندین الگوی <span class="arithmatex">$P$</span> داده شده است.
باید بررسی کنیم که آیا رشته‌های <span class="arithmatex">$P$</span> به عنوان زیررشته‌ای از <span class="arithmatex">$T$</span> ظاهر می‌شوند یا خیر.</p>
<p>یک آتاماتای پسوندی از متن <span class="arithmatex">$T$</span> را در زمان <span class="arithmatex">$O(length(T))$</span> می‌سازیم.
برای بررسی اینکه آیا یک الگوی <span class="arithmatex">$P$</span> در <span class="arithmatex">$T$</span> ظاهر می‌شود، با شروع از <span class="arithmatex">$t_0$</span>، گذارها را مطابق با کاراکترهای <span class="arithmatex">$P$</span> دنبال می‌کنیم.
اگر در نقطه‌ای گذاری وجود نداشته باشد، الگوی <span class="arithmatex">$P$</span> به عنوان زیررشته‌ای از <span class="arithmatex">$T$</span> ظاهر نمی‌شود.
اگر بتوانیم کل رشته <span class="arithmatex">$P$</span> را به این روش پردازش کنیم، آنگاه رشته در <span class="arithmatex">$T$</span> ظاهر می‌شود.</p>
<p>واضح است که این کار برای هر رشته <span class="arithmatex">$P$</span> زمان <span class="arithmatex">$O(length(P))$</span> می‌برد.
علاوه بر این، الگوریتم در واقع طول طولانی‌ترین پیشوند <span class="arithmatex">$P$</span> را که در متن ظاهر می‌شود، پیدا می‌کند.</p>
<h3 id="_15">تعداد زیررشته‌های متمایز<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>یک رشته <span class="arithmatex">$S$</span> داده شده است.
می‌خواهید تعداد زیررشته‌های متمایز را محاسبه کنید.</p>
<p>یک آتاماتای پسوندی برای رشته <span class="arithmatex">$S$</span> می‌سازیم.</p>
<p>هر زیررشته از <span class="arithmatex">$S$</span> با یک مسیر در آتاماتا متناظر است.
بنابراین، تعداد زیررشته‌های متمایز برابر با تعداد مسیرهای مختلف در آتاماتا است که از <span class="arithmatex">$t_0$</span> شروع می‌شوند.</p>
<p>با توجه به اینکه آتاماتای پسوندی یک گراف جهت‌دار غیرمدور است، تعداد راه‌های مختلف را می‌توان با استفاده از برنامه‌نویسی پویا محاسبه کرد.</p>
<p>یعنی، فرض کنید <span class="arithmatex">$d[v]$</span> تعداد راه‌هایی باشد که از حالت <span class="arithmatex">$v$</span> شروع می‌شوند (شامل مسیر به طول صفر).
آنگاه رابطه بازگشتی زیر را داریم:</p>
<div class="arithmatex">$$d[v] = 1 + \sum_{w : (v, w, c) \in DAWG} d[w]$$</div>
<p>یعنی، <span class="arithmatex">$d[v]$</span> را می‌توان به عنوان مجموع پاسخ‌ها برای تمام انتهای گذارهای <span class="arithmatex">$v$</span> بیان کرد.</p>
<p>تعداد زیررشته‌های متمایز مقدار <span class="arithmatex">$d[t_0] - 1$</span> است (زیرا زیررشته خالی را نمی‌شماریم).</p>
<p>پیچیدگی زمانی کل: <span class="arithmatex">$O(length(S))$</span></p>
<p>به طور جایگزین، می‌توانیم از این واقعیت استفاده کنیم که هر حالت <span class="arithmatex">$v$</span> با زیررشته‌هایی به طول <span class="arithmatex">$[minlen(v),len(v)]$</span> مطابقت دارد.
بنابراین، با توجه به اینکه <span class="arithmatex">$minlen(v) = 1 + len(link(v))$</span>، تعداد کل زیررشته‌های متمایز در حالت <span class="arithmatex">$v$</span> برابر است با <span class="arithmatex">$len(v) - minlen(v) + 1 = len(v) - (1 + len(link(v))) + 1 = len(v) - len(link(v))$</span>.</p>
<p>این موضوع به طور خلاصه در زیر نشان داده شده است:</p>
<div class="highlight"><pre><span></span><code><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">get_diff_strings</span><span class="p">(){</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">tot</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">link</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>در حالی که این روش نیز <span class="arithmatex">$O(length(S))$</span> است، به فضای اضافی و فراخوانی‌های بازگشتی نیاز ندارد و در نتیجه در عمل سریعتر اجرا می‌شود.</p>
<h3 id="_16">طول کل تمام زیررشته‌های متمایز<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>یک رشته <span class="arithmatex">$S$</span> داده شده است.
می‌خواهیم طول کل تمام زیررشته‌های مختلف آن را محاسبه کنیم.</p>
<p>راه حل شبیه به قبلی است، فقط اکنون لازم است دو کمیت برای بخش برنامه‌نویسی پویا در نظر گرفته شود:
تعداد زیررشته‌های متمایز <span class="arithmatex">$d[v]$</span> و طول کل آنها <span class="arithmatex">$ans[v]$</span>.</p>
<p>ما قبلاً نحوه محاسبه <span class="arithmatex">$d[v]$</span> را در کار قبلی توصیف کردیم.
مقدار <span class="arithmatex">$ans[v]$</span> را می‌توان با استفاده از رابطه بازگشتی زیر محاسبه کرد:</p>
<div class="arithmatex">$$ans[v] = \sum_{w : (v, w, c) \in DAWG} d[w] + ans[w]$$</div>
<p>ما پاسخ هر رأس مجاور <span class="arithmatex">$w$</span> را می‌گیریم و <span class="arithmatex">$d[w]$</span> را به آن اضافه می‌کنیم (زیرا هر زیررشته هنگام شروع از حالت <span class="arithmatex">$v$</span> یک کاراکتر طولانی‌تر است).</p>
<p>باز هم این کار را می‌توان در زمان <span class="arithmatex">$O(length(S))$</span> محاسبه کرد.</p>
<p>به طور جایگزین، باز هم می‌توانیم از این واقعیت استفاده کنیم که هر حالت <span class="arithmatex">$v$</span> با زیررشته‌هایی به طول <span class="arithmatex">$[minlen(v),len(v)]$</span> مطابقت دارد.
از آنجایی که <span class="arithmatex">$minlen(v) = 1 + len(link(v))$</span> و فرمول تصاعد حسابی <span class="arithmatex">$S_n = n \cdot \frac{a_1+a_n}{2}$</span> (که در آن <span class="arithmatex">$S_n$</span> مجموع <span class="arithmatex">$n$</span> جمله، <span class="arithmatex">$a_1$</span> جمله اول و <span class="arithmatex">$a_n$</span> جمله آخر را نشان می‌دهد)، می‌توانیم طول زیررشته‌ها را در یک حالت در زمان ثابت محاسبه کنیم. سپس این مجموع‌ها را برای هر حالت <span class="arithmatex">$v \neq t_0$</span> در آتاماتا جمع می‌کنیم. این توسط کد زیر نشان داده شده است:</p>
<div class="highlight"><pre><span></span><code><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">get_tot_len_diff_substings</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">shortest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">link</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>

<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">num_strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">shortest</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_strings</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">longest</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">shortest</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="n">tot</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>این رویکرد در زمان <span class="arithmatex">$O(length(S))$</span> اجرا می‌شود، اما به طور تجربی ۲۰ برابر سریعتر از نسخه برنامه‌نویسی پویای با مموایزیشن روی رشته‌های تصادفی اجرا می‌شود. این روش به فضای اضافی و بازگشت نیاز ندارد.</p>
<h3 id="k-"><span class="arithmatex">$k$</span>-امین زیررشته از نظر لغت‌نامه‌ای<a class="headerlink" href="#k-" title="Permanent link">&para;</a></h3>
<p>یک رشته <span class="arithmatex">$S$</span> داده شده است.
باید به چندین پرس‌وجو پاسخ دهیم.
برای هر عدد داده شده <span class="arithmatex">$K_i$</span> باید <span class="arithmatex">$K_i$</span>-امین رشته را در لیست مرتب‌شده از نظر لغت‌نامه‌ای از تمام زیررشته‌ها پیدا کنیم.</p>
<p>راه حل این مسئله بر اساس ایده دو مسئله قبلی است.
<span class="arithmatex">$k$</span>-امین زیررشته از نظر لغت‌نامه‌ای با <span class="arithmatex">$k$</span>-امین مسیر از نظر لغت‌نامه‌ای در آتاماتای پسوندی مطابقت دارد.
بنابراین پس از شمارش تعداد مسیرها از هر حالت، می‌توانیم به راحتی به دنبال <span class="arithmatex">$k$</span>-امین مسیر با شروع از ریشه آتاماتا بگردیم.</p>
<p>این کار <span class="arithmatex">$O(length(S))$</span> زمان برای پیش‌پردازش و سپس <span class="arithmatex">$O(length(ans) \cdot k)$</span> برای هر پرس‌وجو می‌برد (که در آن <span class="arithmatex">$ans$</span> پاسخ برای پرس‌وجو و <span class="arithmatex">$k$</span> اندازه الفبا است).</p>
<h3 id="_17">کوچکترین شیفت دوره‌ای<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>یک رشته <span class="arithmatex">$S$</span> داده شده است.
می‌خواهیم کوچکترین شیفت دوره‌ای را از نظر لغت‌نامه‌ای پیدا کنیم.</p>
<p>یک آتاماتای پسوندی برای رشته <span class="arithmatex">$S + S$</span> می‌سازیم.
آنگاه آتاماتا تمام شیفت‌های دوره‌ای رشته <span class="arithmatex">$S$</span> را به عنوان مسیر در خود خواهد داشت.</p>
<p>در نتیجه، مسئله به یافتن کوچکترین مسیر از نظر لغت‌نامه‌ای به طول <span class="arithmatex">$length(S)$</span> کاهش می‌یابد، که به روشی بدیهی قابل انجام است: از حالت اولیه شروع می‌کنیم و حریصانه از طریق گذارها با کوچکترین کاراکتر عبور می‌کنیم.</p>
<p>پیچیدگی زمانی کل <span class="arithmatex">$O(length(S))$</span> است.</p>
<h3 id="_18">تعداد رخدادها<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>برای یک متن داده شده <span class="arithmatex">$T$</span>.
باید به چندین پرس‌وجو پاسخ دهیم.
برای هر الگوی داده شده <span class="arithmatex">$P$</span> باید بفهمیم رشته <span class="arithmatex">$P$</span> چند بار در رشته <span class="arithmatex">$T$</span> به عنوان زیررشته ظاهر می‌شود.</p>
<p>ما آتاماتای پسوندی را برای متن <span class="arithmatex">$T$</span> می‌سازیم.</p>
<p>سپس پیش‌پردازش زیر را انجام می‌دهیم:
برای هر حالت <span class="arithmatex">$v$</span> در آتاماتا، عدد <span class="arithmatex">$cnt[v]$</span> را محاسبه می‌کنیم که برابر با اندازه مجموعه <span class="arithmatex">$endpos(v)$</span> است.
در واقع، تمام رشته‌های متناظر با یک حالت <span class="arithmatex">$v$</span> به تعداد مساوی در متن <span class="arithmatex">$T$</span> ظاهر می‌شوند که برابر با تعداد موقعیت‌ها در مجموعه <span class="arithmatex">$endpos$</span> است.</p>
<p>با این حال، ما نمی‌توانیم مجموعه‌های <span class="arithmatex">$endpos$</span> را به صراحت بسازیم، بنابراین فقط اندازه‌های آنها <span class="arithmatex">$cnt$</span> را در نظر می‌گیریم.</p>
<p>برای محاسبه آنها به صورت زیر عمل می‌کنیم.
برای هر حالت، اگر با کلون کردن ایجاد نشده باشد (و اگر حالت اولیه <span class="arithmatex">$t_0$</span> نباشد)، آن را با <span class="arithmatex">$cnt = 1$</span> مقداردهی اولیه می‌کنیم.
سپس تمام حالت‌ها را به ترتیب نزولی طولشان <span class="arithmatex">$len$</span> طی می‌کنیم و مقدار فعلی <span class="arithmatex">$cnt[v]$</span> را به لینک‌های پسوندی اضافه می‌کنیم:</p>
<div class="arithmatex">$$cnt[link(v)] \text{ += } cnt[v]$$</div>
<p>این مقدار صحیح را برای هر حالت می‌دهد.</p>
<p>چرا این درست است؟
تعداد کل حالت‌های به دست آمده که از طریق کلون کردن ایجاد نشده‌اند دقیقاً <span class="arithmatex">$length(T)$</span> است و <span class="arithmatex">$i$</span> تای اول آنها هنگام افزودن <span class="arithmatex">$i$</span> کاراکتر اول ظاهر شده‌اند.
در نتیجه، برای هر یک از این حالت‌ها، موقعیت متناظری را که در آن پردازش شده است، می‌شماریم.
بنابراین، در ابتدا برای هر چنین حالتی <span class="arithmatex">$cnt = 1$</span> و برای تمام حالت‌های دیگر <span class="arithmatex">$cnt = 0$</span> داریم.</p>
<p>سپس عملیات زیر را برای هر <span class="arithmatex">$v$</span> اعمال می‌کنیم: <span class="arithmatex">$cnt[link(v)] \text{ += } cnt[v]$</span>.
معنای این کار این است که اگر یک رشته <span class="arithmatex">$v$</span> <span class="arithmatex">$cnt[v]$</span> بار ظاهر شود، تمام پسوندهای آن نیز دقیقاً در همان موقعیت‌های پایانی ظاهر می‌شوند، بنابراین آنها نیز <span class="arithmatex">$cnt[v]$</span> بار ظاهر می‌شوند.</p>
<p>چرا در این رویه بیش‌شماری نمی‌کنیم (یعنی برخی موقعیت‌ها را دو بار نمی‌شماریم)؟
زیرا ما موقعیت‌های یک حالت را فقط به یک حالت دیگر اضافه می‌کنیم، بنابراین نمی‌تواند اتفاق بیفتد که یک حالت موقعیت‌های خود را به دو روش مختلف به یک حالت دیگر هدایت کند.</p>
<p>بنابراین می‌توانیم مقادیر <span class="arithmatex">$cnt$</span> را برای تمام حالت‌ها در آتاماتا در زمان <span class="arithmatex">$O(length(T))$</span> محاسبه کنیم.</p>
<p>پس از آن، پاسخ به یک پرس‌وجو با جستجوی مقدار <span class="arithmatex">$cnt[t]$</span> است، که در آن <span class="arithmatex">$t$</span> حالت متناظر با الگو است، اگر چنین حالتی وجود داشته باشد.
در غیر این صورت با <span class="arithmatex">$0$</span> پاسخ دهید.
پاسخ به یک پرس‌وجو <span class="arithmatex">$O(length(P))$</span> زمان می‌برد.</p>
<h3 id="_19">موقعیت اولین رخداد<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>یک متن <span class="arithmatex">$T$</span> و چندین پرس‌وجو داده شده است.
برای هر رشته پرس‌وجوی <span class="arithmatex">$P$</span> می‌خواهیم موقعیت اولین رخداد <span class="arithmatex">$P$</span> را در رشته <span class="arithmatex">$T$</span> پیدا کنیم (موقعیت شروع <span class="arithmatex">$P$</span>).</p>
<p>دوباره یک آتاماتای پسوندی می‌سازیم.
علاوه بر این، موقعیت <span class="arithmatex">$firstpos$</span> را برای تمام حالت‌ها در آتاماتا پیش‌محاسبه می‌کنیم، یعنی برای هر حالت <span class="arithmatex">$v$</span> می‌خواهیم موقعیت <span class="arithmatex">$firstpos[v]$</span> پایان اولین رخداد را پیدا کنیم.
به عبارت دیگر، می‌خواهیم از قبل عنصر کمینه هر مجموعه <span class="arithmatex">$endpos$</span> را پیدا کنیم (زیرا بدیهی است که نمی‌توانیم تمام مجموعه‌های <span class="arithmatex">$endpos$</span> را به صراحت نگهداری کنیم).</p>
<p>برای نگهداری این موقعیت‌های <span class="arithmatex">$firstpos$</span>، تابع <code>sa_extend()</code> را گسترش می‌دهیم.
وقتی یک حالت جدید <span class="arithmatex">$cur$</span> ایجاد می‌کنیم، تنظیم می‌کنیم:</p>
<div class="arithmatex">$$firstpos(cur) = len(cur) - 1$$</div>
<p>و وقتی یک رأس <span class="arithmatex">$q$</span> را به عنوان <span class="arithmatex">$clone$</span> کلون می‌کنیم، تنظیم می‌کنیم:</p>
<div class="arithmatex">$$firstpos(clone) = firstpos(q)$$</div>
<p>(زیرا تنها گزینه دیگر برای یک مقدار <span class="arithmatex">$firstpos(cur)$</span> خواهد بود که قطعاً خیلی بزرگ است)</p>
<p>بنابراین، پاسخ به یک پرس‌وجو به سادگی <span class="arithmatex">$firstpos(t) - length(P) + 1$</span> است، که در آن <span class="arithmatex">$t$</span> حالت متناظر با رشته <span class="arithmatex">$P$</span> است.
پاسخ به یک پرس‌وجو دوباره تنها <span class="arithmatex">$O(length(P))$</span> زمان می‌برد.</p>
<h3 id="_20">تمام موقعیت‌های رخداد<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>این بار باید تمام موقعیت‌های رخدادها را در رشته <span class="arithmatex">$T$</span> نمایش دهیم.</p>
<p>دوباره یک آتاماتای پسوندی برای متن <span class="arithmatex">$T$</span> می‌سازیم.
مشابه کار قبلی، موقعیت <span class="arithmatex">$firstpos$</span> را برای تمام حالت‌ها محاسبه می‌کنیم.</p>
<p>واضح است که <span class="arithmatex">$firstpos(t)$</span> بخشی از پاسخ است، اگر <span class="arithmatex">$t$</span> حالت متناظر با رشته پرس‌وجوی <span class="arithmatex">$P$</span> باشد.
بنابراین حالت آتاماتا حاوی <span class="arithmatex">$P$</span> را در نظر گرفتیم.
چه حالت‌های دیگری را باید در نظر بگیریم؟
تمام حالت‌هایی که با رشته‌هایی متناظر هستند که <span class="arithmatex">$P$</span> پسوندی از آنهاست.
به عبارت دیگر، باید تمام حالت‌هایی را پیدا کنیم که می‌توانند از طریق لینک‌های پسوندی به حالت <span class="arithmatex">$t$</span> برسند.</p>
<p>بنابراین برای حل مسئله، باید برای هر حالت لیستی از ارجاعات پسوندی که به آن منتهی می‌شوند را ذخیره کنیم.
پاسخ به پرس‌وجو آنگاه شامل تمام <span class="arithmatex">$firstpos$</span>ها برای هر حالتی خواهد بود که می‌توانیم در یک DFS / BFS با شروع از حالت <span class="arithmatex">$t$</span> با استفاده تنها از ارجاعات پسوندی پیدا کنیم.</p>
<p>در مجموع، این کار <span class="arithmatex">$O(length (T))$</span> برای پیش‌پردازش و <span class="arithmatex">$O(length(P) + answer(P))$</span> برای هر درخواست نیاز دارد، که در آن <span class="arithmatex">$answer(P)$</span> اندازه پاسخ است.</p>
<p>ابتدا، برای هر کاراکتر در الگو در آتاماتا پایین می‌رویم تا گره شروع خود را پیدا کنیم که به <span class="arithmatex">$O(length(P))$</span> نیاز دارد. سپس، از راه حل خود استفاده می‌کنیم که در زمان <span class="arithmatex">$O(answer(P))$</span> کار خواهد کرد، زیرا یک حالت را دو بار بازدید نخواهیم کرد (چون از هر حالت فقط یک لینک پسوندی خارج می‌شود، بنابراین نمی‌تواند دو مسیر مختلف به یک حالت یکسان منتهی شود).</p>
<p>فقط باید در نظر داشته باشیم که دو حالت مختلف می‌توانند مقدار <span class="arithmatex">$firstpos$</span> یکسانی داشته باشند.
این اتفاق می‌افتد اگر یک حالت با کلون کردن دیگری به دست آمده باشد.
با این حال، این پیچیدگی را خراب نمی‌کند، زیرا هر حالت حداکثر می‌تواند یک کلون داشته باشد.</p>
<p>علاوه بر این، اگر موقعیت‌های حالت‌های کلون شده را چاپ نکنیم، می‌توانیم از موقعیت‌های تکراری خلاص شویم.
در واقع، حالتی که یک حالت کلون شده می‌تواند به آن برسد، از حالت اصلی نیز قابل دسترسی است.
بنابراین اگر پرچم <code>is_cloned</code> را برای هر حالت به یاد داشته باشیم، می‌توانیم به سادگی حالت‌های کلون شده را نادیده بگیریم و فقط <span class="arithmatex">$firstpos$</span> را برای تمام حالت‌های دیگر چاپ کنیم.</p>
<p>در اینجا چند طرح کلی پیاده‌سازی آورده شده است:</p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">state</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_clone</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">first_pos</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inv_link</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// after constructing the automaton</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">link</span><span class="p">].</span><span class="n">inv_link</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// output all positions of occurrences</span>
<span class="kt">void</span><span class="w"> </span><span class="n">output_all_occurrences</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">P_length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">is_clone</span><span class="p">)</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">first_pos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P_length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">inv_link</span><span class="p">)</span>
<span class="w">        </span><span class="n">output_all_occurrences</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">P_length</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="_21">کوتاه‌ترین رشته‌ای که ظاهر نمی‌شود<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p>یک رشته <span class="arithmatex">$S$</span> و یک الفبای مشخص داده شده است.
باید رشته‌ای با کوتاه‌ترین طول پیدا کنیم که در <span class="arithmatex">$S$</span> ظاهر نمی‌شود.</p>
<p>ما برنامه‌نویسی پویا را بر روی آتاماتای پسوندی ساخته شده برای رشته <span class="arithmatex">$S$</span> اعمال می‌کنیم.</p>
<p>فرض کنید <span class="arithmatex">$d[v]$</span> پاسخ برای گره <span class="arithmatex">$v$</span> باشد، یعنی ما بخشی از زیررشته را پردازش کرده‌ایم، در حال حاضر در حالت <span class="arithmatex">$v$</span> هستیم و می‌خواهیم کمترین تعداد کاراکترهایی را که باید اضافه شوند تا یک گذار ناموجود پیدا شود، پیدا کنیم.
محاسبه <span class="arithmatex">$d[v]$</span> بسیار ساده است.
اگر حداقل برای یک کاراکتر از الفبا گذاری وجود نداشته باشد، آنگاه <span class="arithmatex">$d[v] = 1$</span>.
در غیر این صورت یک کاراکتر کافی نیست و بنابراین باید کمینه تمام پاسخ‌های تمام گذارها را بگیریم:</p>
<div class="arithmatex">$$d[v] = 1 + \min_{w:(v,w,c) \in SA} d[w].$$</div>
<p>پاسخ به مسئله <span class="arithmatex">$d[t_0]$</span> خواهد بود و رشته واقعی را می‌توان با استفاده از آرایه محاسبه شده <span class="arithmatex">$d[]$</span> بازسازی کرد.</p>
<h3 id="_22">طولانی‌ترین زیررشته مشترک دو رشته<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<p>دو رشته <span class="arithmatex">$S$</span> و <span class="arithmatex">$T$</span> داده شده است.
باید طولانی‌ترین زیررشته مشترک را پیدا کنیم، یعنی رشته‌ای مانند <span class="arithmatex">$X$</span> که به عنوان زیررشته در <span class="arithmatex">$S$</span> و همچنین در <span class="arithmatex">$T$</span> ظاهر شود.</p>
<p>یک آتاماتای پسوندی برای رشته <span class="arithmatex">$S$</span> می‌سازیم.</p>
<p>اکنون رشته <span class="arithmatex">$T$</span> را برمی‌داریم و برای هر پیشوند، به دنبال طولانی‌ترین پسوند این پیشوند در <span class="arithmatex">$S$</span> می‌گردیم.
به عبارت دیگر، برای هر موقعیت در رشته <span class="arithmatex">$T$</span>، می‌خواهیم طولانی‌ترین زیررشته مشترک <span class="arithmatex">$S$</span> و <span class="arithmatex">$T$</span> را که در آن موقعیت به پایان می‌رسد، پیدا کنیم.</p>
<p>برای این کار از دو متغیر استفاده خواهیم کرد، <strong>حالت فعلی</strong> <span class="arithmatex">$v$</span> و <strong>طول فعلی</strong> <span class="arithmatex">$l$</span>.
این دو متغیر بخش تطبیق یافته فعلی را توصیف می‌کنند: طول آن و حالتی که با آن متناظر است.</p>
<p>در ابتدا <span class="arithmatex">$v = t_0$</span> و <span class="arithmatex">$l = 0$</span> است، یعنی تطبیق خالی است.</p>
<p>اکنون بیایید توصیف کنیم که چگونه می‌توانیم یک کاراکتر <span class="arithmatex">$T[i]$</span> را اضافه کنیم و پاسخ را برای آن دوباره محاسبه کنیم.</p>
<ul>
<li>اگر گذاری از <span class="arithmatex">$v$</span> با کاراکتر <span class="arithmatex">$T[i]$</span> وجود داشته باشد، به سادگی گذار را دنبال می‌کنیم و <span class="arithmatex">$l$</span> را یک واحد افزایش می‌دهیم.</li>
<li>اگر چنین گذاری وجود نداشته باشد، باید بخش تطبیق یافته فعلی را کوتاه کنیم، که به این معنی است که باید لینک پسوندی را دنبال کنیم: <span class="arithmatex">$v = link(v)$</span>.
    در عین حال، طول فعلی باید کوتاه شود.
    بدیهی است که باید <span class="arithmatex">$l = len(v)$</span> را اختصاص دهیم، زیرا پس از عبور از لینک پسوندی به حالتی می‌رسیم که طولانی‌ترین رشته متناظر آن یک زیررشته است.</li>
<li>اگر هنوز گذاری با استفاده از کاراکتر مورد نیاز وجود نداشته باشد، تکرار می‌کنیم و دوباره از طریق لینک پسوندی می‌رویم و <span class="arithmatex">$l$</span> را کاهش می‌دهیم، تا زمانی که یک گذار پیدا کنیم یا به حالت فرضی <span class="arithmatex">$-1$</span> برسیم (که به این معنی است که نماد <span class="arithmatex">$T[i]$</span> اصلاً در <span class="arithmatex">$S$</span> ظاهر نمی‌شود، بنابراین <span class="arithmatex">$v = l = 0$</span> را اختصاص می‌دهیم).</li>
</ul>
<p>پاسخ به مسئله، بیشینه تمام مقادیر <span class="arithmatex">$l$</span> خواهد بود.</p>
<p>پیچیدگی این بخش <span class="arithmatex">$O(length(T))$</span> است، زیرا در یک حرکت می‌توانیم یا <span class="arithmatex">$l$</span> را یک واحد افزایش دهیم، یا چندین بار از طریق لینک‌های پسوندی عبور کنیم که هر کدام منجر به کاهش مقدار <span class="arithmatex">$l$</span> می‌شود.</p>
<p>پیاده‌سازی:</p>
<div class="highlight"><pre><span></span><code><span class="n">string</span><span class="w"> </span><span class="nf">lcs</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa_init</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">sa_extend</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bestpos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">next</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="p">;</span>
<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">next</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">            </span><span class="n">l</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">best</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">best</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">;</span>
<span class="w">            </span><span class="n">bestpos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">bestpos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">best</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<h3 id="_23">بزرگترین زیررشته مشترک چندین رشته<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<p><span class="arithmatex">$k$</span> رشته <span class="arithmatex">$S_i$</span> داده شده است.
باید طولانی‌ترین زیررشته مشترک را پیدا کنیم، یعنی رشته‌ای مانند <span class="arithmatex">$X$</span> که به عنوان زیررشته در هر رشته <span class="arithmatex">$S_i$</span> ظاهر شود.</p>
<p>تمام رشته‌ها را به یک رشته بزرگ <span class="arithmatex">$T$</span> متصل می‌کنیم و رشته‌ها را با کاراکترهای ویژه <span class="arithmatex">$D_i$</span> (یکی برای هر رشته) از هم جدا می‌کنیم:</p>
<div class="arithmatex">$$T = S_1 + D_1 + S_2 + D_2 + \dots + S_k + D_k.$$</div>
<p>سپس آتاماتای پسوندی را برای رشته <span class="arithmatex">$T$</span> می‌سازیم.</p>
<p>اکنون باید رشته‌ای را در ماشین پیدا کنیم که در تمام رشته‌های <span class="arithmatex">$S_i$</span> وجود داشته باشد و این کار را می‌توان با استفاده از کاراکترهای ویژه اضافه شده انجام داد.
توجه داشته باشید که اگر یک زیررشته در رشته‌ای <span class="arithmatex">$S_j$</span> گنجانده شده باشد، در آتاماتای پسوندی مسیری وجود دارد که از این زیررشته شروع می‌شود و شامل کاراکتر <span class="arithmatex">$D_j$</span> است و شامل کاراکترهای دیگر <span class="arithmatex">$D_1, \dots, D_{j-1}, D_{j+1}, \dots, D_k$</span> نیست.</p>
<p>بنابراین باید قابلیت دسترسی را محاسبه کنیم که به ما می‌گوید برای هر حالت ماشین و هر نماد <span class="arithmatex">$D_i$</span> آیا چنین مسیری وجود دارد یا خیر.
این را می‌توان به راحتی با DFS یا BFS و برنامه‌نویسی پویا محاسبه کرد.
پس از آن، پاسخ به مسئله رشته <span class="arithmatex">$longest(v)$</span> برای حالت <span class="arithmatex">$v$</span> خواهد بود که از آن مسیرهایی برای تمام کاراکترهای ویژه وجود داشته است.</p>
<h2 id="_24">مسائل تمرینی<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://cses.fi/problemset/task/2102">CSES - Finding Patterns</a></li>
<li><a href="https://cses.fi/problemset/task/2103">CSES - Counting Patterns</a></li>
<li><a href="https://cses.fi/problemset/task/1753">CSES - String Matching</a></li>
<li><a href="https://cses.fi/problemset/task/2104">CSES - Patterns Positions</a></li>
<li><a href="https://cses.fi/problemset/task/2105">CSES - Distinct Substrings</a></li>
<li><a href="https://cses.fi/problemset/task/1731">CSES - Word Combinations</a></li>
<li><a href="https://cses.fi/problemset/task/2110">CSES - String Distribution</a></li>
<li><a href="https://atcoder.jp/contests/abc097/tasks/arc097_a">AtCoder - K-th Substring</a></li>
<li><a href="https://www.spoj.com/problems/SUBLEX/">SPOJ - SUBLEX</a></li>
<li><a href="https://codeforces.com/problemset/problem/235/C">Codeforces - Cyclical Quest</a></li>
<li><a href="https://codeforces.com/contest/128/problem/B">Codeforces - String</a></li>
</ul>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <span class="contributors-text">Contributors:</span>
  <ul class="contributors" data-bi-name="contributors"><li><a href="https://github.com/2077DevWave" title="2077DevWave" data-bi-name="contributorprofile" target="_blank">2077DevWave</a> (53.42%)</li><li><a href="https://github.com/jakobkogler" title="jakobkogler" data-bi-name="contributorprofile" target="_blank">jakobkogler</a> (40.62%)</li><li><a href="https://github.com/mhayter" title="mhayter" data-bi-name="contributorprofile" target="_blank">mhayter</a> (3.73%)</li><li><a href="https://github.com/iagorrr" title="iagorrr" data-bi-name="contributorprofile" target="_blank">iagorrr</a> (0.87%)</li><li><a href="https://github.com/adamant-pwn" title="adamant-pwn" data-bi-name="contributorprofile" target="_blank">adamant-pwn</a> (0.5%)</li><li><a href="https://github.com/abeaumont" title="abeaumont" data-bi-name="contributorprofile" target="_blank">abeaumont</a> (0.12%)</li><li><a href="https://github.com/rohaquinlop" title="rohaquinlop" data-bi-name="contributorprofile" target="_blank">rohaquinlop</a> (0.12%)</li><li><a href="https://github.com/wilsjame" title="wilsjame" data-bi-name="contributorprofile" target="_blank">wilsjame</a> (0.12%)</li><li><a href="https://github.com/hieplpvip" title="hieplpvip" data-bi-name="contributorprofile" target="_blank">hieplpvip</a> (0.12%)</li><li><a href="https://github.com/roll-no-1" title="roll-no-1" data-bi-name="contributorprofile" target="_blank">roll-no-1</a> (0.12%)</li><li><a href="https://github.com/Ir1d" title="Ir1d" data-bi-name="contributorprofile" target="_blank">Ir1d</a> (0.12%)</li><li><a href="https://github.com/NAbdulla1" title="NAbdulla1" data-bi-name="contributorprofile" target="_blank">NAbdulla1</a> (0.12%)</li></ul>
</ul>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Text is available under the <a href="https://github.com/cp-algorithms/cp-algorithms/blob/main/LICENSE">Creative Commons Attribution Share Alike 4.0 International</a> License<br/>Copyright &copy; 2014 - 2025 by <a href="https://github.com/cp-algorithms/cp-algorithms/graphs/contributors">cp-algorithms contributors</a>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      <div class="md-social">
  
</div>
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "search.suggest", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u06a9\u067e\u06cc \u0634\u062f", "clipboard.copy": "\u06a9\u067e\u06cc \u06a9\u0631\u062f\u0646", "search.result.more.one": "1 \u0645\u0648\u0631\u062f \u062f\u06cc\u06af\u0631 \u062f\u0631 \u0627\u06cc\u0646 \u0635\u0641\u062d\u0647", "search.result.more.other": "# \u0645\u0648\u0631\u062f \u062f\u06cc\u06af\u0631 \u062f\u0631 \u0627\u06cc\u0646 \u0635\u0641\u062d\u0647", "search.result.none": "\u0633\u0646\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f", "search.result.one": "1 \u0633\u0646\u062f \u06cc\u0627\u0641\u062a \u0634\u062f", "search.result.other": "# \u0633\u0646\u062f \u06cc\u0627\u0641\u062a \u0634\u062f", "search.result.placeholder": "\u0628\u0631\u0627\u06cc \u0634\u0631\u0648\u0639 \u062c\u0633\u062a\u062c\u0648 \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f", "search.result.term.missing": "\u0645\u0648\u062c\u0648\u062f \u0646\u06cc\u0633\u062a", "select.version": "\u0627\u0646\u062a\u062e\u0627\u0628 \u0648\u06cc\u0631\u0627\u06cc\u0634"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../javascript/config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../assets/javascripts/toggle-sidebar.js" async></script>
      
    
  </body>
</html>